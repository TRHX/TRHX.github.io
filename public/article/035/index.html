<!-- 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
-->

<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Force https -->

    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


<!-- Title -->
<title>COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图） - BOB&#39;S BLOG</title>

<!-- Icon -->
<link rel="icon" href="/img/favicon.ico">

<!-- Fonts -->
<link rel="preload" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" as="style" onload="this.onload=null, this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript>

<!-- Font Awesome -->
<!-- https://fontawesome.dashgame.com/ -->
<!-- <link rel="stylesheet" href="https://cdn.itbob.cn/css/font-awesome@5.6.3/all.min.css"> -->
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/5.15.4/css/all.min.css">
<!-- <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css"> -->


    <!-- KaTeX -->
    <!-- //cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css -->
    <link rel="preload" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css" as="style" onload="this.onload=null, this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css"></noscript>


<!-- Style -->

<link rel="stylesheet" href="/styles/main.css">

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-pure@1.0.1/dist/main.css"> -->

<!-- Analytics -->

    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement('script');
                hm.src = 'https://hm.baidu.com/hm.js?6ca34ddce088f8434f3c7509576819f2';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


<!-- Busuanzi -->
<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script async src="//cdn.itbob.cn/js/busuanzi@2.3/busuanzi.pure.mini.js"></script>

<!-- Typeit -->
<!-- https://www.typeitjs.com/ -->
<script src="//unpkg.com/typeit@8.7.0/dist/index.umd.js"></script>

<!-- Fancybox -->

    <link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css">
    <script src="//cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"> </script>
    <script src="//cdn.itbob.cn/js/fancybox@3.5.7/fancybox.js"> </script>

<!-- <script>
  $('[data-fancybox="images"]').fancybox({//可选
    thumbs : {
      autoStart : true //缩略图
    }
  });
  $('[data-fancybox]').fancybox({//启用函数，必须
    protect: true //图片右键不能下载，可选
  });
</script> -->

<!-- Console -->
<script>
    function makeMulti (string) {
        let l = new String(string)
        l = l.substring(l.indexOf("/*") + 3, l.lastIndexOf("*/"))
        return l
    }
    let string = function () {
      /* 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
      */
    }
    console.log(makeMulti(string));
    console.log("\n %c © ITBOB'S BLOG %c https://www.itbob.cn %c © ITRHX'S BLOG %c https://www.itrhx.com \n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;")
</script>

<!-- 51.la 网站统计 2023.12.07 接入 -->
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"3GmZ0RhJYz29jEfJ",ck:"3GmZ0RhJYz29jEfJ"})</script>

    <meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="BOB'S BLOG" type="application/atom+xml">
</head>
    <body>
        <div class="main gt-bg-theme-color-first">
            <div class="main-content">
                <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="/img/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first" id="typeitspan">
            <!-- BOB&#39;S BLOG -->
        </div>
    </a>
    <!-- <span id="typeitspan"></span> -->
    <script>
        new TypeIt('#typeitspan', {
        strings: "IT.BOB",
        speed: 150, 
        afterComplete: function (instance) {
            instance.destroy();
        }
        }).go();
    </script>
    <button aria-label="Navbar Toggler" class="navbar-toggler" type="button" id="changeNavbar">
        <i class="gt-c-content-color-first" style="font-size: 18px;">
            <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512" height="18px" fill="currentColor">
                <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" />
            </svg>
        </i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center; ">
            
                
                    <div class="nav-item">
                        <a href="/" class="menu gt-a-link" target="_self">首页</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/archives/" class="menu gt-a-link" target="_self">归档</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/tags/" class="menu gt-a-link" target="_self">标签</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/friends/" class="menu gt-a-link" target="_self">友链</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="https://spiderbox.cn/" class="menu gt-a-link" target="_blank">虫盒</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="https://spiderapi.cn/" class="menu gt-a-link" target="_blank">虫术</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/about/" class="menu gt-a-link" target="_self">关于</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="https://www.travellings.cn/go.html" target="_blank">
                            <img src="https://cdn.itbob.cn/img/travelling.gif" class="nofancybox" alt="开往-友链接力" width="auto" height="25px">
                        </a>
                    </div>
                
            
        </div>
    </div>
</nav>

<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = function() {
        let element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else { 
            element.style.display = 'none';
        }
    }
</script>

                <div class="post-container">
    <div class="post-detail gt-bg-theme-color-second gt-c-content-color-first">
        <article class="gt-post-content">
            <h1 class="post-title">COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）</h1>
            <div class="post-info">
                <time class="post-time gt-c-content-color-first">
                    <i class="fa fa-calendar-alt"></i> 首发于: 2020-07-06丨
                </time>
                <span id="busuanzi_container_page_pv">
                    <i class="fas fa-eye"></i> 阅读量: <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>丨
                </span>
                
                    <span class="post-count">
                        <i class="fa fa-keyboard"></i> 字数统计: 7.8k丨
                    </span>
                    <span class="post-count">
                        <i class="fa fa-hourglass-half"></i> 阅读时长: 38分丨
                    </span>
                
                
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/%E7%88%AC%E8%99%AB/" class="post-tag">
                            爬虫</a>
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" class="post-tag">
                            数据可视化</a>
                    
                
            </div>
            <hr>
            <div class="post-content gt-c-content-color-first">
                <p><strong><center><font color="red" size="5px" weight="bolder">欢迎加入爬虫逆向微信交流群：添加微信 IT-BOB（备注交流群）</font></center></strong></p>
<h2><span id="wen-zhang-mu-lu">文章目录</span></h2>
<!-- toc -->
<ul>
<li><a href="#font-color-ff0000-1x00-qian-yan-font"><font color="#FF0000">【1x00】前言</font></a></li>
<li><a href="#font-color-ff0000-2x00-si-wei-dao-tu-font"><font color="#FF0000">【2x00】思维导图</font></a></li>
<li><a href="#font-color-ff0000-3x00-shu-ju-jie-gou-fen-xi-font"><font color="#FF0000">【3x00】数据结构分析</font></a></li>
<li><a href="#font-color-ff0000-4x00-zhu-han-shu-main-font"><font color="#FF0000">【4x00】主函数 main()</font></a></li>
<li><a href="#font-color-ff0000-5x00-shu-ju-huo-qu-mo-kuai-data-get-font"><font color="#FF0000">【5x00】数据获取模块 data_get</font></a>
<ul>
<li><a href="#font-color-4876ff-5x01-chu-shi-hua-han-shu-init-font"><font color="#4876FF">【5x01】初始化函数 init()</font></a></li>
<li><a href="#font-color-4876ff-5x02-zhong-guo-zong-shu-ju-china-total-data-font"><font color="#4876FF">【5x02】中国总数据 china_total_data()</font></a></li>
<li><a href="#font-color-4876ff-5x03-quan-qiu-zong-shu-ju-global-total-data-font"><font color="#4876FF">【5x03】全球总数据 global_total_data()</font></a></li>
<li><a href="#font-color-4876ff-5x04-zhong-guo-mei-ri-shu-ju-china-daily-data-font"><font color="#4876FF">【5x04】中国每日数据 china_daily_data()</font></a></li>
<li><a href="#font-color-4876ff-5x05-jing-wai-mei-ri-shu-ju-foreign-daily-data-font"><font color="#4876FF">【5x05】境外每日数据 foreign_daily_data()</font></a></li>
</ul>
</li>
<li><a href="#font-color-ff0000-6x00-ci-yun-tu-hui-zhi-mo-kuai-data-wordcloud-font"><font color="#FF0000">【6x00】词云图绘制模块 data_wordcloud</font></a>
<ul>
<li><a href="#font-color-4876ff-6x01-zhong-guo-lei-ji-que-zhen-ci-yun-tu-foreign-daily-data-font"><font color="#4876FF">【6x01】中国累计确诊词云图 foreign_daily_data()</font></a></li>
<li><a href="#font-color-4876ff-6x02-quan-qiu-lei-ji-que-zhen-ci-yun-tu-foreign-daily-data-font"><font color="#4876FF">【6x02】全球累计确诊词云图 foreign_daily_data()</font></a></li>
</ul>
</li>
<li><a href="#font-color-ff0000-7x00-di-tu-hui-zhi-mo-kuai-data-map-font"><font color="#FF0000">【7x00】地图绘制模块 data_map</font></a>
<ul>
<li><a href="#font-color-4876ff-7x01-zhong-guo-lei-ji-que-zhen-di-tu-china-total-map-font"><font color="#4876FF">【7x01】中国累计确诊地图 china_total_map()</font></a></li>
<li><a href="#font-color-4876ff-7x02-quan-qiu-lei-ji-que-zhen-di-tu-global-total-map-font"><font color="#4876FF">【7x02】全球累计确诊地图 global_total_map()</font></a></li>
<li><a href="#font-color-4876ff-7x03-zhong-guo-mei-ri-shu-ju-zhe-xian-tu-china-daily-map-font"><font color="#4876FF">【7x03】中国每日数据折线图 china_daily_map()</font></a></li>
<li><a href="#font-color-4876ff-7x04-jing-wai-mei-ri-shu-ju-zhe-xian-tu-foreign-daily-map-font"><font color="#4876FF">【7x04】境外每日数据折线图 foreign_daily_map()</font></a></li>
</ul>
</li>
<li><a href="#font-color-ff0000-8x00-jie-guo-jie-tu-font"><font color="#FF0000">【8x00】结果截图</font></a>
<ul>
<li><a href="#font-color-4876ff-8x01-shu-ju-chu-cun-excel-font"><font color="#4876FF">【8x01】数据储存 Excel</font></a></li>
<li><a href="#font-color-4876ff-8x02-ci-yun-tu-font"><font color="#4876FF">【8x02】词云图</font></a></li>
<li><a href="#font-color-4876ff-8x03-di-tu-zhe-xian-tu-font"><font color="#4876FF">【8x03】地图 + 折线图</font></a></li>
</ul>
</li>
<li><a href="#font-color-ff0000-9x00-wan-zheng-dai-ma-font"><font color="#FF0000">【9x00】完整代码</font></a></li>
</ul>
<!-- tocstop -->
<hr>
<pre><code class="hljs yaml"><span class="hljs-string">这里是一段物理防爬虫文本，请读者忽略。</span>
<span class="hljs-string">本文原创首发于</span> <span class="hljs-string">CSDN，作者</span> <span class="hljs-string">ITBOB。</span>
<span class="hljs-string">博客首页：https://itrhx.blog.csdn.net/</span>
<span class="hljs-string">本文链接：https://itrhx.blog.csdn.net/article/details/107140534</span>
<span class="hljs-string">未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！</span></code></pre>
<hr>
<h2><span id="1x00-qian-yan"><font color="#FF0000">【1x00】前言</font></span></h2>
<p>本来两三个月之前就想搞个疫情数据实时数据展示的，由于各种不可抗拒因素一而再再而三的鸽了，最近终于抽空写了一个，数据是用 Python 爬取的<a target="_blank" rel="noopener" href="https://voice.baidu.com/act/newpneumonia/newpneumonia/">百度疫情实时大数据报告</a>，请求库用的 requests，解析用的 Xpath 语法，词云用的 wordcloud 库，数据可视化用 pyecharts 绘制的地图和折线图，数据储存在 Excel 表格里面，使用 openpyxl 对表格进行处理。</p>
<p>本程序实现了累计确诊地图展示和每日数据变化折线图展示，其他更多数据的获取和展示均可在程序中进行拓展，可以将程序部署在服务器上，设置定时运行，即可实时展示数据，pyecharts 绘图模块也可以整合到 Web 框架（Django、Flask等）中使用。</p>
<p>在获取数据时有<font color="#FF0000"><strong>全球</strong></font>和<font color="#FF0000"><strong>境外</strong></font>两个概念，全球包含中国，境外不包含中国，后期绘制的四个图：中国累计确诊地图、全球累计确诊地图（包含中国）、中国每日数据折线图、境外每日数据折线图（不包含中国）。</p>
<p><font color="#FF0000"><strong>注意项：直接向该网页发送请求获取的响应中，没有每个国家的每日数据，该数据获取的地址是：<a href="https://voice.baidu.com/newpneumonia/get?target=trend&amp;isCaseIn=1&amp;stage=publish">https://voice.baidu.com/newpneumonia/get?target=trend&amp;isCaseIn=1&amp;stage=publish</a></strong></font></p>
<ul>
<li><strong>预览地址</strong>：<s><a target="_blank" rel="noopener" href="http://cov.itrhx.com/">http://cov.itrhx.com/</a></s>（已失效）</li>
<li><strong>数据来源</strong>：<a target="_blank" rel="noopener" href="https://voice.baidu.com/act/newpneumonia/newpneumonia/">https://voice.baidu.com/act/newpneumonia/newpneumonia/</a></li>
<li><strong>pyecharts 文档</strong>：<a target="_blank" rel="noopener" href="https://pyecharts.org/">https://pyecharts.org/</a></li>
<li><strong>openpyxl 文档</strong>：<a target="_blank" rel="noopener" href="https://openpyxl.readthedocs.io/">https://openpyxl.readthedocs.io/</a></li>
<li><strong>wordcloud 文档</strong>：<a target="_blank" rel="noopener" href="http://amueller.github.io/word_cloud/">http://amueller.github.io/word_cloud/</a></li>
</ul>
<h2><span id="2x00-si-wei-dao-tu"><font color="#FF0000">【2x00】思维导图</font></span></h2>
<p><img src="https://cdn.itbob.cn/img/article/035/01.png" alt="01"></p>
<h2><span id="3x00-shu-ju-jie-gou-fen-xi"><font color="#FF0000">【3x00】数据结构分析</font></span></h2>
<p>通过查看百度的疫情数据页面，可以看到很多整齐的数据，猜测就是疫情相关的数据，保存该页面，对其进行格式化，很容易可以分析出所有的数据都在 <code>&lt;script type=&quot;application/json&quot; id=&quot;captain-config&quot;&gt;&lt;/script&gt;</code> 里面，其中 title 里面是一些 Unicode 编码，将其转为中文后更容易得到不同的分类数据。</p>
<p><img src="https://cdn.itbob.cn/img/article/035/02.png" alt="02"></p>
<p>由于数据繁多，可以将数据主体部分提取出来，删除一些重复项和其他杂项，留下数据大体位置并分析数据结构，便于后期的数据提取，经过处理后的数据大致结构如下：</p>
<pre><code class="hljs json">&lt;script type=<span class="hljs-string">&quot;application/json&quot;</span> id=<span class="hljs-string">&quot;captain-config&quot;</span>&gt;
    &#123;
        <span class="hljs-attr">&quot;component&quot;</span>: [
            &#123;
                <span class="hljs-attr">&quot;mapLastUpdatedTime&quot;</span>: <span class="hljs-string">&quot;2020.07.05 16:13&quot;</span>,        <span class="hljs-comment">// 国内疫情数据最后更新时间</span>
                <span class="hljs-attr">&quot;caseList&quot;</span>: [                                    <span class="hljs-comment">// caseList 列表，每一个元素是一个字典</span>
                    &#123;
                        <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,                        <span class="hljs-comment">// 每个字典包含中国每个省的每一项疫情数据</span>
                        <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                        <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                        <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;diedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;curedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirmRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                        <span class="hljs-attr">&quot;icuDisable&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                        <span class="hljs-attr">&quot;area&quot;</span>: <span class="hljs-string">&quot;西藏&quot;</span>,
                        <span class="hljs-attr">&quot;subList&quot;</span>: [                            <span class="hljs-comment">// subList 列表，每一个元素是一个字典</span>
                            &#123;
                                <span class="hljs-attr">&quot;city&quot;</span>: <span class="hljs-string">&quot;拉萨&quot;</span>,                 <span class="hljs-comment">// 每个字典包含该省份对应的每个城市疫情数据</span>
                                <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                                <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                                <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                                <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                                <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                                <span class="hljs-attr">&quot;cityCode&quot;</span>: <span class="hljs-string">&quot;100&quot;</span>
                            &#125;
                        ]
                    &#125;
                ],
                <span class="hljs-attr">&quot;caseOutsideList&quot;</span>: [                           <span class="hljs-comment">// caseOutsideList 列表，每一个元素是一个字典</span>
                    &#123;
                        <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;241419&quot;</span>,                 <span class="hljs-comment">// 每个字典包含各国的每一项疫情数据</span>
                        <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;34854&quot;</span>,
                        <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;191944&quot;</span>,
                        <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                        <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;223&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;14621&quot;</span>,
                        <span class="hljs-attr">&quot;icuDisable&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                        <span class="hljs-attr">&quot;area&quot;</span>: <span class="hljs-string">&quot;意大利&quot;</span>,
                        <span class="hljs-attr">&quot;subList&quot;</span>: [                          <span class="hljs-comment">// subList 列表，每一个元素是一个字典</span>
                            &#123;
                                <span class="hljs-attr">&quot;city&quot;</span>: <span class="hljs-string">&quot;伦巴第&quot;</span>,              <span class="hljs-comment">// 每个字典包含每个国家对应的每个城市疫情数据</span>
                                <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;94318&quot;</span>,
                                <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;16691&quot;</span>,
                                <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;68201&quot;</span>,
                                <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;9426&quot;</span>
                            &#125;
                        ]
                    &#125;
                ],
                <span class="hljs-attr">&quot;summaryDataIn&quot;</span>: &#123;                           <span class="hljs-comment">// summaryDataIn 国内总的疫情数据</span>
                    <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;85307&quot;</span>,
                    <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;4648&quot;</span>,
                    <span class="hljs-attr">&quot;cured&quot;</span>: <span class="hljs-string">&quot;80144&quot;</span>,
                    <span class="hljs-attr">&quot;asymptomatic&quot;</span>: <span class="hljs-string">&quot;99&quot;</span>,
                    <span class="hljs-attr">&quot;asymptomaticRelative&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>,
                    <span class="hljs-attr">&quot;unconfirmed&quot;</span>: <span class="hljs-string">&quot;7&quot;</span>,
                    <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                    <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;19&quot;</span>,
                    <span class="hljs-attr">&quot;unconfirmedRelative&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,
                    <span class="hljs-attr">&quot;curedRelative&quot;</span>: <span class="hljs-string">&quot;27&quot;</span>,
                    <span class="hljs-attr">&quot;diedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                    <span class="hljs-attr">&quot;icu&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,
                    <span class="hljs-attr">&quot;icuRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                    <span class="hljs-attr">&quot;overseasInput&quot;</span>: <span class="hljs-string">&quot;1931&quot;</span>,
                    <span class="hljs-attr">&quot;unOverseasInputCumulative&quot;</span>: <span class="hljs-string">&quot;83375&quot;</span>,
                    <span class="hljs-attr">&quot;overseasInputRelative&quot;</span>: <span class="hljs-string">&quot;6&quot;</span>,
                    <span class="hljs-attr">&quot;unOverseasInputNewAdd&quot;</span>: <span class="hljs-string">&quot;13&quot;</span>,
                    <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;515&quot;</span>,
                    <span class="hljs-attr">&quot;curConfirmRelative&quot;</span>: <span class="hljs-string">&quot;-8&quot;</span>,
                    <span class="hljs-attr">&quot;icuDisable&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
                &#125;,
                <span class="hljs-attr">&quot;summaryDataOut&quot;</span>: &#123;                           <span class="hljs-comment">// summaryDataOut 国外总的疫情数据</span>
                    <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;11302569&quot;</span>,
                    <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;528977&quot;</span>,
                    <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;4410601&quot;</span>,
                    <span class="hljs-attr">&quot;cured&quot;</span>: <span class="hljs-string">&quot;6362991&quot;</span>,
                    <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;206165&quot;</span>,
                    <span class="hljs-attr">&quot;curedRelative&quot;</span>: <span class="hljs-string">&quot;190018&quot;</span>,
                    <span class="hljs-attr">&quot;diedRelative&quot;</span>: <span class="hljs-string">&quot;4876&quot;</span>,
                    <span class="hljs-attr">&quot;curConfirmRelative&quot;</span>: <span class="hljs-string">&quot;11271&quot;</span>,
                    <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>
                &#125;,
                <span class="hljs-attr">&quot;trend&quot;</span>: &#123;                                    <span class="hljs-comment">// trend 字典，包含国内每日的疫情数据</span>
                    <span class="hljs-attr">&quot;updateDate&quot;</span>: [],                         <span class="hljs-comment">// 日期</span>
                    <span class="hljs-attr">&quot;list&quot;</span>: [                                 <span class="hljs-comment">// list 列表，每项数据及其对应的值</span>
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;确诊&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;疑似&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;治愈&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;死亡&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增确诊&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增疑似&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增治愈&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增死亡&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;累计境外输入&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;,
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增境外输入&quot;</span>,
                            <span class="hljs-attr">&quot;data&quot;</span>: []
                        &#125;
                    ]
                &#125;,
                <span class="hljs-attr">&quot;foreignLastUpdatedTime&quot;</span>: <span class="hljs-string">&quot;2020.07.05 16:13&quot;</span>,       <span class="hljs-comment">// 国外疫情数据最后更新时间</span>
                <span class="hljs-attr">&quot;globalList&quot;</span>: [                                     <span class="hljs-comment">// globalList 列表，每一个元素是一个字典</span>
                    &#123;
                        <span class="hljs-attr">&quot;area&quot;</span>: <span class="hljs-string">&quot;亚洲&quot;</span>,                              <span class="hljs-comment">// 按照不同洲进行分类</span>
                        <span class="hljs-attr">&quot;subList&quot;</span>: [                                <span class="hljs-comment">// subList 列表，每个洲各个国家的疫情数据</span>
                            &#123;
                                <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;52&quot;</span>,
                                <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;6159&quot;</span>,
                                <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;4809&quot;</span>,
                                <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;1298&quot;</span>,
                                <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                                <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                                <span class="hljs-attr">&quot;country&quot;</span>: <span class="hljs-string">&quot;塔吉克斯坦&quot;</span>
                            &#125;
                        ],
                        <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;56556&quot;</span>,                            <span class="hljs-comment">// 每个洲总的疫情数据</span>
                        <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;1625562&quot;</span>,
                        <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;2447873&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;765755&quot;</span>,
                        <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;60574&quot;</span>
                    &#125;,
                    &#123;
                        <span class="hljs-attr">&quot;area&quot;</span>: <span class="hljs-string">&quot;其他&quot;</span>,                             <span class="hljs-comment">// 其他特殊区域疫情数据</span>
                        <span class="hljs-attr">&quot;subList&quot;</span>: [
                            &#123;
                                <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;13&quot;</span>,
                                <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;712&quot;</span>,
                                <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;651&quot;</span>,
                                <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;48&quot;</span>,
                                <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
                                <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                                <span class="hljs-attr">&quot;country&quot;</span>: <span class="hljs-string">&quot;钻石公主号邮轮&quot;</span>
                            &#125;
                        ],
                        <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;13&quot;</span>,                              <span class="hljs-comment">// 其他特殊区域疫情总的数据</span>
                        <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;651&quot;</span>,
                        <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;712&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;48&quot;</span>,
                        <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>
                    &#125;,
                    &#123;
                        <span class="hljs-attr">&quot;area&quot;</span>: <span class="hljs-string">&quot;热门&quot;</span>,                            <span class="hljs-comment">// 热门国家疫情数据</span>
                        <span class="hljs-attr">&quot;subList&quot;</span>: [
                            &#123;
                                <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;5206&quot;</span>,
                                <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;204610&quot;</span>,
                                <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;179492&quot;</span>,
                                <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;19912&quot;</span>,
                                <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;1172&quot;</span>,
                                <span class="hljs-attr">&quot;relativeTime&quot;</span>: <span class="hljs-string">&quot;1593792000&quot;</span>,
                                <span class="hljs-attr">&quot;country&quot;</span>: <span class="hljs-string">&quot;土耳其&quot;</span>
                            &#125;
                        ],
                        <span class="hljs-attr">&quot;died&quot;</span>: <span class="hljs-string">&quot;528967&quot;</span>,                         <span class="hljs-comment">// 热门国家疫情总的数据</span>
                        <span class="hljs-attr">&quot;crued&quot;</span>: <span class="hljs-string">&quot;6362924&quot;</span>,
                        <span class="hljs-attr">&quot;confirmed&quot;</span>: <span class="hljs-string">&quot;11302357&quot;</span>,
                        <span class="hljs-attr">&quot;confirmedRelative&quot;</span>: <span class="hljs-string">&quot;216478&quot;</span>,
                        <span class="hljs-attr">&quot;curConfirm&quot;</span>: <span class="hljs-string">&quot;4410466&quot;</span>
                    &#125;],
                <span class="hljs-attr">&quot;allForeignTrend&quot;</span>: &#123;                            <span class="hljs-comment">// allForeignTrend 字典，包含国外每日的疫情数据</span>
                        <span class="hljs-attr">&quot;updateDate&quot;</span>: [],                       <span class="hljs-comment">// 日期</span>
                        <span class="hljs-attr">&quot;list&quot;</span>: [                               <span class="hljs-comment">// list 列表，每项数据及其对应的值</span>
                            &#123;
                                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;累计确诊&quot;</span>,
                                <span class="hljs-attr">&quot;data&quot;</span>: []
                            &#125;,
                            &#123;
                                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;治愈&quot;</span>,
                                <span class="hljs-attr">&quot;data&quot;</span>: []
                            &#125;,
                            &#123;
                                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;死亡&quot;</span>,
                                <span class="hljs-attr">&quot;data&quot;</span>: []
                            &#125;,
                            &#123;
                                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;现有确诊&quot;</span>,
                                <span class="hljs-attr">&quot;data&quot;</span>: []
                            &#125;,
                            &#123;
                                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;新增确诊&quot;</span>,
                                <span class="hljs-attr">&quot;data&quot;</span>: []
                            &#125;
                        ]
                    &#125;,
                <span class="hljs-attr">&quot;topAddCountry&quot;</span>: [                    <span class="hljs-comment">// 确诊增量最高的国家</span>
                        &#123;
                            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;美国&quot;</span>,
                            <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">53162</span>
                        &#125;
                    ],
                <span class="hljs-attr">&quot;topOverseasInput&quot;</span>: [                <span class="hljs-comment">// 境外输入最多的省份</span>
                    &#123;
                        <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;黑龙江&quot;</span>,
                        <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">386</span>
                    &#125;
                ]
            &#125;
        ]
    &#125;
&lt;/script&gt;</code></pre>
<h2><span id="4x00-zhu-han-shu-main"><font color="#FF0000">【4x00】主函数 main()</font></span></h2>
<p>分别将数据获取、词云图绘制、地图绘制写入三个文件：<code>data_get()</code>、<code>data_wordcloud()</code>、<code>data_map()</code>，然后使用一个主函数文件 <a target="_blank" rel="noopener" href="http://main.py">main.py</a> 来调用这三个文件里面的函数。</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> data_get
<span class="hljs-keyword">import</span> data_wordcloud
<span class="hljs-keyword">import</span> data_map

data_dict = data_get.init()
data_get.china_total_data(data_dict)
data_get.global_total_data(data_dict)
data_get.china_daily_data(data_dict)
data_get.foreign_daily_data(data_dict)

data_wordcloud.china_wordcloud()
data_wordcloud.global_wordcloud()

data_map.all_map()</code></pre>
<h2><span id="5x00-shu-ju-huo-qu-mo-kuai-data-get"><font color="#FF0000">【5x00】数据获取模块 data_get</font></span></h2>
<h3><span id="5x01-chu-shi-hua-han-shu-init"><font color="#4876FF">【5x01】初始化函数 init()</font></span></h3>
<p>使用 xpath 语法 <code>//script[@id=&quot;captain-config&quot;]/text()</code> 提取里面的值，利用 <code>json.loads</code> 方法将其转换为字典对象，以便后续的其他函数调用。</p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span>():</span>
    headers = &#123;
        <span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.13 Safari/537.36&#x27;</span>
    &#125;
    url = <span class="hljs-string">&#x27;https://voice.baidu.com/act/newpneumonia/newpneumonia/&#x27;</span>
    response = requests.get(url=url, headers=headers)
    tree = etree.HTML(response.text)
    dict1 = tree.xpath(<span class="hljs-string">&#x27;//script[@id=&quot;captain-config&quot;]/text()&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(dict1[<span class="hljs-number">0</span>]))
    dict2 = json.loads(dict1[<span class="hljs-number">0</span>])
    <span class="hljs-keyword">return</span> dict2</code></pre>
<h3><span id="5x02-zhong-guo-zong-shu-ju-china-total-data"><font color="#4876FF">【5x02】中国总数据 china_total_data()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">china_total_data</span>(<span class="hljs-params">data</span>):</span>

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    1、中国省/直辖市/自治区/行政区疫情数据</span>
<span class="hljs-string">    省/直辖市/自治区/行政区：area</span>
<span class="hljs-string">    现有确诊：    curConfirm</span>
<span class="hljs-string">    累计确诊：    confirmed</span>
<span class="hljs-string">    累计治愈：    crued</span>
<span class="hljs-string">    累计死亡：    died</span>
<span class="hljs-string">    现有确诊增量： curConfirmRelative</span>
<span class="hljs-string">    累计确诊增量： confirmedRelative</span>
<span class="hljs-string">    累计治愈增量： curedRelative</span>
<span class="hljs-string">    累计死亡增量： diedRelative</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    wb = openpyxl.Workbook()            <span class="hljs-comment"># 创建工作簿</span>
    ws_china = wb.active                <span class="hljs-comment"># 获取工作表</span>
    ws_china.title = <span class="hljs-string">&quot;中国省份疫情数据&quot;</span>   <span class="hljs-comment"># 命名工作表</span>
    ws_china.append([<span class="hljs-string">&#x27;省/直辖市/自治区/行政区&#x27;</span>, <span class="hljs-string">&#x27;现有确诊&#x27;</span>, <span class="hljs-string">&#x27;累计确诊&#x27;</span>, <span class="hljs-string">&#x27;累计治愈&#x27;</span>,
                     <span class="hljs-string">&#x27;累计死亡&#x27;</span>, <span class="hljs-string">&#x27;现有确诊增量&#x27;</span>, <span class="hljs-string">&#x27;累计确诊增量&#x27;</span>,
                     <span class="hljs-string">&#x27;累计治愈增量&#x27;</span>, <span class="hljs-string">&#x27;累计死亡增量&#x27;</span>])
    china = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;caseList&#x27;</span>]
    <span class="hljs-keyword">for</span> province <span class="hljs-keyword">in</span> china:
        ws_china.append([province[<span class="hljs-string">&#x27;area&#x27;</span>],
                        province[<span class="hljs-string">&#x27;curConfirm&#x27;</span>],
                        province[<span class="hljs-string">&#x27;confirmed&#x27;</span>],
                        province[<span class="hljs-string">&#x27;crued&#x27;</span>],
                        province[<span class="hljs-string">&#x27;died&#x27;</span>],
                        province[<span class="hljs-string">&#x27;curConfirmRelative&#x27;</span>],
                        province[<span class="hljs-string">&#x27;confirmedRelative&#x27;</span>],
                        province[<span class="hljs-string">&#x27;curedRelative&#x27;</span>],
                        province[<span class="hljs-string">&#x27;diedRelative&#x27;</span>]])

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    2、中国城市疫情数据</span>
<span class="hljs-string">    城市：city</span>
<span class="hljs-string">    现有确诊：curConfirm</span>
<span class="hljs-string">    累计确诊：confirmed</span>
<span class="hljs-string">    累计治愈：crued</span>
<span class="hljs-string">    累计死亡：died</span>
<span class="hljs-string">    累计确诊增量：confirmedRelative</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    ws_city = wb.create_sheet(<span class="hljs-string">&#x27;中国城市疫情数据&#x27;</span>)
    ws_city.append([<span class="hljs-string">&#x27;城市&#x27;</span>, <span class="hljs-string">&#x27;现有确诊&#x27;</span>, <span class="hljs-string">&#x27;累计确诊&#x27;</span>,
                    <span class="hljs-string">&#x27;累计治愈&#x27;</span>, <span class="hljs-string">&#x27;累计死亡&#x27;</span>, <span class="hljs-string">&#x27;累计确诊增量&#x27;</span>])
    <span class="hljs-keyword">for</span> province <span class="hljs-keyword">in</span> china:
        <span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> province[<span class="hljs-string">&#x27;subList&#x27;</span>]:
            <span class="hljs-comment"># 某些城市没有 curConfirm 数据，则将其设置为 0，crued 和 died 为空时，替换成 0</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;curConfirm&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> city:
                city[<span class="hljs-string">&#x27;curConfirm&#x27;</span>] = <span class="hljs-string">&#x27;0&#x27;</span>
            <span class="hljs-keyword">if</span> city[<span class="hljs-string">&#x27;crued&#x27;</span>] == <span class="hljs-string">&#x27;&#x27;</span>:
                city[<span class="hljs-string">&#x27;crued&#x27;</span>] = <span class="hljs-string">&#x27;0&#x27;</span>
            <span class="hljs-keyword">if</span> city[<span class="hljs-string">&#x27;died&#x27;</span>] == <span class="hljs-string">&#x27;&#x27;</span>:
                city[<span class="hljs-string">&#x27;died&#x27;</span>] = <span class="hljs-string">&#x27;0&#x27;</span>
            ws_city.append([city[<span class="hljs-string">&#x27;city&#x27;</span>], <span class="hljs-string">&#x27;0&#x27;</span>, city[<span class="hljs-string">&#x27;confirmed&#x27;</span>],
                           city[<span class="hljs-string">&#x27;crued&#x27;</span>], city[<span class="hljs-string">&#x27;died&#x27;</span>], city[<span class="hljs-string">&#x27;confirmedRelative&#x27;</span>]])

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    3、中国疫情数据更新时间：mapLastUpdatedTime</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    time_domestic = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;mapLastUpdatedTime&#x27;</span>]
    ws_time = wb.create_sheet(<span class="hljs-string">&#x27;中国疫情数据更新时间&#x27;</span>)
    ws_time.column_dimensions[<span class="hljs-string">&#x27;A&#x27;</span>].width = <span class="hljs-number">22</span>  <span class="hljs-comment"># 调整列宽</span>
    ws_time.append([<span class="hljs-string">&#x27;中国疫情数据更新时间&#x27;</span>])
    ws_time.append([time_domestic])

    wb.save(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;中国疫情数据已保存至 COVID-19-China.xlsx！&#x27;</span>)</code></pre>
<h3><span id="5x03-quan-qiu-zong-shu-ju-global-total-data"><font color="#4876FF">【5x03】全球总数据 global_total_data()</font></span></h3>
<p>全球总数据在提取完成后，进行地图绘制时发现并没有中国的数据，因此在写入全球数据时注意要单独将中国的数据插入 Excel 中。</p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">global_total_data</span>(<span class="hljs-params">data</span>):</span>

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    1、全球各国疫情数据</span>
<span class="hljs-string">    国家：country</span>
<span class="hljs-string">    现有确诊：curConfirm</span>
<span class="hljs-string">    累计确诊：confirmed</span>
<span class="hljs-string">    累计治愈：crued</span>
<span class="hljs-string">    累计死亡：died</span>
<span class="hljs-string">    累计确诊增量：confirmedRelative</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    wb = openpyxl.Workbook()
    ws_global = wb.active
    ws_global.title = <span class="hljs-string">&quot;全球各国疫情数据&quot;</span>

    <span class="hljs-comment"># 按照国家保存数据</span>
    countries = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;caseOutsideList&#x27;</span>]
    ws_global.append([<span class="hljs-string">&#x27;国家&#x27;</span>, <span class="hljs-string">&#x27;现有确诊&#x27;</span>, <span class="hljs-string">&#x27;累计确诊&#x27;</span>, <span class="hljs-string">&#x27;累计治愈&#x27;</span>, <span class="hljs-string">&#x27;累计死亡&#x27;</span>, <span class="hljs-string">&#x27;累计确诊增量&#x27;</span>])
    <span class="hljs-keyword">for</span> country <span class="hljs-keyword">in</span> countries:
        ws_global.append([country[<span class="hljs-string">&#x27;area&#x27;</span>],
                          country[<span class="hljs-string">&#x27;curConfirm&#x27;</span>],
                          country[<span class="hljs-string">&#x27;confirmed&#x27;</span>],
                          country[<span class="hljs-string">&#x27;crued&#x27;</span>],
                          country[<span class="hljs-string">&#x27;died&#x27;</span>],
                          country[<span class="hljs-string">&#x27;confirmedRelative&#x27;</span>]])

    <span class="hljs-comment"># 按照洲保存数据</span>
    continent = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;globalList&#x27;</span>]
    <span class="hljs-keyword">for</span> area <span class="hljs-keyword">in</span> continent:
        ws_foreign = wb.create_sheet(area[<span class="hljs-string">&#x27;area&#x27;</span>] + <span class="hljs-string">&#x27;疫情数据&#x27;</span>)
        ws_foreign.append([<span class="hljs-string">&#x27;国家&#x27;</span>, <span class="hljs-string">&#x27;现有确诊&#x27;</span>, <span class="hljs-string">&#x27;累计确诊&#x27;</span>, <span class="hljs-string">&#x27;累计治愈&#x27;</span>, <span class="hljs-string">&#x27;累计死亡&#x27;</span>, <span class="hljs-string">&#x27;累计确诊增量&#x27;</span>])
        <span class="hljs-keyword">for</span> country <span class="hljs-keyword">in</span> area[<span class="hljs-string">&#x27;subList&#x27;</span>]:
            ws_foreign.append([country[<span class="hljs-string">&#x27;country&#x27;</span>],
                               country[<span class="hljs-string">&#x27;curConfirm&#x27;</span>],
                               country[<span class="hljs-string">&#x27;confirmed&#x27;</span>],
                               country[<span class="hljs-string">&#x27;crued&#x27;</span>],
                               country[<span class="hljs-string">&#x27;died&#x27;</span>],
                               country[<span class="hljs-string">&#x27;confirmedRelative&#x27;</span>]])

    <span class="hljs-comment"># 在“全球各国疫情数据”和“亚洲疫情数据”两张表中写入中国疫情数据</span>
    ws1, ws2 = wb[<span class="hljs-string">&#x27;全球各国疫情数据&#x27;</span>], wb[<span class="hljs-string">&#x27;亚洲疫情数据&#x27;</span>]
    original_data = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;summaryDataIn&#x27;</span>]
    add_china_data = [<span class="hljs-string">&#x27;中国&#x27;</span>,
                      original_data[<span class="hljs-string">&#x27;curConfirm&#x27;</span>],
                      original_data[<span class="hljs-string">&#x27;confirmed&#x27;</span>],
                      original_data[<span class="hljs-string">&#x27;cured&#x27;</span>],
                      original_data[<span class="hljs-string">&#x27;died&#x27;</span>],
                      original_data[<span class="hljs-string">&#x27;confirmedRelative&#x27;</span>]]
    ws1.append(add_china_data)
    ws2.append(add_china_data)

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    2、全球疫情数据更新时间：foreignLastUpdatedTime</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    time_foreign = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;foreignLastUpdatedTime&#x27;</span>]
    ws_time = wb.create_sheet(<span class="hljs-string">&#x27;全球疫情数据更新时间&#x27;</span>)
    ws_time.column_dimensions[<span class="hljs-string">&#x27;A&#x27;</span>].width = <span class="hljs-number">22</span>  <span class="hljs-comment"># 调整列宽</span>
    ws_time.append([<span class="hljs-string">&#x27;全球疫情数据更新时间&#x27;</span>])
    ws_time.append([time_foreign])

    wb.save(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;全球疫情数据已保存至 COVID-19-Global.xlsx！&#x27;</span>)</code></pre>
<h3><span id="5x04-zhong-guo-mei-ri-shu-ju-china-daily-data"><font color="#4876FF">【5x04】中国每日数据 china_daily_data()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">china_daily_data</span>(<span class="hljs-params">data</span>):</span>

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    i_dict = data[&#x27;component&#x27;][0][&#x27;trend&#x27;]</span>
<span class="hljs-string">    i_dict[&#x27;updateDate&#x27;]：日期</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][0]：确诊</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][1]：疑似</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][2]：治愈</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][3]：死亡</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][4]：新增确诊</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][5]：新增疑似</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][6]：新增治愈</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][7]：新增死亡</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][8]：累计境外输入</span>
<span class="hljs-string">    i_dict[&#x27;list&#x27;][9]：新增境外输入</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    ccd_dict = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;trend&#x27;</span>]
    update_date = ccd_dict[<span class="hljs-string">&#x27;updateDate&#x27;</span>]              <span class="hljs-comment"># 日期</span>
    china_confirmed = ccd_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;data&#x27;</span>]     <span class="hljs-comment"># 每日累计确诊数据</span>
    china_crued = ccd_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&#x27;data&#x27;</span>]         <span class="hljs-comment"># 每日累计治愈数据</span>
    china_died = ccd_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">3</span>][<span class="hljs-string">&#x27;data&#x27;</span>]          <span class="hljs-comment"># 每日累计死亡数据</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)

    <span class="hljs-comment"># 写入每日累计确诊数据</span>
    ws_china_confirmed = wb.create_sheet(<span class="hljs-string">&#x27;中国每日累计确诊数据&#x27;</span>)
    ws_china_confirmed.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, china_confirmed):
        ws_china_confirmed.append(data)

    <span class="hljs-comment"># 写入每日累计治愈数据</span>
    ws_china_crued = wb.create_sheet(<span class="hljs-string">&#x27;中国每日累计治愈数据&#x27;</span>)
    ws_china_crued.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, china_crued):
        ws_china_crued.append(data)

    <span class="hljs-comment"># 写入每日累计死亡数据</span>
    ws_china_died = wb.create_sheet(<span class="hljs-string">&#x27;中国每日累计死亡数据&#x27;</span>)
    ws_china_died.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, china_died):
        ws_china_died.append(data)

    wb.save(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;中国每日累计确诊/治愈/死亡数据已保存至 COVID-19-China.xlsx！&#x27;</span>)</code></pre>
<h3><span id="5x05-jing-wai-mei-ri-shu-ju-foreign-daily-data"><font color="#4876FF">【5x05】境外每日数据 foreign_daily_data()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foreign_daily_data</span>(<span class="hljs-params">data</span>):</span>

    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    te_dict = data[&#x27;component&#x27;][0][&#x27;allForeignTrend&#x27;]</span>
<span class="hljs-string">    te_dict[&#x27;updateDate&#x27;]：日期</span>
<span class="hljs-string">    te_dict[&#x27;list&#x27;][0]：累计确诊</span>
<span class="hljs-string">    te_dict[&#x27;list&#x27;][1]：治愈</span>
<span class="hljs-string">    te_dict[&#x27;list&#x27;][2]：死亡</span>
<span class="hljs-string">    te_dict[&#x27;list&#x27;][3]：现有确诊</span>
<span class="hljs-string">    te_dict[&#x27;list&#x27;][4]：新增确诊</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    te_dict = data[<span class="hljs-string">&#x27;component&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;allForeignTrend&#x27;</span>]
    update_date = te_dict[<span class="hljs-string">&#x27;updateDate&#x27;</span>]                <span class="hljs-comment"># 日期</span>
    foreign_confirmed = te_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;data&#x27;</span>]     <span class="hljs-comment"># 每日累计确诊数据</span>
    foreign_crued = te_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;data&#x27;</span>]         <span class="hljs-comment"># 每日累计治愈数据</span>
    foreign_died = te_dict[<span class="hljs-string">&#x27;list&#x27;</span>][<span class="hljs-number">2</span>][<span class="hljs-string">&#x27;data&#x27;</span>]          <span class="hljs-comment"># 每日累计死亡数据</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)

    <span class="hljs-comment"># 写入每日累计确诊数据</span>
    ws_foreign_confirmed = wb.create_sheet(<span class="hljs-string">&#x27;境外每日累计确诊数据&#x27;</span>)
    ws_foreign_confirmed.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, foreign_confirmed):
        ws_foreign_confirmed.append(data)

    <span class="hljs-comment"># 写入累计治愈数据</span>
    ws_foreign_crued = wb.create_sheet(<span class="hljs-string">&#x27;境外每日累计治愈数据&#x27;</span>)
    ws_foreign_crued.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, foreign_crued):
        ws_foreign_crued.append(data)

    <span class="hljs-comment"># 写入累计死亡数据</span>
    ws_foreign_died = wb.create_sheet(<span class="hljs-string">&#x27;境外每日累计死亡数据&#x27;</span>)
    ws_foreign_died.append([<span class="hljs-string">&#x27;日期&#x27;</span>, <span class="hljs-string">&#x27;数据&#x27;</span>])
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(update_date, foreign_died):
        ws_foreign_died.append(data)

    wb.save(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;境外每日累计确诊/治愈/死亡数据已保存至 COVID-19-Global.xlsx！&#x27;</span>)</code></pre>
<h2><span id="6x00-ci-yun-tu-hui-zhi-mo-kuai-data-wordcloud"><font color="#FF0000">【6x00】词云图绘制模块 data_wordcloud</font></span></h2>
<h3><span id="6x01-zhong-guo-lei-ji-que-zhen-ci-yun-tu-foreign-daily-data"><font color="#4876FF">【6x01】中国累计确诊词云图 foreign_daily_data()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">china_wordcloud</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)  <span class="hljs-comment"># 获取已有的xlsx文件</span>
    ws_china = wb[<span class="hljs-string">&#x27;中国省份疫情数据&#x27;</span>]                     <span class="hljs-comment"># 获取中国省份疫情数据表</span>
    ws_china.delete_rows(<span class="hljs-number">1</span>)                             <span class="hljs-comment"># 删除第一行</span>
    china_dict = &#123;&#125;                                     <span class="hljs-comment"># 将省份及其累计确诊按照键值对形式储存在字典中</span>
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> ws_china.values:
        china_dict[data[<span class="hljs-number">0</span>]] = <span class="hljs-built_in">int</span>(data[<span class="hljs-number">2</span>])
    word_cloud = wordcloud.WordCloud(font_path=<span class="hljs-string">&#x27;C:/Windows/Fonts/simsun.ttc&#x27;</span>,
                                     background_color=<span class="hljs-string">&#x27;#CDC9C9&#x27;</span>,
                                     min_font_size=<span class="hljs-number">15</span>,
                                     width=<span class="hljs-number">900</span>, height=<span class="hljs-number">500</span>)
    word_cloud.generate_from_frequencies(china_dict)
    word_cloud.to_file(<span class="hljs-string">&#x27;WordCloud-China.png&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;中国省份疫情词云图绘制完毕！&#x27;</span>)</code></pre>
<h3><span id="6x02-quan-qiu-lei-ji-que-zhen-ci-yun-tu-foreign-daily-data"><font color="#4876FF">【6x02】全球累计确诊词云图 foreign_daily_data()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">global_wordcloud</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)
    ws_global = wb[<span class="hljs-string">&#x27;全球各国疫情数据&#x27;</span>]
    ws_global.delete_rows(<span class="hljs-number">1</span>)
    global_dict = &#123;&#125;
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> ws_global.values:
        global_dict[data[<span class="hljs-number">0</span>]] = <span class="hljs-built_in">int</span>(data[<span class="hljs-number">2</span>])
    word_cloud = wordcloud.WordCloud(font_path=<span class="hljs-string">&#x27;C:/Windows/Fonts/simsun.ttc&#x27;</span>,
                                     background_color=<span class="hljs-string">&#x27;#CDC9C9&#x27;</span>,
                                     width=<span class="hljs-number">900</span>, height=<span class="hljs-number">500</span>)
    word_cloud.generate_from_frequencies(global_dict)
    word_cloud.to_file(<span class="hljs-string">&#x27;WordCloud-Global.png&#x27;</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;全球各国疫情词云图绘制完毕！&#x27;</span>)</code></pre>
<hr>
<pre><code class="hljs yaml"><span class="hljs-string">这里是一段物理防爬虫文本，请读者忽略。</span>
<span class="hljs-string">本文原创首发于</span> <span class="hljs-string">CSDN，作者</span> <span class="hljs-string">ITBOB。</span>
<span class="hljs-string">博客首页：https://itrhx.blog.csdn.net/</span>
<span class="hljs-string">本文链接：https://itrhx.blog.csdn.net/article/details/107140534</span>
<span class="hljs-string">未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！</span></code></pre>
<hr>
<h2><span id="7x00-di-tu-hui-zhi-mo-kuai-data-map"><font color="#FF0000">【7x00】地图绘制模块 data_map</font></span></h2>
<h3><span id="7x01-zhong-guo-lei-ji-que-zhen-di-tu-china-total-map"><font color="#4876FF">【7x01】中国累计确诊地图 china_total_map()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">china_total_map</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)  <span class="hljs-comment"># 获取已有的xlsx文件</span>
    ws_time = wb[<span class="hljs-string">&#x27;中国疫情数据更新时间&#x27;</span>]                   <span class="hljs-comment"># 获取文件中中国疫情数据更新时间表</span>
    ws_data = wb[<span class="hljs-string">&#x27;中国省份疫情数据&#x27;</span>]                      <span class="hljs-comment"># 获取文件中中国省份疫情数据表</span>
    ws_data.delete_rows(<span class="hljs-number">1</span>)                              <span class="hljs-comment"># 删除第一行</span>
    province = []                                       <span class="hljs-comment"># 省份</span>
    curconfirm = []                                     <span class="hljs-comment"># 累计确诊</span>
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> ws_data.values:
        province.append(data[<span class="hljs-number">0</span>])
        curconfirm.append(data[<span class="hljs-number">2</span>])
    time_china = ws_time[<span class="hljs-string">&#x27;A2&#x27;</span>].value                    <span class="hljs-comment"># 更新时间</span>

    <span class="hljs-comment"># 设置分级颜色</span>
    pieces = [
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FFFFFF&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">9</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;1-9&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FFE5DB&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">99</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;10-99&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FF9985&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;100-999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#F57567&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">9999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;1000-9999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#E64546&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">99999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">10000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;≧10000&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#B80909&#x27;</span>&#125;
    ]

    <span class="hljs-comment"># 绘制地图</span>
    ct_map = (
        Map()
        .add(series_name=<span class="hljs-string">&#x27;累计确诊人数&#x27;</span>, data_pair=[<span class="hljs-built_in">list</span>(z) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(province, curconfirm)], maptype=<span class="hljs-string">&quot;china&quot;</span>)
        .set_global_opts(
            title_opts=opts.TitleOpts(title=<span class="hljs-string">&quot;中国疫情数据（累计确诊）&quot;</span>,
                                      subtitle=<span class="hljs-string">&#x27;数据更新至：&#x27;</span> + time_china + <span class="hljs-string">&#x27;\n\n来源：百度疫情实时大数据报告&#x27;</span>),
            visualmap_opts=opts.VisualMapOpts(max_=<span class="hljs-number">300</span>, is_piecewise=<span class="hljs-literal">True</span>, pieces=pieces)
        )
    )
    <span class="hljs-keyword">return</span> ct_map</code></pre>
<h3><span id="7x02-quan-qiu-lei-ji-que-zhen-di-tu-global-total-map"><font color="#4876FF">【7x02】全球累计确诊地图 global_total_map()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">global_total_map</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)
    ws_time = wb[<span class="hljs-string">&#x27;全球疫情数据更新时间&#x27;</span>]
    ws_data = wb[<span class="hljs-string">&#x27;全球各国疫情数据&#x27;</span>]
    ws_data.delete_rows(<span class="hljs-number">1</span>)
    country = []                        <span class="hljs-comment"># 国家</span>
    curconfirm = []                     <span class="hljs-comment"># 累计确诊</span>
    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> ws_data.values:
        country.append(data[<span class="hljs-number">0</span>])
        curconfirm.append(data[<span class="hljs-number">2</span>])
    time_global = ws_time[<span class="hljs-string">&#x27;A2&#x27;</span>].value   <span class="hljs-comment"># 更新时间</span>

    <span class="hljs-comment"># 国家名称中英文映射表</span>
    name_map = &#123;
          <span class="hljs-string">&quot;Somalia&quot;</span>: <span class="hljs-string">&quot;索马里&quot;</span>,
          <span class="hljs-string">&quot;Liechtenstein&quot;</span>: <span class="hljs-string">&quot;列支敦士登&quot;</span>,
          <span class="hljs-string">&quot;Morocco&quot;</span>: <span class="hljs-string">&quot;摩洛哥&quot;</span>,
          <span class="hljs-string">&quot;W. Sahara&quot;</span>: <span class="hljs-string">&quot;西撒哈拉&quot;</span>,
          <span class="hljs-string">&quot;Serbia&quot;</span>: <span class="hljs-string">&quot;塞尔维亚&quot;</span>,
          <span class="hljs-string">&quot;Afghanistan&quot;</span>: <span class="hljs-string">&quot;阿富汗&quot;</span>,
          <span class="hljs-string">&quot;Angola&quot;</span>: <span class="hljs-string">&quot;安哥拉&quot;</span>,
          <span class="hljs-string">&quot;Albania&quot;</span>: <span class="hljs-string">&quot;阿尔巴尼亚&quot;</span>,
          <span class="hljs-string">&quot;Andorra&quot;</span>: <span class="hljs-string">&quot;安道尔共和国&quot;</span>,
          <span class="hljs-string">&quot;United Arab Emirates&quot;</span>: <span class="hljs-string">&quot;阿拉伯联合酋长国&quot;</span>,
          <span class="hljs-string">&quot;Argentina&quot;</span>: <span class="hljs-string">&quot;阿根廷&quot;</span>,
          <span class="hljs-string">&quot;Armenia&quot;</span>: <span class="hljs-string">&quot;亚美尼亚&quot;</span>,
          <span class="hljs-string">&quot;Australia&quot;</span>: <span class="hljs-string">&quot;澳大利亚&quot;</span>,
          <span class="hljs-string">&quot;Austria&quot;</span>: <span class="hljs-string">&quot;奥地利&quot;</span>,
          <span class="hljs-string">&quot;Azerbaijan&quot;</span>: <span class="hljs-string">&quot;阿塞拜疆&quot;</span>,
          <span class="hljs-string">&quot;Burundi&quot;</span>: <span class="hljs-string">&quot;布隆迪&quot;</span>,
          <span class="hljs-string">&quot;Belgium&quot;</span>: <span class="hljs-string">&quot;比利时&quot;</span>,
          <span class="hljs-string">&quot;Benin&quot;</span>: <span class="hljs-string">&quot;贝宁&quot;</span>,
          <span class="hljs-string">&quot;Burkina Faso&quot;</span>: <span class="hljs-string">&quot;布基纳法索&quot;</span>,
          <span class="hljs-string">&quot;Bangladesh&quot;</span>: <span class="hljs-string">&quot;孟加拉国&quot;</span>,
          <span class="hljs-string">&quot;Bulgaria&quot;</span>: <span class="hljs-string">&quot;保加利亚&quot;</span>,
          <span class="hljs-string">&quot;Bahrain&quot;</span>: <span class="hljs-string">&quot;巴林&quot;</span>,
          <span class="hljs-string">&quot;Bahamas&quot;</span>: <span class="hljs-string">&quot;巴哈马&quot;</span>,
          <span class="hljs-string">&quot;Bosnia and Herz.&quot;</span>: <span class="hljs-string">&quot;波斯尼亚和黑塞哥维那&quot;</span>,
          <span class="hljs-string">&quot;Belarus&quot;</span>: <span class="hljs-string">&quot;白俄罗斯&quot;</span>,
          <span class="hljs-string">&quot;Belize&quot;</span>: <span class="hljs-string">&quot;伯利兹&quot;</span>,
          <span class="hljs-string">&quot;Bermuda&quot;</span>: <span class="hljs-string">&quot;百慕大&quot;</span>,
          <span class="hljs-string">&quot;Bolivia&quot;</span>: <span class="hljs-string">&quot;玻利维亚&quot;</span>,
          <span class="hljs-string">&quot;Brazil&quot;</span>: <span class="hljs-string">&quot;巴西&quot;</span>,
          <span class="hljs-string">&quot;Barbados&quot;</span>: <span class="hljs-string">&quot;巴巴多斯&quot;</span>,
          <span class="hljs-string">&quot;Brunei&quot;</span>: <span class="hljs-string">&quot;文莱&quot;</span>,
          <span class="hljs-string">&quot;Bhutan&quot;</span>: <span class="hljs-string">&quot;不丹&quot;</span>,
          <span class="hljs-string">&quot;Botswana&quot;</span>: <span class="hljs-string">&quot;博茨瓦纳&quot;</span>,
          <span class="hljs-string">&quot;Central African Rep.&quot;</span>: <span class="hljs-string">&quot;中非共和国&quot;</span>,
          <span class="hljs-string">&quot;Canada&quot;</span>: <span class="hljs-string">&quot;加拿大&quot;</span>,
          <span class="hljs-string">&quot;Switzerland&quot;</span>: <span class="hljs-string">&quot;瑞士&quot;</span>,
          <span class="hljs-string">&quot;Chile&quot;</span>: <span class="hljs-string">&quot;智利&quot;</span>,
          <span class="hljs-string">&quot;China&quot;</span>: <span class="hljs-string">&quot;中国&quot;</span>,
          <span class="hljs-string">&quot;Côte d&#x27;Ivoire&quot;</span>: <span class="hljs-string">&quot;科特迪瓦&quot;</span>,
          <span class="hljs-string">&quot;Cameroon&quot;</span>: <span class="hljs-string">&quot;喀麦隆&quot;</span>,
          <span class="hljs-string">&quot;Dem. Rep. Congo&quot;</span>: <span class="hljs-string">&quot;刚果（布）&quot;</span>,
          <span class="hljs-string">&quot;Congo&quot;</span>: <span class="hljs-string">&quot;刚果（金）&quot;</span>,
          <span class="hljs-string">&quot;Colombia&quot;</span>: <span class="hljs-string">&quot;哥伦比亚&quot;</span>,
          <span class="hljs-string">&quot;Cape Verde&quot;</span>: <span class="hljs-string">&quot;佛得角&quot;</span>,
          <span class="hljs-string">&quot;Costa Rica&quot;</span>: <span class="hljs-string">&quot;哥斯达黎加&quot;</span>,
          <span class="hljs-string">&quot;Cuba&quot;</span>: <span class="hljs-string">&quot;古巴&quot;</span>,
          <span class="hljs-string">&quot;N. Cyprus&quot;</span>: <span class="hljs-string">&quot;北塞浦路斯&quot;</span>,
          <span class="hljs-string">&quot;Cyprus&quot;</span>: <span class="hljs-string">&quot;塞浦路斯&quot;</span>,
          <span class="hljs-string">&quot;Czech Rep.&quot;</span>: <span class="hljs-string">&quot;捷克&quot;</span>,
          <span class="hljs-string">&quot;Germany&quot;</span>: <span class="hljs-string">&quot;德国&quot;</span>,
          <span class="hljs-string">&quot;Djibouti&quot;</span>: <span class="hljs-string">&quot;吉布提&quot;</span>,
          <span class="hljs-string">&quot;Denmark&quot;</span>: <span class="hljs-string">&quot;丹麦&quot;</span>,
          <span class="hljs-string">&quot;Dominican Rep.&quot;</span>: <span class="hljs-string">&quot;多米尼加&quot;</span>,
          <span class="hljs-string">&quot;Algeria&quot;</span>: <span class="hljs-string">&quot;阿尔及利亚&quot;</span>,
          <span class="hljs-string">&quot;Ecuador&quot;</span>: <span class="hljs-string">&quot;厄瓜多尔&quot;</span>,
          <span class="hljs-string">&quot;Egypt&quot;</span>: <span class="hljs-string">&quot;埃及&quot;</span>,
          <span class="hljs-string">&quot;Eritrea&quot;</span>: <span class="hljs-string">&quot;厄立特里亚&quot;</span>,
          <span class="hljs-string">&quot;Spain&quot;</span>: <span class="hljs-string">&quot;西班牙&quot;</span>,
          <span class="hljs-string">&quot;Estonia&quot;</span>: <span class="hljs-string">&quot;爱沙尼亚&quot;</span>,
          <span class="hljs-string">&quot;Ethiopia&quot;</span>: <span class="hljs-string">&quot;埃塞俄比亚&quot;</span>,
          <span class="hljs-string">&quot;Finland&quot;</span>: <span class="hljs-string">&quot;芬兰&quot;</span>,
          <span class="hljs-string">&quot;Fiji&quot;</span>: <span class="hljs-string">&quot;斐济&quot;</span>,
          <span class="hljs-string">&quot;France&quot;</span>: <span class="hljs-string">&quot;法国&quot;</span>,
          <span class="hljs-string">&quot;Gabon&quot;</span>: <span class="hljs-string">&quot;加蓬&quot;</span>,
          <span class="hljs-string">&quot;United Kingdom&quot;</span>: <span class="hljs-string">&quot;英国&quot;</span>,
          <span class="hljs-string">&quot;Georgia&quot;</span>: <span class="hljs-string">&quot;格鲁吉亚&quot;</span>,
          <span class="hljs-string">&quot;Ghana&quot;</span>: <span class="hljs-string">&quot;加纳&quot;</span>,
          <span class="hljs-string">&quot;Guinea&quot;</span>: <span class="hljs-string">&quot;几内亚&quot;</span>,
          <span class="hljs-string">&quot;Gambia&quot;</span>: <span class="hljs-string">&quot;冈比亚&quot;</span>,
          <span class="hljs-string">&quot;Guinea-Bissau&quot;</span>: <span class="hljs-string">&quot;几内亚比绍&quot;</span>,
          <span class="hljs-string">&quot;Eq. Guinea&quot;</span>: <span class="hljs-string">&quot;赤道几内亚&quot;</span>,
          <span class="hljs-string">&quot;Greece&quot;</span>: <span class="hljs-string">&quot;希腊&quot;</span>,
          <span class="hljs-string">&quot;Grenada&quot;</span>: <span class="hljs-string">&quot;格林纳达&quot;</span>,
          <span class="hljs-string">&quot;Greenland&quot;</span>: <span class="hljs-string">&quot;格陵兰岛&quot;</span>,
          <span class="hljs-string">&quot;Guatemala&quot;</span>: <span class="hljs-string">&quot;危地马拉&quot;</span>,
          <span class="hljs-string">&quot;Guam&quot;</span>: <span class="hljs-string">&quot;关岛&quot;</span>,
          <span class="hljs-string">&quot;Guyana&quot;</span>: <span class="hljs-string">&quot;圭亚那合作共和国&quot;</span>,
          <span class="hljs-string">&quot;Honduras&quot;</span>: <span class="hljs-string">&quot;洪都拉斯&quot;</span>,
          <span class="hljs-string">&quot;Croatia&quot;</span>: <span class="hljs-string">&quot;克罗地亚&quot;</span>,
          <span class="hljs-string">&quot;Haiti&quot;</span>: <span class="hljs-string">&quot;海地&quot;</span>,
          <span class="hljs-string">&quot;Hungary&quot;</span>: <span class="hljs-string">&quot;匈牙利&quot;</span>,
          <span class="hljs-string">&quot;Indonesia&quot;</span>: <span class="hljs-string">&quot;印度尼西亚&quot;</span>,
          <span class="hljs-string">&quot;India&quot;</span>: <span class="hljs-string">&quot;印度&quot;</span>,
          <span class="hljs-string">&quot;Br. Indian Ocean Ter.&quot;</span>: <span class="hljs-string">&quot;英属印度洋领土&quot;</span>,
          <span class="hljs-string">&quot;Ireland&quot;</span>: <span class="hljs-string">&quot;爱尔兰&quot;</span>,
          <span class="hljs-string">&quot;Iran&quot;</span>: <span class="hljs-string">&quot;伊朗&quot;</span>,
          <span class="hljs-string">&quot;Iraq&quot;</span>: <span class="hljs-string">&quot;伊拉克&quot;</span>,
          <span class="hljs-string">&quot;Iceland&quot;</span>: <span class="hljs-string">&quot;冰岛&quot;</span>,
          <span class="hljs-string">&quot;Israel&quot;</span>: <span class="hljs-string">&quot;以色列&quot;</span>,
          <span class="hljs-string">&quot;Italy&quot;</span>: <span class="hljs-string">&quot;意大利&quot;</span>,
          <span class="hljs-string">&quot;Jamaica&quot;</span>: <span class="hljs-string">&quot;牙买加&quot;</span>,
          <span class="hljs-string">&quot;Jordan&quot;</span>: <span class="hljs-string">&quot;约旦&quot;</span>,
          <span class="hljs-string">&quot;Japan&quot;</span>: <span class="hljs-string">&quot;日本&quot;</span>,
          <span class="hljs-string">&quot;Siachen Glacier&quot;</span>: <span class="hljs-string">&quot;锡亚琴冰川&quot;</span>,
          <span class="hljs-string">&quot;Kazakhstan&quot;</span>: <span class="hljs-string">&quot;哈萨克斯坦&quot;</span>,
          <span class="hljs-string">&quot;Kenya&quot;</span>: <span class="hljs-string">&quot;肯尼亚&quot;</span>,
          <span class="hljs-string">&quot;Kyrgyzstan&quot;</span>: <span class="hljs-string">&quot;吉尔吉斯斯坦&quot;</span>,
          <span class="hljs-string">&quot;Cambodia&quot;</span>: <span class="hljs-string">&quot;柬埔寨&quot;</span>,
          <span class="hljs-string">&quot;Korea&quot;</span>: <span class="hljs-string">&quot;韩国&quot;</span>,
          <span class="hljs-string">&quot;Kuwait&quot;</span>: <span class="hljs-string">&quot;科威特&quot;</span>,
          <span class="hljs-string">&quot;Lao PDR&quot;</span>: <span class="hljs-string">&quot;老挝&quot;</span>,
          <span class="hljs-string">&quot;Lebanon&quot;</span>: <span class="hljs-string">&quot;黎巴嫩&quot;</span>,
          <span class="hljs-string">&quot;Liberia&quot;</span>: <span class="hljs-string">&quot;利比里亚&quot;</span>,
          <span class="hljs-string">&quot;Libya&quot;</span>: <span class="hljs-string">&quot;利比亚&quot;</span>,
          <span class="hljs-string">&quot;Sri Lanka&quot;</span>: <span class="hljs-string">&quot;斯里兰卡&quot;</span>,
          <span class="hljs-string">&quot;Lesotho&quot;</span>: <span class="hljs-string">&quot;莱索托&quot;</span>,
          <span class="hljs-string">&quot;Lithuania&quot;</span>: <span class="hljs-string">&quot;立陶宛&quot;</span>,
          <span class="hljs-string">&quot;Luxembourg&quot;</span>: <span class="hljs-string">&quot;卢森堡&quot;</span>,
          <span class="hljs-string">&quot;Latvia&quot;</span>: <span class="hljs-string">&quot;拉脱维亚&quot;</span>,
          <span class="hljs-string">&quot;Moldova&quot;</span>: <span class="hljs-string">&quot;摩尔多瓦&quot;</span>,
          <span class="hljs-string">&quot;Madagascar&quot;</span>: <span class="hljs-string">&quot;马达加斯加&quot;</span>,
          <span class="hljs-string">&quot;Mexico&quot;</span>: <span class="hljs-string">&quot;墨西哥&quot;</span>,
          <span class="hljs-string">&quot;Macedonia&quot;</span>: <span class="hljs-string">&quot;马其顿&quot;</span>,
          <span class="hljs-string">&quot;Mali&quot;</span>: <span class="hljs-string">&quot;马里&quot;</span>,
          <span class="hljs-string">&quot;Malta&quot;</span>: <span class="hljs-string">&quot;马耳他&quot;</span>,
          <span class="hljs-string">&quot;Myanmar&quot;</span>: <span class="hljs-string">&quot;缅甸&quot;</span>,
          <span class="hljs-string">&quot;Montenegro&quot;</span>: <span class="hljs-string">&quot;黑山&quot;</span>,
          <span class="hljs-string">&quot;Mongolia&quot;</span>: <span class="hljs-string">&quot;蒙古国&quot;</span>,
          <span class="hljs-string">&quot;Mozambique&quot;</span>: <span class="hljs-string">&quot;莫桑比克&quot;</span>,
          <span class="hljs-string">&quot;Mauritania&quot;</span>: <span class="hljs-string">&quot;毛里塔尼亚&quot;</span>,
          <span class="hljs-string">&quot;Mauritius&quot;</span>: <span class="hljs-string">&quot;毛里求斯&quot;</span>,
          <span class="hljs-string">&quot;Malawi&quot;</span>: <span class="hljs-string">&quot;马拉维&quot;</span>,
          <span class="hljs-string">&quot;Malaysia&quot;</span>: <span class="hljs-string">&quot;马来西亚&quot;</span>,
          <span class="hljs-string">&quot;Namibia&quot;</span>: <span class="hljs-string">&quot;纳米比亚&quot;</span>,
          <span class="hljs-string">&quot;New Caledonia&quot;</span>: <span class="hljs-string">&quot;新喀里多尼亚&quot;</span>,
          <span class="hljs-string">&quot;Niger&quot;</span>: <span class="hljs-string">&quot;尼日尔&quot;</span>,
          <span class="hljs-string">&quot;Nigeria&quot;</span>: <span class="hljs-string">&quot;尼日利亚&quot;</span>,
          <span class="hljs-string">&quot;Nicaragua&quot;</span>: <span class="hljs-string">&quot;尼加拉瓜&quot;</span>,
          <span class="hljs-string">&quot;Netherlands&quot;</span>: <span class="hljs-string">&quot;荷兰&quot;</span>,
          <span class="hljs-string">&quot;Norway&quot;</span>: <span class="hljs-string">&quot;挪威&quot;</span>,
          <span class="hljs-string">&quot;Nepal&quot;</span>: <span class="hljs-string">&quot;尼泊尔&quot;</span>,
          <span class="hljs-string">&quot;New Zealand&quot;</span>: <span class="hljs-string">&quot;新西兰&quot;</span>,
          <span class="hljs-string">&quot;Oman&quot;</span>: <span class="hljs-string">&quot;阿曼&quot;</span>,
          <span class="hljs-string">&quot;Pakistan&quot;</span>: <span class="hljs-string">&quot;巴基斯坦&quot;</span>,
          <span class="hljs-string">&quot;Panama&quot;</span>: <span class="hljs-string">&quot;巴拿马&quot;</span>,
          <span class="hljs-string">&quot;Peru&quot;</span>: <span class="hljs-string">&quot;秘鲁&quot;</span>,
          <span class="hljs-string">&quot;Philippines&quot;</span>: <span class="hljs-string">&quot;菲律宾&quot;</span>,
          <span class="hljs-string">&quot;Papua New Guinea&quot;</span>: <span class="hljs-string">&quot;巴布亚新几内亚&quot;</span>,
          <span class="hljs-string">&quot;Poland&quot;</span>: <span class="hljs-string">&quot;波兰&quot;</span>,
          <span class="hljs-string">&quot;Puerto Rico&quot;</span>: <span class="hljs-string">&quot;波多黎各&quot;</span>,
          <span class="hljs-string">&quot;Dem. Rep. Korea&quot;</span>: <span class="hljs-string">&quot;朝鲜&quot;</span>,
          <span class="hljs-string">&quot;Portugal&quot;</span>: <span class="hljs-string">&quot;葡萄牙&quot;</span>,
          <span class="hljs-string">&quot;Paraguay&quot;</span>: <span class="hljs-string">&quot;巴拉圭&quot;</span>,
          <span class="hljs-string">&quot;Palestine&quot;</span>: <span class="hljs-string">&quot;巴勒斯坦&quot;</span>,
          <span class="hljs-string">&quot;Qatar&quot;</span>: <span class="hljs-string">&quot;卡塔尔&quot;</span>,
          <span class="hljs-string">&quot;Romania&quot;</span>: <span class="hljs-string">&quot;罗马尼亚&quot;</span>,
          <span class="hljs-string">&quot;Russia&quot;</span>: <span class="hljs-string">&quot;俄罗斯&quot;</span>,
          <span class="hljs-string">&quot;Rwanda&quot;</span>: <span class="hljs-string">&quot;卢旺达&quot;</span>,
          <span class="hljs-string">&quot;Saudi Arabia&quot;</span>: <span class="hljs-string">&quot;沙特阿拉伯&quot;</span>,
          <span class="hljs-string">&quot;Sudan&quot;</span>: <span class="hljs-string">&quot;苏丹&quot;</span>,
          <span class="hljs-string">&quot;S. Sudan&quot;</span>: <span class="hljs-string">&quot;南苏丹&quot;</span>,
          <span class="hljs-string">&quot;Senegal&quot;</span>: <span class="hljs-string">&quot;塞内加尔&quot;</span>,
          <span class="hljs-string">&quot;Singapore&quot;</span>: <span class="hljs-string">&quot;新加坡&quot;</span>,
          <span class="hljs-string">&quot;Solomon Is.&quot;</span>: <span class="hljs-string">&quot;所罗门群岛&quot;</span>,
          <span class="hljs-string">&quot;Sierra Leone&quot;</span>: <span class="hljs-string">&quot;塞拉利昂&quot;</span>,
          <span class="hljs-string">&quot;El Salvador&quot;</span>: <span class="hljs-string">&quot;萨尔瓦多&quot;</span>,
          <span class="hljs-string">&quot;Suriname&quot;</span>: <span class="hljs-string">&quot;苏里南&quot;</span>,
          <span class="hljs-string">&quot;Slovakia&quot;</span>: <span class="hljs-string">&quot;斯洛伐克&quot;</span>,
          <span class="hljs-string">&quot;Slovenia&quot;</span>: <span class="hljs-string">&quot;斯洛文尼亚&quot;</span>,
          <span class="hljs-string">&quot;Sweden&quot;</span>: <span class="hljs-string">&quot;瑞典&quot;</span>,
          <span class="hljs-string">&quot;Swaziland&quot;</span>: <span class="hljs-string">&quot;斯威士兰&quot;</span>,
          <span class="hljs-string">&quot;Seychelles&quot;</span>: <span class="hljs-string">&quot;塞舌尔&quot;</span>,
          <span class="hljs-string">&quot;Syria&quot;</span>: <span class="hljs-string">&quot;叙利亚&quot;</span>,
          <span class="hljs-string">&quot;Chad&quot;</span>: <span class="hljs-string">&quot;乍得&quot;</span>,
          <span class="hljs-string">&quot;Togo&quot;</span>: <span class="hljs-string">&quot;多哥&quot;</span>,
          <span class="hljs-string">&quot;Thailand&quot;</span>: <span class="hljs-string">&quot;泰国&quot;</span>,
          <span class="hljs-string">&quot;Tajikistan&quot;</span>: <span class="hljs-string">&quot;塔吉克斯坦&quot;</span>,
          <span class="hljs-string">&quot;Turkmenistan&quot;</span>: <span class="hljs-string">&quot;土库曼斯坦&quot;</span>,
          <span class="hljs-string">&quot;Timor-Leste&quot;</span>: <span class="hljs-string">&quot;东帝汶&quot;</span>,
          <span class="hljs-string">&quot;Tonga&quot;</span>: <span class="hljs-string">&quot;汤加&quot;</span>,
          <span class="hljs-string">&quot;Trinidad and Tobago&quot;</span>: <span class="hljs-string">&quot;特立尼达和多巴哥&quot;</span>,
          <span class="hljs-string">&quot;Tunisia&quot;</span>: <span class="hljs-string">&quot;突尼斯&quot;</span>,
          <span class="hljs-string">&quot;Turkey&quot;</span>: <span class="hljs-string">&quot;土耳其&quot;</span>,
          <span class="hljs-string">&quot;Tanzania&quot;</span>: <span class="hljs-string">&quot;坦桑尼亚&quot;</span>,
          <span class="hljs-string">&quot;Uganda&quot;</span>: <span class="hljs-string">&quot;乌干达&quot;</span>,
          <span class="hljs-string">&quot;Ukraine&quot;</span>: <span class="hljs-string">&quot;乌克兰&quot;</span>,
          <span class="hljs-string">&quot;Uruguay&quot;</span>: <span class="hljs-string">&quot;乌拉圭&quot;</span>,
          <span class="hljs-string">&quot;United States&quot;</span>: <span class="hljs-string">&quot;美国&quot;</span>,
          <span class="hljs-string">&quot;Uzbekistan&quot;</span>: <span class="hljs-string">&quot;乌兹别克斯坦&quot;</span>,
          <span class="hljs-string">&quot;Venezuela&quot;</span>: <span class="hljs-string">&quot;委内瑞拉&quot;</span>,
          <span class="hljs-string">&quot;Vietnam&quot;</span>: <span class="hljs-string">&quot;越南&quot;</span>,
          <span class="hljs-string">&quot;Vanuatu&quot;</span>: <span class="hljs-string">&quot;瓦努阿图&quot;</span>,
          <span class="hljs-string">&quot;Yemen&quot;</span>: <span class="hljs-string">&quot;也门&quot;</span>,
          <span class="hljs-string">&quot;South Africa&quot;</span>: <span class="hljs-string">&quot;南非&quot;</span>,
          <span class="hljs-string">&quot;Zambia&quot;</span>: <span class="hljs-string">&quot;赞比亚&quot;</span>,
          <span class="hljs-string">&quot;Zimbabwe&quot;</span>: <span class="hljs-string">&quot;津巴布韦&quot;</span>,
          <span class="hljs-string">&quot;Aland&quot;</span>: <span class="hljs-string">&quot;奥兰群岛&quot;</span>,
          <span class="hljs-string">&quot;American Samoa&quot;</span>: <span class="hljs-string">&quot;美属萨摩亚&quot;</span>,
          <span class="hljs-string">&quot;Fr. S. Antarctic Lands&quot;</span>: <span class="hljs-string">&quot;南极洲&quot;</span>,
          <span class="hljs-string">&quot;Antigua and Barb.&quot;</span>: <span class="hljs-string">&quot;安提瓜和巴布达&quot;</span>,
          <span class="hljs-string">&quot;Comoros&quot;</span>: <span class="hljs-string">&quot;科摩罗&quot;</span>,
          <span class="hljs-string">&quot;Curaçao&quot;</span>: <span class="hljs-string">&quot;库拉索岛&quot;</span>,
          <span class="hljs-string">&quot;Cayman Is.&quot;</span>: <span class="hljs-string">&quot;开曼群岛&quot;</span>,
          <span class="hljs-string">&quot;Dominica&quot;</span>: <span class="hljs-string">&quot;多米尼加&quot;</span>,
          <span class="hljs-string">&quot;Falkland Is.&quot;</span>: <span class="hljs-string">&quot;福克兰群岛马尔维纳斯&quot;</span>,
          <span class="hljs-string">&quot;Faeroe Is.&quot;</span>: <span class="hljs-string">&quot;法罗群岛&quot;</span>,
          <span class="hljs-string">&quot;Micronesia&quot;</span>: <span class="hljs-string">&quot;密克罗尼西亚&quot;</span>,
          <span class="hljs-string">&quot;Heard I. and McDonald Is.&quot;</span>: <span class="hljs-string">&quot;赫德岛和麦克唐纳群岛&quot;</span>,
          <span class="hljs-string">&quot;Isle of Man&quot;</span>: <span class="hljs-string">&quot;曼岛&quot;</span>,
          <span class="hljs-string">&quot;Jersey&quot;</span>: <span class="hljs-string">&quot;泽西岛&quot;</span>,
          <span class="hljs-string">&quot;Kiribati&quot;</span>: <span class="hljs-string">&quot;基里巴斯&quot;</span>,
          <span class="hljs-string">&quot;Saint Lucia&quot;</span>: <span class="hljs-string">&quot;圣卢西亚&quot;</span>,
          <span class="hljs-string">&quot;N. Mariana Is.&quot;</span>: <span class="hljs-string">&quot;北马里亚纳群岛&quot;</span>,
          <span class="hljs-string">&quot;Montserrat&quot;</span>: <span class="hljs-string">&quot;蒙特塞拉特&quot;</span>,
          <span class="hljs-string">&quot;Niue&quot;</span>: <span class="hljs-string">&quot;纽埃&quot;</span>,
          <span class="hljs-string">&quot;Palau&quot;</span>: <span class="hljs-string">&quot;帕劳&quot;</span>,
          <span class="hljs-string">&quot;Fr. Polynesia&quot;</span>: <span class="hljs-string">&quot;法属波利尼西亚&quot;</span>,
          <span class="hljs-string">&quot;S. Geo. and S. Sandw. Is.&quot;</span>: <span class="hljs-string">&quot;南乔治亚岛和南桑威奇群岛&quot;</span>,
          <span class="hljs-string">&quot;Saint Helena&quot;</span>: <span class="hljs-string">&quot;圣赫勒拿&quot;</span>,
          <span class="hljs-string">&quot;St. Pierre and Miquelon&quot;</span>: <span class="hljs-string">&quot;圣皮埃尔和密克隆群岛&quot;</span>,
          <span class="hljs-string">&quot;São Tomé and Principe&quot;</span>: <span class="hljs-string">&quot;圣多美和普林西比&quot;</span>,
          <span class="hljs-string">&quot;Turks and Caicos Is.&quot;</span>: <span class="hljs-string">&quot;特克斯和凯科斯群岛&quot;</span>,
          <span class="hljs-string">&quot;St. Vin. and Gren.&quot;</span>: <span class="hljs-string">&quot;圣文森特和格林纳丁斯&quot;</span>,
          <span class="hljs-string">&quot;U.S. Virgin Is.&quot;</span>: <span class="hljs-string">&quot;美属维尔京群岛&quot;</span>,
          <span class="hljs-string">&quot;Samoa&quot;</span>: <span class="hljs-string">&quot;萨摩亚&quot;</span>
        &#125;

    pieces = [
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FFFFFF&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">49</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;1-49&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FFE5DB&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">99</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">50</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;50-99&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FFC4B3&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;100-999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#FF9985&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">9999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">1000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;1000-9999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#F57567&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">99999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">10000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;10000-99999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#E64546&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">999999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">100000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;100000-999999&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#B80909&#x27;</span>&#125;,
        &#123;<span class="hljs-string">&#x27;max&#x27;</span>: <span class="hljs-number">9999999</span>, <span class="hljs-string">&#x27;min&#x27;</span>: <span class="hljs-number">1000000</span>, <span class="hljs-string">&#x27;label&#x27;</span>: <span class="hljs-string">&#x27;≧1000000&#x27;</span>, <span class="hljs-string">&#x27;color&#x27;</span>: <span class="hljs-string">&#x27;#8A0808&#x27;</span>&#125;
    ]

    gt_map = (
        Map()
        .add(series_name=<span class="hljs-string">&#x27;累计确诊人数&#x27;</span>, data_pair=[<span class="hljs-built_in">list</span>(z) <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(country, curconfirm)], maptype=<span class="hljs-string">&quot;world&quot;</span>, name_map=name_map, is_map_symbol_show=<span class="hljs-literal">False</span>)
        .set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>))
        .set_global_opts(
            title_opts=opts.TitleOpts(title=<span class="hljs-string">&quot;全球疫情数据（累计确诊）&quot;</span>,
                                      subtitle=<span class="hljs-string">&#x27;数据更新至：&#x27;</span> + time_global + <span class="hljs-string">&#x27;\n\n来源：百度疫情实时大数据报告&#x27;</span>),
            visualmap_opts=opts.VisualMapOpts(max_=<span class="hljs-number">300</span>, is_piecewise=<span class="hljs-literal">True</span>, pieces=pieces),
        )
    )
    <span class="hljs-keyword">return</span> gt_map</code></pre>
<h3><span id="7x03-zhong-guo-mei-ri-shu-ju-zhe-xian-tu-china-daily-map"><font color="#4876FF">【7x03】中国每日数据折线图 china_daily_map()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">china_daily_map</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-China.xlsx&#x27;</span>)
    ws_china_confirmed = wb[<span class="hljs-string">&#x27;中国每日累计确诊数据&#x27;</span>]
    ws_china_crued = wb[<span class="hljs-string">&#x27;中国每日累计治愈数据&#x27;</span>]
    ws_china_died = wb[<span class="hljs-string">&#x27;中国每日累计死亡数据&#x27;</span>]

    ws_china_confirmed.delete_rows(<span class="hljs-number">1</span>)
    ws_china_crued.delete_rows(<span class="hljs-number">1</span>)
    ws_china_died.delete_rows(<span class="hljs-number">1</span>)

    x_date = []               <span class="hljs-comment"># 日期</span>
    y_china_confirmed = []    <span class="hljs-comment"># 每日累计确诊</span>
    y_china_crued = []        <span class="hljs-comment"># 每日累计治愈</span>
    y_china_died = []         <span class="hljs-comment"># 每日累计死亡</span>

    <span class="hljs-keyword">for</span> china_confirmed <span class="hljs-keyword">in</span> ws_china_confirmed.values:
        y_china_confirmed.append(china_confirmed[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">for</span> china_crued <span class="hljs-keyword">in</span> ws_china_crued.values:
        x_date.append(china_crued[<span class="hljs-number">0</span>])
        y_china_crued.append(china_crued[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">for</span> china_died <span class="hljs-keyword">in</span> ws_china_died.values:
        y_china_died.append(china_died[<span class="hljs-number">1</span>])

    fi_map = (
        Line(init_opts=opts.InitOpts(height=<span class="hljs-string">&#x27;420px&#x27;</span>))
            .add_xaxis(xaxis_data=x_date)
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;中国累计确诊数据&quot;</span>,
            y_axis=y_china_confirmed,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;中国累计治愈趋势&quot;</span>,
            y_axis=y_china_crued,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;中国累计死亡趋势&quot;</span>,
            y_axis=y_china_died,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title=<span class="hljs-string">&quot;中国每日累计确诊/治愈/死亡趋势&quot;</span>),
            legend_opts=opts.LegendOpts(pos_bottom=<span class="hljs-string">&quot;bottom&quot;</span>, orient=<span class="hljs-string">&#x27;horizontal&#x27;</span>),
            tooltip_opts=opts.TooltipOpts(trigger=<span class="hljs-string">&quot;axis&quot;</span>),
            yaxis_opts=opts.AxisOpts(
                type_=<span class="hljs-string">&quot;value&quot;</span>,
                axistick_opts=opts.AxisTickOpts(is_show=<span class="hljs-literal">True</span>),
                splitline_opts=opts.SplitLineOpts(is_show=<span class="hljs-literal">True</span>),
            ),
            xaxis_opts=opts.AxisOpts(type_=<span class="hljs-string">&quot;category&quot;</span>, boundary_gap=<span class="hljs-literal">False</span>),
        )
    )
    <span class="hljs-keyword">return</span> fi_map</code></pre>
<h3><span id="7x04-jing-wai-mei-ri-shu-ju-zhe-xian-tu-foreign-daily-map"><font color="#4876FF">【7x04】境外每日数据折线图 foreign_daily_map()</font></span></h3>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foreign_daily_map</span>():</span>
    wb = openpyxl.load_workbook(<span class="hljs-string">&#x27;COVID-19-Global.xlsx&#x27;</span>)
    ws_foreign_confirmed = wb[<span class="hljs-string">&#x27;境外每日累计确诊数据&#x27;</span>]
    ws_foreign_crued = wb[<span class="hljs-string">&#x27;境外每日累计治愈数据&#x27;</span>]
    ws_foreign_died = wb[<span class="hljs-string">&#x27;境外每日累计死亡数据&#x27;</span>]

    ws_foreign_confirmed.delete_rows(<span class="hljs-number">1</span>)
    ws_foreign_crued.delete_rows(<span class="hljs-number">1</span>)
    ws_foreign_died.delete_rows(<span class="hljs-number">1</span>)

    x_date = []                <span class="hljs-comment"># 日期</span>
    y_foreign_confirmed = []   <span class="hljs-comment"># 累计确诊</span>
    y_foreign_crued = []       <span class="hljs-comment"># 累计治愈</span>
    y_foreign_died = []        <span class="hljs-comment"># 累计死亡</span>

    <span class="hljs-keyword">for</span> foreign_confirmed <span class="hljs-keyword">in</span> ws_foreign_confirmed.values:
        y_foreign_confirmed.append(foreign_confirmed[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">for</span> foreign_crued <span class="hljs-keyword">in</span> ws_foreign_crued.values:
        x_date.append(foreign_crued[<span class="hljs-number">0</span>])
        y_foreign_crued.append(foreign_crued[<span class="hljs-number">1</span>])
    <span class="hljs-keyword">for</span> foreign_died <span class="hljs-keyword">in</span> ws_foreign_died.values:
        y_foreign_died.append(foreign_died[<span class="hljs-number">1</span>])

    fte_map = (
        Line(init_opts=opts.InitOpts(height=<span class="hljs-string">&#x27;420px&#x27;</span>))
            .add_xaxis(xaxis_data=x_date)
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;境外累计确诊趋势&quot;</span>,
            y_axis=y_foreign_confirmed,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;境外累计治愈趋势&quot;</span>,
            y_axis=y_foreign_crued,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .add_yaxis(
            series_name=<span class="hljs-string">&quot;境外累计死亡趋势&quot;</span>,
            y_axis=y_foreign_died,
            label_opts=opts.LabelOpts(is_show=<span class="hljs-literal">False</span>),
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title=<span class="hljs-string">&quot;境外每日累计确诊/治愈/死亡趋势&quot;</span>),
            legend_opts=opts.LegendOpts(pos_bottom=<span class="hljs-string">&quot;bottom&quot;</span>, orient=<span class="hljs-string">&#x27;horizontal&#x27;</span>),
            tooltip_opts=opts.TooltipOpts(trigger=<span class="hljs-string">&quot;axis&quot;</span>),
            yaxis_opts=opts.AxisOpts(
                type_=<span class="hljs-string">&quot;value&quot;</span>,
                axistick_opts=opts.AxisTickOpts(is_show=<span class="hljs-literal">True</span>),
                splitline_opts=opts.SplitLineOpts(is_show=<span class="hljs-literal">True</span>),
            ),
            xaxis_opts=opts.AxisOpts(type_=<span class="hljs-string">&quot;category&quot;</span>, boundary_gap=<span class="hljs-literal">False</span>),
        )
    )
    <span class="hljs-keyword">return</span> fte_map</code></pre>
<h2><span id="8x00-jie-guo-jie-tu"><font color="#FF0000">【8x00】结果截图</font></span></h2>
<h3><span id="8x01-shu-ju-chu-cun-excel"><font color="#4876FF">【8x01】数据储存 Excel</font></span></h3>
<p><img src="https://cdn.itbob.cn/img/article/035/03.png" alt="03"></p>
<p><img src="https://cdn.itbob.cn/img/article/035/04.png" alt="04"></p>
<h3><span id="8x02-ci-yun-tu"><font color="#4876FF">【8x02】词云图</font></span></h3>
<p><img src="https://cdn.itbob.cn/img/article/035/05.png" alt="05"></p>
<p><img src="https://cdn.itbob.cn/img/article/035/06.png" alt="06"></p>
<h3><span id="8x03-di-tu-zhe-xian-tu"><font color="#4876FF">【8x03】地图 + 折线图</font></span></h3>
<p><img src="https://cdn.itbob.cn/img/article/035/07.png" alt="07"></p>
<h2><span id="9x00-wan-zheng-dai-ma"><font color="#FF0000">【9x00】完整代码</font></span></h2>
<p>预览地址：<s><a target="_blank" rel="noopener" href="http://cov.itrhx.com/">http://cov.itrhx.com/</a></s>（已失效）<br>
完整代码地址（点亮 star 有 buff 加成）：<a target="_blank" rel="noopener" href="https://github.com/TRHX/Python3-Spider-Practice">https://github.com/TRHX/Python3-Spider-Practice</a><br>
爬虫实战专栏（持续更新）：<a target="_blank" rel="noopener" href="https://itrhx.blog.csdn.net/article/category/9351278">https://itrhx.blog.csdn.net/article/category/9351278</a></p>
<hr>
<pre><code class="hljs yaml"><span class="hljs-string">这里是一段物理防爬虫文本，请读者忽略。</span>
<span class="hljs-string">本文原创首发于</span> <span class="hljs-string">CSDN，作者</span> <span class="hljs-string">ITBOB。</span>
<span class="hljs-string">博客首页：https://itrhx.blog.csdn.net/</span>
<span class="hljs-string">本文链接：https://itrhx.blog.csdn.net/article/details/107140534</span>
<span class="hljs-string">未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！</span></code></pre>
<hr>

            </div>
        </article>
    </div>
    <br>
    
        <div class="next-prev-post">
            
                <div class="prev-post">
                    <div class="prev gt-c-content-color-first">
                        上一篇：<a href="/article/036/" 
                            class="post-title gt-a-link">Python 实现十大经典排序算法</a>
                    </div>
                </div>
            
            
                <div class="next-post">
                    <div class="next gt-c-content-color-first">
                        下一篇：<a href="/article/034/" 
                            class="post-title gt-a-link">Python 数据分析三剑客之 Pandas（十）：数据读写</a>
                    </div>
                </div>
            
        </div>
    
    

    

    
</div>

                <div class="site-footer gt-c-content-color-first">
    <div class="footer-main">
        <span>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user"></i> UV
                </span>
                <span class="badge-value bg-pink" id="busuanzi_value_site_uv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user-plus"></i> PV
                </span>
                <span class="badge-value bg-blue" id="busuanzi_value_site_pv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-keyboard"></i> Word Count
                </span>
                <span class="badge-value bg-firebrick post-count">202.6k</span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-cog fa-spin"></i> Powered by
                </span>
                <span class="badge-value bg-brightgreen"><a href="https://hexo.io" target="_blank">Hexo</a></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-paper-plane"></i> Theme
                </span>
                <span class="badge-value bg-orange"><a href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a></span>
            </div>
        </span>
        <br/>
        <br/>
        <span style="text-align: center; float: center;">
            Copyright <i class="fa fa-copyright"></i> 2018 - <script>document.write(new Date().getFullYear());</script> <a href="https://www.itbob.cn/" target="_blank">ITBOB.CN</a> 丨
            <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">
                <i class="fab fa-creative-commons"></i>
                <i class="fab fa-creative-commons-by"></i>
                <i class="fab fa-creative-commons-nc"></i>
                <i class="fab fa-creative-commons-nd"></i>
            </a> 丨
            <!-- <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 丨 -->
            <span id="sitetime">正在载入网站运行时间...</span>
            <script>
                function siteTime(){
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth()+1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    /* 
                    Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
                    year - 作为date对象的年份，为4位年份值
                    month - 0-11之间的整数，做为date对象的月份
                    day - 1-31之间的整数，做为date对象的天数
                    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
                    minutes - 0-59之间的整数，做为date对象的分钟数
                    seconds - 0-59之间的整数，做为date对象的秒数
                    microseconds - 0-999之间的整数，做为date对象的毫秒数
                    */
                    var t1 = Date.UTC(2018,08,10,17,38,00); //北京时间2018-8-10 17:38:00
                    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
                    var diff = t2-t1;
                    var diffYears = Math.floor(diff/years);
                    var diffDays = Math.floor((diff/days)-diffYears*365);
                    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
                    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
                    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
                    document.getElementById("sitetime").innerHTML="小破站已运行了 "
                    + "<font style='color:#FE3C65;font-weight:bold'>" + diffYears + "</font>" + " 年 "
                    + "<font style='color:#FFA500;font-weight:bold'>" + diffDays + "</font>" + " 天 "
                    + "<font style='color:#1DBF97;font-weight:bold'>" + diffHours + "</font>" + " 小时 "
                    + "<font style='color:#8A2BE2;font-weight:bold'>" + diffMinutes + "</font>" + " 分 "
                    + "<font style='color:#007EC6;font-weight:bold'>" + diffSeconds + "</font>" + " 秒 ";
                }
                siteTime();
            </script>
        </span>
        <br/>
        <br/>
        <span>
            <img src="https://cdn.itbob.cn/img/footer/icp_48x48.png" class="nofancybox" alt="ICP 备案" style="width:auto; height:20px; margin-bottom:-4px"><a href="https://beian.miit.gov.cn/" target="_blank"> 鄂ICP备19003281号-7</a>丨
            <img src="https://cdn.itbob.cn/img/footer/mps_48x48.png" class="nofancybox" alt="MPS 公网安备" style="width:auto; height:20px; margin-bottom:-4px"><a href="https://beian.mps.gov.cn/" target="_blank"> 鄂公网安备42280202422961</a>
            <img src="https://cdn.itbob.cn/img/footer/moeicp.png" class="nofancybox" alt="MOE ICP" style="width:auto; height:18px; margin-bottom:-3.5px"><a href="https://icp.gov.moe/" target="_blank"> 萌国 No.20202022</a>丨
            <img src="https://cdn.itbob.cn/img/footer/webify.png" class="nofancybox" alt="腾讯云开发 CloudBase" style="width:auto; height:25px; margin-bottom:-8px"><a href="https://cloudbase.net/" target="_blank"> CloudBase</a>丨
            <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src="https://cdn.itbob.cn/img/footer/upyun.png" class="nofancybox" alt="又拍云赞助云存储" style="width:auto; height:19px; margin-bottom:-4px"></a>
            <!-- <a href="https://www.foreverblog.cn/" target="_blank"><img src="https://cdn.itbob.cn/img/footer/foreverblog.png" class="nofancybox" alt="十年之约" style="width:auto; height:15px; margin-bottom:-2px"></a> -->
        </span>
    </div>
</div>

<!-- <div class="sidebar_wo" id="leimu">
    <img src="https://cdn.itbob.cn/img/footer/leimuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/leimuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/leimuA.png'" title="回到底部">
</div>
<div class="sidebar_wo" id="lamu">
    <img src="https://cdn.itbob.cn/img/footer/lamuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/lamuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/lamuA.png'" title="回到顶部">
</div> -->

<script>
    /* 拉姆蕾姆回到顶部或底部按钮 */
    $(function() {
        $("#leimu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:$(document).height()},800);
            return false;
        });
        $("#lamu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:0},800);
            return false;
        });
    });
</script>

            </div>
        </div>
        <!-- <a id="back-to-top" class="back-to-top show hl fa fa-arrow-up" href="javascript:void(0)" title="回到顶部"></a> -->
        <a id="back-to-top" class="back-to-top2" href="javascript:void(0)" title="回到顶部">
            <img class="nofancybox" src="https://cdn.itbob.cn/img/back_to_top.png"/>
        </a>
        <script>
            (function () {
                // When to show the scroll link
                // higher number = scroll link appears further down the page   
                var upperLimit = 100;
                
                // Our scroll link element
                var scrollElem = $('#back-to-top');
            
                // Scroll to top speed
                var scrollSpeed = 500;
            
                // Show and hide the scroll to top link based on scroll position   
                scrollElem.hide();
                $(window).scroll(function () {            
                    var scrollTop = $(document).scrollTop();       
                    if ( scrollTop > upperLimit ) {
                        $(scrollElem).stop().fadeTo(200, 1); // fade back in           
                    }else{       
                        $(scrollElem).stop().fadeTo(200, 0); // fade out
                    }
                });

                // Scroll to top animation on click
                $(scrollElem).click(function(){
                    $('html, body').animate({scrollTop:0}, scrollSpeed); return false;
                });
            })();
        </script>
    </body>
</html>