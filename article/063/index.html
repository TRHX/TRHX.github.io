<!-- 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
-->

<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Force https -->

    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


<!-- Title -->
<title>吾爱破解 2023 春节解题领红包之 Web 题解 - BOB&#39;S BLOG</title>

<!-- Icon -->
<link rel="icon" href="/img/favicon.ico">

<!-- Fonts -->
<link rel="preload" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" as="style" onload="this.onload=null, this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript>

<!-- Font Awesome -->
<!-- https://fontawesome.dashgame.com/ -->
<!-- <link rel="stylesheet" href="https://cdn.itbob.cn/css/font-awesome@5.6.3/all.min.css"> -->
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/5.15.4/css/all.min.css">
<!-- <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css"> -->


    <!-- KaTeX -->
    <!-- //cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css -->
    <link rel="preload" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css" as="style" onload="this.onload=null, this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css"></noscript>


<!-- Style -->

<link rel="stylesheet" href="/styles/main.css">

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-pure@1.0.1/dist/main.css"> -->

<!-- Analytics -->

    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement('script');
                hm.src = 'https://hm.baidu.com/hm.js?6ca34ddce088f8434f3c7509576819f2';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


<!-- Busuanzi -->
<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script async src="//cdn.itbob.cn/js/busuanzi@2.3/busuanzi.pure.mini.js"></script>

<!-- Typeit -->
<!-- https://www.typeitjs.com/ -->
<script src="//unpkg.com/typeit@8.7.0/dist/index.umd.js"></script>

<!-- Fancybox -->

    <link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css">
    <script src="//cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"> </script>
    <script src="//cdn.itbob.cn/js/fancybox@3.5.7/fancybox.js"> </script>

<!-- <script>
  $('[data-fancybox="images"]').fancybox({//可选
    thumbs : {
      autoStart : true //缩略图
    }
  });
  $('[data-fancybox]').fancybox({//启用函数，必须
    protect: true //图片右键不能下载，可选
  });
</script> -->

<!-- Console -->
<script>
    function makeMulti (string) {
        let l = new String(string)
        l = l.substring(l.indexOf("/*") + 3, l.lastIndexOf("*/"))
        return l
    }
    let string = function () {
      /* 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
      */
    }
    console.log(makeMulti(string));
    console.log("\n %c © ITBOB'S BLOG %c https://www.itbob.cn %c © ITRHX'S BLOG %c https://www.itrhx.com \n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;")
</script>

    <meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="BOB'S BLOG" type="application/atom+xml">
</head>
    <body>
        <div class="main gt-bg-theme-color-first">
            <div class="main-content">
                <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="/img/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first" id="typeitspan">
            <!-- BOB&#39;S BLOG -->
        </div>
    </a>
    <!-- <span id="typeitspan"></span> -->
    <script>
        new TypeIt('#typeitspan', {
        strings: "BOB'S BLOG",
        speed: 150, 
        afterComplete: function (instance) {
            instance.destroy();
        }
        }).go();
    </script>
    <button aria-label="Navbar Toggler" class="navbar-toggler" type="button" id="changeNavbar">
        <i class="gt-c-content-color-first" style="font-size: 18px;">
            <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512" height="18px" fill="currentColor">
                <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" />
            </svg>
        </i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center; ">
            
                
                    <div class="nav-item">
                        <a href="/" class="menu gt-a-link" target="_self">首页</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/archives/" class="menu gt-a-link" target="_self">归档</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/tags/" class="menu gt-a-link" target="_self">标签</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/friends/" class="menu gt-a-link" target="_self">友链</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/about/" class="menu gt-a-link" target="_self">关于</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="https://travellings.link" target="_blank">
                            <img src="https://cdn.itbob.cn/img/travelling.gif" class="nofancybox" alt="开往-友链接力" width="auto" height="25px">
                        </a>
                    </div>
                
            
        </div>
    </div>
</nav>

<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = function() {
        let element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else { 
            element.style.display = 'none';
        }
    }
</script>

                <div class="post-container">
    <div class="post-detail gt-bg-theme-color-second gt-c-content-color-first">
        <article class="gt-post-content">
            <h1 class="post-title">吾爱破解 2023 春节解题领红包之 Web 题解</h1>
            <div class="post-info">
                <time class="post-time gt-c-content-color-first">
                    <i class="fa fa-calendar-alt"></i> 首发于: 2023-02-06丨
                </time>
                <span id="busuanzi_container_page_pv">
                    <i class="fas fa-eye"></i> 阅读量: <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>丨
                </span>
                
                    <span class="post-count">
                        <i class="fa fa-keyboard"></i> 字数统计: 2.2k丨
                    </span>
                    <span class="post-count">
                        <i class="fa fa-hourglass-half"></i> 阅读时长: 8分丨
                    </span>
                
                
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/%E7%88%AC%E8%99%AB/" class="post-tag">
                            爬虫</a>
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/JS-%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98/" class="post-tag">
                            JS 逆向实战</a>
                    
                
            </div>
            <hr>
            <div class="post-content gt-c-content-color-first">
                <p><img src="https://cdn.itbob.cn/img/cover/captcha_reverse.png" alt="captcha_reverse"></p>
<center><font color="red" size="5px" weight="bolder">欢迎加入爬虫逆向微信交流群：添加微信 IT-BOB（备注交流群）</font></center>
<h2><span id="wen-zhang-mu-lu">文章目录</span></h2>
<hr>
<!-- toc -->
<ul>
<li><a href="#ti-mu-jian-jie">题目简介</a></li>
<li><a href="#chu-ji-nan-du">初级难度</a>
<ul>
<li><a href="#flag1">flag1</a></li>
<li><a href="#flag2">flag2</a></li>
<li><a href="#flag3">flag3</a></li>
<li><a href="#flag4">flag4</a></li>
<li><a href="#flaga">flagA</a></li>
</ul>
</li>
<li><a href="#zhong-ji-nan-du">中级难度</a>
<ul>
<li><a href="#flag5">flag5</a></li>
<li><a href="#flag6">flag6</a></li>
<li><a href="#flag7">flag7</a></li>
<li><a href="#flag8">flag8</a></li>
<li><a href="#flagb">flagB</a></li>
</ul>
</li>
<li><a href="#gao-ji-nan-du">高级难度</a>
<ul>
<li><a href="#flag9">flag9</a></li>
<li><a href="#flag10">flag10</a></li>
<li><a href="#flag11">flag11</a></li>
<li><a href="#flag12">flag12</a></li>
<li><a href="#flagc">flagC</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->
<hr>
<p><img src="https://cdn.itbob.cn/img/article/063/01.jpg" alt="01"></p>
<p>（图作者 | 吾爱破解@Ps出来的小赵）</p>
<p>吾爱破解每年都有个解题领红包活动，今年也不例外，需要我们使出看家逆向本领来分析内容获得口令红包，根据难度等级不同会获得不同数量的吾爱币，活动持续到元宵节结束。活动一共有十个题，本文仅分享 Web 初级、中级、高级三个题的逆向思路。</p>
<p>活动地址：<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1738015-1-1.html">https://www.52pojie.cn/thread-1738015-1-1.html</a></p>
<h2><span id="ti-mu-jian-jie">题目简介</span></h2>
<p>三个 Web 题的线索都在一个视频里：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV123411R7K6/">https://www.bilibili.com/video/BV123411R7K6/</a></p>
<p>视频中包含 12 个静态 flag: flag1~flag12，另外还需要寻找到 3 个动态 flag: flagA~flagC。 本题总共有 3 个难度，每个难度提交 4 个静态 flag 和 1 个动态 flag 就算通过。</p>
<ul>
<li>初级难度为 flag1~flag4 与 flagA</li>
<li>中级难度为 flag5~flag8 与 flagB</li>
<li>高级难度为 flag9~flag12 与 flagC</li>
</ul>
<p><img src="https://cdn.itbob.cn/img/article/063/02.png" alt="02"></p>
<h2><span id="chu-ji-nan-du">初级难度</span></h2>
<h3><span id="flag1">flag1</span></h3>
<p>flag1 直接在视频中给出了，<code>flag1&#123;52pojiehappynewyear&#125;</code></p>
<p><img src="https://cdn.itbob.cn/img/article/063/03.png" alt="03"></p>
<h3><span id="flag2">flag2</span></h3>
<p>flag2 藏在二维码里，拿手机扫一下会打开一个网址，网址后面跟了一个 <code>flag2&#123;878a48f2&#125;</code>，当然直接搜二维码在线解码也行，上传上去就能看到文本信息。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/04.png" alt="04"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/05.png" alt="05"></p>
<h3><span id="flag3">flag3</span></h3>
<p>在视频 25 秒左右，右下角会出现一串字符 <code>iodj3&#123;06i95dig&#125;</code>，这里肯定是一个 flag，注意观察 flag 是四个字母，iodj 也是四个字母，可以大胆猜测这就是 flag3，在字母上动了手脚，数字和括号没变，极大可能是恺撒密码，恺撒密码是一种替换加密的技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文，例如，当偏移量是3的时候，所有的字母A将被替换成D，B变成E。这里 <code>iodj</code> 每个字母分别向前偏移3，刚好就是 <code>flag</code>，以此类推，最终结果就是 <code>flag3&#123;06f95afd&#125;</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/06.png" alt="06"></p>
<h3><span id="flag4">flag4</span></h3>
<p>flag4 比较鸡贼，没在视频里，而是藏在视频作者的签名里（鼠标无意间瞎晃找到的），解密发现是 Base64，最终结果为 <code>flag4&#123;9cb91117&#125;</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/07.png" alt="07"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/08.png" alt="08"></p>
<h3><span id="flaga">flagA</span></h3>
<p>视频里给了一个网址 <code>2023challenge.52pojie.cn</code>，提示说了这个网站似乎无法访问，但网站的确在运行，它和吾爱破解主站是同一台服务器，可能是域名解析的问题。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/09.png" alt="09"></p>
<p>既然都说了是域名解析问题，那我们就分别在线检测一下 <code>2023challenge.52pojie.cn</code> 和主站 <code>52pojie.cn</code> 的解析设置，首先可以发现 <code>2023challenge.52pojie.cn</code> 的 TXT 记录里有个 flagB，这个后面再说，与主站对比发现 A 记录里少了 <code>124.232.185.97</code>，提示也说了和主站是同一台服务器，所以我们可以在本地 host 里加上这个记录即可访问。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/10.png" alt="10"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/11.png" alt="11"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/12.png" alt="12"></p>
<p>访问网站 <code>https://2023challenge.52pojie.cn/</code>，可以在 <code>Response Header</code> 里找到一个 <code>X-Dynamic-Flag</code>，也就是动态 flagA，如下图所示：</p>
<p><img src="https://cdn.itbob.cn/img/article/063/13.png" alt="13"></p>
<p>既然是动态的，那就不可能直接是 <code>flagA&#123;Header X-52PoJie-Uid Not Found&#125;</code>，很明显给的提示是 Header 里缺少了 <code>X-52PoJie-Uid</code>，所以我们在请求的时候 Header 里加上这个字段试试，Python 代码如下：</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> requests


headers = &#123;
    <span class="hljs-string">&quot;X-52PoJie-Uid&quot;</span>: <span class="hljs-string">&quot;2002241&quot;</span>,  <span class="hljs-comment"># 你的吾爱破解 UID</span>
    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;2023challenge.52pojie.cn&quot;</span>,
    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36&quot;</span>
&#125;
url = <span class="hljs-string">&quot;https://2023challenge.52pojie.cn/&quot;</span>
response = requests.get(url, headers=headers)
flagA = response.headers[<span class="hljs-string">&quot;X-Dynamic-Flag&quot;</span>]
<span class="hljs-built_in">print</span>(flagA)</code></pre>
<p>查看返回的 Header 里的 <code>X-Dynamic-Flag</code>，就是正确的 flagA，有个过期时间，在过期前提交即可。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/14.png" alt="14"></p>
<h2><span id="zhong-ji-nan-du">中级难度</span></h2>
<h3><span id="flag5">flag5</span></h3>
<p>在视频第30秒左右的时候，会出现类似发电报的声音，这就是摩斯密码（摩尔斯电码），对着下表听就完事儿了，当然还有更准确的方法，那就是分析音频的频谱图，更加直观，音频的分析后文 flag8 再说，这里的正确答案是 <code>flag5&#123;eait&#125;</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/15.png" alt="15"></p>
<h3><span id="flag6">flag6</span></h3>
<p>flag6 比较直观，视频开头就直接给出了，电话拨号声就是 flag6。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/16.png" alt="16"></p>
<p>重点在于如何识别拨号的数字，这里涉及到一个双音多频信号（DTMF）的概念，双音多频由高频群和低频群组成，高低频群各包含4个频率。一个高频信号和一个低频信号叠加组成一个组合信号，代表一个数字。可以使用 Python 读取音频来识别，也有现成的工具 DTMF2NUM 可以识别，具体介绍参考：<a target="_blank" rel="noopener" href="https://bbs.qsnctf.com/thread-318-1-1.html">https://bbs.qsnctf.com/thread-318-1-1.html</a> ，里面有下载链接。使用录音工具将这段拨号音录成 wav 格式，然后通过工具识别得到 <code>flag6&#123;590124&#125;</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/17.png" alt="17"></p>
<h3><span id="flag7">flag7</span></h3>
<p>视频中，第22秒左右，上方出现的一串 0101 的东西，这就是 flag7，实际上是二进制形式的 ASCII 码，八位一个字符，例如 <code>01100110</code> 对应的 ASCII 码就是 <code>f</code>，找个在线工具转换一下就可以得到 <code>flag7&#123;5d06be63&#125;</code>。</p>
<pre><code class="hljs toml">01100110 01101100 01100001 01100111 00110111 01111011 00110101 01100100 00110000 00110110 01100010 01100101 00110110 00110011 01111101</code></pre>
<p><img src="https://cdn.itbob.cn/img/article/063/18.png" alt="18"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/19.png" alt="19"></p>
<h3><span id="flag8">flag8</span></h3>
<p>flag8 藏在这个视频的音频里，同样将音频录下来，用 Audacity 软件打开此音频，选择频谱图，就可以看到 <code>flag8&#123;c394d7&#125;</code>，同样前面的 flag5 其实除了直接用耳朵听以外，也可以通过这个频谱图查看。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/20.png" alt="20"></p>
<h3><span id="flagb">flagB</span></h3>
<p>flagB 在前面推理 flagA 的时候已经遇到了，线索在 <code>2023challenge.52pojie.cn</code> 的域名解析，TXT 记录里，计算方法就是自己的 uid 加上字符串 <code>_happy_new_year_</code> 加上时间戳除以 600 并向下取整后的值，经过 md5 加密后，取前八位即可。</p>
<pre><code class="hljs javascript">flagB&#123;substr(md5(uid+\_happy_new_year_\+floor(timestamp/<span class="hljs-number">600</span>)),<span class="hljs-number">0</span>,<span class="hljs-number">8</span>)&#125;</code></pre>
<p><img src="https://cdn.itbob.cn/img/article/063/21.png" alt="21"></p>
<h2><span id="gao-ji-nan-du">高级难度</span></h2>
<h3><span id="flag9">flag9</span></h3>
<p>仔细听这个视频，在结尾，也就是大概40秒的时候，依稀有一段杂音，单独将这一段录下来，反向播放，就会发现说的正是 flag9，正确答案是 <code>flag9&#123;21c5f8&#125;</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/22.png" alt="22"></p>
<h3><span id="flag10">flag10</span></h3>
<p>flag10 太难了没找到，有知道的小伙伴可以分享一下。</p>
<h3><span id="flag11">flag11</span></h3>
<p>视频里，底下一串 <code>++++[&gt;</code> 的东西就是 flag11，这一串是 Brainfuck 语言，是一种非常接近图灵机的编程语言。可以直接使用在线工具转换即可：<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a> ，正确答案是 <code>flag11&#123;63418de7&#125;</code>。</p>
<pre><code class="hljs to">++++++++++[&gt;++++++++++&gt;++++++++++&gt;+++++&gt;++++++++++++&lt;&lt;&lt;&lt;-]&gt;++.++++++.&gt;---.&lt;-----.&gt;&gt;-..&gt;+++.&lt;+++++.---.+.---.+++++++.&lt;+++.+.&gt;-.&gt;++.</code></pre>
<p><img src="https://cdn.itbob.cn/img/article/063/23.png" alt="23"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/24.png" alt="24"></p>
<h3><span id="flag12">flag12</span></h3>
<p>仔细观察视频你会发现，开头的背景是灰色的，在第20秒左右，颜色就加深了，其实开始的背景图是有猫腻的，用到了图片盲水印技术，flag12 就藏在背景图片里，原理就是使用傅里叶变换把原图变为频谱图，再叠加水印，将含水印的频谱图进行傅里叶逆变换得到含水印的图像。蚁景网络安全的这篇文章有详细的介绍：<a target="_blank" rel="noopener" href="https://blog.csdn.net/YJ_12340/article/details/127087949">https://blog.csdn.net/YJ_12340/article/details/127087949</a> ，我们直接使用文中的方法，使用 Python 处理图片后即可得到 <code>flag12&#123;3ac97e24&#125;</code>。</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt


<span class="hljs-comment"># 读取为灰度图像，52pj.png 为视频开头的背景截图</span>
img = cv2.imread(<span class="hljs-string">&#x27;52pj.png&#x27;</span>, <span class="hljs-number">0</span>)
f = np.fft.fft2(img)
<span class="hljs-comment"># 将图像中的低频部分移动到图像的中心</span>
fshift = np.fft.fftshift(f)
<span class="hljs-comment"># 取绝对值：将复数变化成实数，目的为了将数据变化到较小的范围（比如0-255）</span>
s1 = np.log(np.<span class="hljs-built_in">abs</span>(f))
s2 = np.log(np.<span class="hljs-built_in">abs</span>(fshift))
plt.subplot(<span class="hljs-number">121</span>), plt.imshow(s1, <span class="hljs-string">&#x27;gray&#x27;</span>), plt.title(<span class="hljs-string">&#x27;original&#x27;</span>)
plt.subplot(<span class="hljs-number">122</span>), plt.imshow(s2, <span class="hljs-string">&#x27;gray&#x27;</span>), plt.title(<span class="hljs-string">&#x27;center&#x27;</span>)
plt.show()</code></pre>
<p>下图可能平台会有压缩看不清，自己照着处理一下即可。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/25.png" alt="25"></p>
<h3><span id="flagc">flagC</span></h3>
<p>flagC 是动态的，还得回到 <code>https://2023challenge.52pojie.cn/</code> 这个网站上来。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/26.png" alt="26"></p>
<p>点击登陆后，来到 <code>login</code> 页面，让我们提交 UID，但是这个输入框无法输入，修改一下源码，将 <code>disabled</code> 删除即可。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/27.png" alt="27"></p>
<p>然后输入我们的 UID，提示您不是 admin，你没有权限获取 flag。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/28.png" alt="28"></p>
<p>抓包分析一下，发现在点击提交后，<code>Response Headers</code> 有个 <code>Set-Cookie</code>，而这个 cookie 由三段组成，以 <code>.</code> 分隔，很明显是一个 JWT（JSON Web Token）。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/29.png" alt="29"></p>
<p>JWT 是可以解密的，来到 <code>jwt.io</code> 这个网站，解密后可以发现 payload 部分包含了我们的 uid 和 role 角色信息，此刻我们是普通的 user，直接将其改为 admin 即可，将生成的新 JWT 拿来重新提交，即可拿到正确的 flagC。</p>
<p><img src="https://cdn.itbob.cn/img/article/063/30.png" alt="30"></p>
<p><img src="https://cdn.itbob.cn/img/article/063/31.png" alt="31"></p>

            </div>
        </article>
    </div>
    <br>
    
        <div class="next-prev-post">
            
                <div class="prev-post">
                    <div class="prev gt-c-content-color-first">
                        上一篇：<a href="/article/064/" 
                            class="post-title gt-a-link">极验三代、四代无感验证（一键通过）逆向分析</a>
                    </div>
                </div>
            
            
                <div class="next-post">
                    <div class="next gt-c-content-color-first">
                        下一篇：<a href="/article/062/" 
                            class="post-title gt-a-link">极验业务安全，深知 V2 业务风控逆向分析</a>
                    </div>
                </div>
            
        </div>
    
    

    
    <script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>

    <div id="gitalk-container"></div>

    <script>
    var gitalk = new Gitalk({
        clientID: 'd19a84b9d9a2ddb2c6b9',
        clientSecret: 'cec9feae5129a6106edc68ce06d167be8eb06021',
        repo: 'trhx.github.io',
        owner: 'TRHX',
        admin: ['TRHX'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false       // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
    </script>


    
</div>

                <div class="site-footer gt-c-content-color-first">
    <div class="footer-main">
        <!-- 建议保留版权信息或者添加主题信息到友链，感谢您的理解 -->
        <!-- 文件位置：layout/_includes/footer.ejs -->
        <!-- <span style="text-align: right; float: right;">
            Theme 
            <a href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a>
             | Powered by
            <a href="https://hexo.io" target="_blank">Hexo</a>
        </span>
        <span style="text-align: left;"></span> -->
        <span>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user"></i> UV
                </span>
                <span class="badge-value bg-pink" id="busuanzi_value_site_uv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user-plus"></i> PV
                </span>
                <span class="badge-value bg-blue" id="busuanzi_value_site_pv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-keyboard"></i> Word Count
                </span>
                <span class="badge-value bg-firebrick post-count">314.6k</span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-cog fa-spin"></i> Powered by
                </span>
                <span class="badge-value bg-brightgreen"><a href="https://hexo.io" target="_blank">Hexo</a></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-paper-plane"></i> Theme
                </span>
                <span class="badge-value bg-orange"><a href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a></span>
            </div>
        </span>
        <br/>
        <br/>

        <span style="text-align: center; float: center;">
            Copyright <i class="fa fa-copyright"></i> 2018 - <script>document.write(new Date().getFullYear());</script> <a href="https://www.itbob.cn/" target="_blank">ITBOB.CN</a> 丨
            <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">
                <i class="fab fa-creative-commons"></i>
                <i class="fab fa-creative-commons-by"></i>
                <i class="fab fa-creative-commons-nc"></i>
                <i class="fab fa-creative-commons-nd"></i>
            </a> 丨
            <!-- <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 丨 -->
            <span id="sitetime">正在载入网站运行时间...</span>
            <script>
                function siteTime(){
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth()+1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    /* 
                    Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
                    year - 作为date对象的年份，为4位年份值
                    month - 0-11之间的整数，做为date对象的月份
                    day - 1-31之间的整数，做为date对象的天数
                    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
                    minutes - 0-59之间的整数，做为date对象的分钟数
                    seconds - 0-59之间的整数，做为date对象的秒数
                    microseconds - 0-999之间的整数，做为date对象的毫秒数
                    */
                    var t1 = Date.UTC(2018,08,10,17,38,00); //北京时间2018-8-10 17:38:00
                    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
                    var diff = t2-t1;
                    var diffYears = Math.floor(diff/years);
                    var diffDays = Math.floor((diff/days)-diffYears*365);
                    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
                    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
                    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
                    document.getElementById("sitetime").innerHTML="小破站已运行了 "
                    + "<font style='color:#FE3C65;font-weight:bold'>" + diffYears + "</font>" + " 年 "
                    + "<font style='color:#FFA500;font-weight:bold'>" + diffDays + "</font>" + " 天 "
                    + "<font style='color:#1DBF97;font-weight:bold'>" + diffHours + "</font>" + " 小时 "
                    + "<font style='color:#8A2BE2;font-weight:bold'>" + diffMinutes + "</font>" + " 分 "
                    + "<font style='color:#007EC6;font-weight:bold'>" + diffSeconds + "</font>" + " 秒 ";
                }
                siteTime();
            </script>
        </span>
        <br/>
        <br/>
        <span>
            <img src="https://cdn.itbob.cn/img/footer/icp.png" class="nofancybox" alt="ICP" style="width:auto; height:20px; margin-bottom:-4px"><a href="https://beian.miit.gov.cn/" target="_blank"> 鄂ICP备19003281号-7</a>丨
            <img src="https://cdn.itbob.cn/img/footer/moeicp.png" class="nofancybox" alt="MOE ICP" style="width:auto; height:18px; margin-bottom:-3.5px"><a href="https://icp.gov.moe/" target="_blank"> 萌ICP备20202022号</a>丨
            <img src="https://cdn.itbob.cn/img/footer/webify.png" class="nofancybox" alt="腾讯云开发 Webify" style="width:auto; height:25px; margin-bottom:-8px"><a href="https://webify.cloudbase.net/" target="_blank"> 云开发 Webify</a>丨
            <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src="https://cdn.itbob.cn/img/footer/upyun.png" class="nofancybox" alt="又拍云赞助云存储" style="width:auto; height:19px; margin-bottom:-4px"></a> 赞助CDN/COS服务丨
            <a href="https://www.foreverblog.cn/" target="_blank"><img src="https://cdn.itbob.cn/img/footer/foreverblog.png" class="nofancybox" alt="十年之约" style="width:auto; height:15px; margin-bottom:-2px"></a>
        </span>
    </div>
</div>

<!-- <div class="sidebar_wo" id="leimu">
    <img src="https://cdn.itbob.cn/img/footer/leimuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/leimuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/leimuA.png'" title="回到底部">
</div>
<div class="sidebar_wo" id="lamu">
    <img src="https://cdn.itbob.cn/img/footer/lamuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/lamuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/lamuA.png'" title="回到顶部">
</div> -->

<script>
    /* 拉姆蕾姆回到顶部或底部按钮 */
    $(function() {
        $("#leimu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:$(document).height()},800);
            return false;
        });
        $("#lamu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:0},800);
            return false;
        });
    });
</script>

            </div>
        </div>
        <!-- <a id="back-to-top" class="back-to-top show hl fa fa-arrow-up" href="javascript:void(0)" title="回到顶部"></a> -->
        <a id="back-to-top" class="back-to-top2" href="javascript:void(0)" title="回到顶部">
            <img class="nofancybox" src="https://cdn.itbob.cn/img/back_to_top.png"/>
        </a>
        <script>
            (function () {
                // When to show the scroll link
                // higher number = scroll link appears further down the page   
                var upperLimit = 100;
                
                // Our scroll link element
                var scrollElem = $('#back-to-top');
            
                // Scroll to top speed
                var scrollSpeed = 500;
            
                // Show and hide the scroll to top link based on scroll position   
                scrollElem.hide();
                $(window).scroll(function () {            
                    var scrollTop = $(document).scrollTop();       
                    if ( scrollTop > upperLimit ) {
                        $(scrollElem).stop().fadeTo(200, 1); // fade back in           
                    }else{       
                        $(scrollElem).stop().fadeTo(200, 0); // fade out
                    }
                });

                // Scroll to top animation on click
                $(scrollElem).click(function(){
                    $('html, body').animate({scrollTop:0}, scrollSpeed); return false;
                });
            })();
        </script>
    </body>
</html>