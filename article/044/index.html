<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="code-gf1mflsgGo" />
    <!--
        © Material Theme
        https://github.com/bollnh/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>





    <link rel="dns-prefetch" href="https://hm.baidu.com"/>

    <link rel="dns-prefetch" href="https://www.google-analytics.com"/>



    <link rel="dns-prefetch" href="https://fonts.proxy.ustclug.org"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析 | 
        
        ITBOB&#39;S BLOG
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！">
    <meta name="keywords" content="ITRHX,TRHX,ITBOB,BOB,爬虫,Python爬虫,数据分析,数据可视化,逆向,逆向安全,JS逆向,安卓逆向,Android逆向,APP逆向,Python,JavaScript,JS 逆向,爬虫">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?T9bls9Il4KYK54s9694XsA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?H4vLb99nOZsM9O+Kbkw8rw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/atelier-forest-light.min.css?HdofjyGu7b4PtoyvVcYV4A==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
    body,
    html {
        font-family: Noto Sans SC, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
        overflow-x: hidden !important;
    }
    
    code {
        font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    }
    
    a {
        color: #00838F;
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge {
        background-color: #0097A7 !important;
    }
    /* Sidebar User Drop Down Menu Text Color */
    
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
        color: #0097A7 !important;
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover>a,
    .sidebar-colored .sidebar-nav li:hover>a i,
    .sidebar-colored .sidebar-nav li>a:hover,
    .sidebar-colored .sidebar-nav li>a:hover i,
    .sidebar-colored .sidebar-nav li>a:focus i,
    .sidebar-colored .sidebar-nav>.open>a,
    .sidebar-colored .sidebar-nav>.open>a:hover,
    .sidebar-colored .sidebar-nav>.open>a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
        color: #0097A7 !important;
    }
    
    .toTop {
        background: #757575 !important;
    }
    
    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
        color: #757575;
    }
    
    #scheme-Paradox .MD-burger-layer {
        background-color: #757575;
    }
    
    #scheme-Paradox #post-toc-trigger-btn {
        color: #757575;
    }
    
    .post-toc a:hover {
        color: #00838F;
        text-decoration: underline;
    }
</style>


<!-- Theme Background Related-->

        <style>
            body {
                background-color: #F5F5F5;
            }
            /* blog_info bottom background */
            
            #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
                background-color: #fff;
            }
        </style>
        



                <!-- Fade Effect -->
                
                    <style>
                        .fade {
                            transition: all 800ms linear;
                            -webkit-transform: translate3d(0, 0, 0);
                            -moz-transform: translate3d(0, 0, 0);
                            -ms-transform: translate3d(0, 0, 0);
                            -o-transform: translate3d(0, 0, 0);
                            transform: translate3d(0, 0, 0);
                            opacity: 1;
                        }
                        
                        .fade.out {
                            opacity: 0;
                        }
                    </style>
                    

                        <!-- Import Font -->
                        <!-- Import Roboto -->

    <!-- <link href="https://fonts.proxy.ustclug.org/css?family=ZCOOL%20XiaoWei:300,400,500" rel="stylesheet"> -->
    <link href="https://fonts.proxy.ustclug.org/css?family=Noto+Sans+SC:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>



    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    
    
    <!-- 枫叶飘落 -->
    <script>lsloader.load("undefined","/js/leave.min.js?jxgh475VpQSPx5JpWEZ6lA==", true)</script>

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ITBOB&#39;S BLOG">
    <meta name="msapplication-starturl" content="https://www.itbob.cn/article/044/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="ITBOB&#39;S BLOG">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    
        
            <link rel=alternate type="application/atom+xml" href="/atom.xml">
        
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://www.itbob.cn/article/044/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析 | ITBOB&#39;S BLOG">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！">
    <meta property="og:article:tag" content="JS 逆向"> <meta property="og:article:tag" content="爬虫"> 

    
        <meta property="article:published_time" content="Mon Jan 10 2022 17:30:00 GMT+0800">
        <meta property="article:modified_time" content="Sun May 22 2022 20:49:00 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://www.itbob.cn/article/044/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://www.itbob.cn/article/044/index.html",
    "headline": "【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析",
    "datePublished": "Mon Jan 10 2022 17:30:00 GMT+0800",
    "dateModified": "Sun May 22 2022 20:49:00 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "BOB",
        "image": {
            "@type": "ImageObject",
            "url": "/img/BOB.png"
        },
        "description": "Hi, nice to meet you"
    },
    "publisher": {
        "@type": "Organization",
        "name": "ITBOB&#39;S BLOG",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",JS 逆向,爬虫ITRHX,TRHX,ITBOB,BOB,爬虫,Python爬虫,数据分析,数据可视化,逆向,逆向安全,JS逆向,安卓逆向,Android逆向,APP逆向,Python,JavaScript",
    "description": "BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！",
}
</script>


    

    <!-- Analytics -->
    
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'G-FLNER0M8ML', 'auto');ga('send', 'pageview');
</script>
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?6ca34ddce088f8434f3c7509576819f2';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 5.4.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A3%B0%E6%98%8E"><span class="post-toc-number">1.</span> <span class="post-toc-text">声明</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%80%86%E5%90%91%E7%9B%AE%E6%A0%87"><span class="post-toc-number">2.</span> <span class="post-toc-text">逆向目标</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="post-toc-number">3.</span> <span class="post-toc-text">写在前面</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BB%95%E8%BF%87%E6%97%A0%E9%99%90-debugger"><span class="post-toc-number">4.</span> <span class="post-toc-text">绕过无限 debugger</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">方法一</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">方法二</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">方法三</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90"><span class="post-toc-number">5.</span> <span class="post-toc-text">抓包分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8A%A0%E5%AF%86%E5%85%A5%E5%8F%A3"><span class="post-toc-number">6.</span> <span class="post-toc-text">加密入口</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8A%A8%E6%80%81-JS"><span class="post-toc-number">7.</span> <span class="post-toc-text">动态 JS</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%94%B9%E5%86%99"><span class="post-toc-number">8.</span> <span class="post-toc-text">本地改写</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 100 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.webp');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/BOB.png" width="44px" height="44px" class="itbob-author-avatar" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>BOB</strong>
        <!-- <span>1月 10, 2022</span> -->
        <span>2022-01-10 17:30:00</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!-- <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button> -->
   

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item" style="text-align:center; color:#E30B20; font-weight:600">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACcUlEQVR42u3aQW7DMAwEwPz/0+21QGt3SVqyE4xPQZDYmhxIZcXX10dfLzw8PDw8PDw8vIfxXvF19K0/HnD6fu8phW/h4eHhbeH9U2oPHpy88/P936/Pn95cGx4eHt5G3lHBTV6f3zMp98mzzj+Ph4eH9168vIjnrQIPDw/v83h56U+CiaTB4OHh4T2Nl/zhT5ZVbQz50pdnLXh4eHgxLz9k2v966/keHh4eXsArjzTNC/egDUQrxMPDw1vMywtxdbs8ORKbrAcPDw9vDy+/RbLhPo968yHX5P6jfwx4eHh4A15espOll0t56xDu8GfCw8PDW8xLSnN+5F8NYfOnXxDj4uHh4V3K6w0/JcFE3mzySOKf7TseHh7eYl6ypc43vr020/sp8fDw8J7Am2yOJ8NbvZi4nLXg4eHhbeHlIW81qughR5MReHh4eJfy8iJeDRrOGZNxhMsmI/Dw8PBavDyETZbYu3810sXDw8O7i5csrlesJxHtqM3g4eHhLeZVA4L5Vrh3kHZZ1oKHh4c35k1i2bzEV0cH8sgYDw8Pbz+vOnTVC2fz0YRetIGHh4d3Fy9vD3lBn7SH6n3w8PDw7uX1HlwdO6j+WNF38fDw8Dby8qGrSaHPF51HIXh4eHg7edWrWtDnzaB6bIaHh4e3mjcpypNNc/KT5c0JDw8Pbz8vD0zzo6lyiFAcvcLDw8N7Aq9XoKtNJR9yTT6Jh4eH9y68ZEyq2k6qUe/ClBoPDw9v2QFYlTQ5Bits3/Hw8PA28pIwIg9Ve3euNgY8PDy8u3jVCCA/4K9S8zZQCCPw8PDwLuV93oWHh4eHh4eHh/eA6xtX3BYRIyBBBgAAAABJRU5ErkJggg==">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/JS-%E9%80%86%E5%90%91/" rel="tag">JS 逆向</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    <!-- Leancloud Views -->
    <!--  -->
    
    
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span class="post-count">本文字数&nbsp;3.7k 字</span>
        </li>
    </a>
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span class="post-count">阅读时长&nbsp;15 分</span>
        </li>
    </a>
    
    <!-- Busuanzi Views -->
    
        
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        本文浏览量&nbsp;<span id="busuanzi_value_page_pv"></span>
                    </span>
                </li>
            </a>
        
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=ITBOB&#39;S BLOG&title=【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析&summary=BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！&pics=https://www.itbob.cn/img/favicon.png&url=https://www.itbob.cn/article/044/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析&url=https://www.itbob.cn/article/044/index.html&pic=https://www.itbob.cn/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析&url=https://www.itbob.cn/article/044/index.html&via=BOB" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://www.itbob.cn/article/044/index.html&text=【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://www.itbob.cn/article/044/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.itbob.cn/article/044/index.html&title=【JS 逆向】某空气质量监测平台无限 debugger 以及数据动态加密分析" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    


    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://www.itbob.cn/article/044/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p><strong>本文章中所有内容仅供学习交流，抓包内容、敏感网址、数据接口均已做脱敏处理，严禁用于商业用途和非法用途，否则由此产生的一切后果均与作者无关，若有侵权，请联系我立即删除！</strong></p>
<h2 id="逆向目标"><a href="#逆向目标" class="headerlink" title="逆向目标"></a>逆向目标</h2><ul>
<li>目标：某空气质量监测平台无限 debugger 以及请求数据、返回数据动态加密、解密</li>
<li>主页：<code>aHR0cHM6Ly93d3cuYXFpc3R1ZHkuY24v</code></li>
<li>接口：<code>aHR0cHM6Ly93d3cuYXFpc3R1ZHkuY24vYXBpbmV3L2FxaXN0dWR5YXBpLnBocA==</code></li>
</ul>
<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>这个站点更新频率很高，在我之前也已经有很多博主写了该站点的分析文章，近期有读者问请求数据的加密和返回数据的解密，发现其加解密 JS 变成了动态的，以前的那些文章提到的解决思路不太行了，但整体上来说也不是很难，只不过处理起来比较麻烦一点，还有一些小细节需要注意。</p>
<p>在网站的“关于系统”里可以看到，这个站貌似是个人开发者在维护，最早在2013年就有了，在友情赞助列表里，可以看到大多数都是一些环境、测绘、公共卫生相关的大学专业、研究院人员，可以猜测到这些数据对于他们的研究是非常有帮助的，再加上反爬更新频繁，可以看出站长饱受爬虫之苦，K哥也不想给站长添加负担，毕竟这种站点咱们应该支持，让他长久维护下去，<strong>所以本期K哥只分析逻辑和少部分代码，就不放完整代码了，如果有相关专业人士确实需要抓取数据做研究的，可以在公众号后台联系我。</strong></p>
<h2 id="绕过无限-debugger"><a href="#绕过无限-debugger" class="headerlink" title="绕过无限 debugger"></a>绕过无限 debugger</h2><p>右键 F12，会提示右键被禁用，不要紧，使用快捷键 <code>Ctrl+Shift+i</code> 或者浏览器右上角，更多工具，开发者工具，照样能打开。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/389c5830317031a092ffe6ddd0c10050.png#pic_center" alt="01.png"></p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>打开控制台后会进入第一个无限 debugger，往上跟一个栈，可以看到一个 try-catch 语句，你下断点会发现他会一直走 catch，调用 <code>setTimeout()</code> 方法，该方法用于在指定的毫秒数后调用函数或计算表达式，注意上面，是将 debugger 传递给了构造方法 constructor，所以这里我们有两种方法过掉 debugger，Hook 掉 constructor 或 setTimeout 都可以。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c311099f5c0b77192424c42d937d90c4.png#pic_center" alt="02.png"></p>
<pre><code class="javascript">// 两种 Hook 任选一中
// Hook 构造方法
Function.prototype.constructor_ = Function.prototype.constructor;
Function.prototype.constructor = function (a) &#123;
    if(a == &quot;debugger&quot;) &#123;
        return function ()&#123;&#125;;
    &#125;
    return Function.prototype.constructor_(a);
&#125;;

// Hook setTimeout
var setTimeout_ = setTimeout
var setTimeout = function (func, time)&#123;
    if (func == txsdefwsw)&#123;
        return function () &#123;&#125;;
    &#125;
    return setTimeout_(func, time)
&#125;
</code></pre>
<p>然后就来到了第二个无限 debugger，同样跟栈，发现有个 setInterval 定时器和构造方法 constructor，类似的，我们 Hook 掉 constructor 或 setInterval 都可以。注意：定时器这里还检测了窗口高宽，即便是你过了 constructor 或 setInterval，如果不把开发者工具单独拿出来也是不行的，会不断输出“检测到非法调试”。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/24fb1072abd88b44ce7e6a836e56af97.png#pic_center" alt="03.png"></p>
<pre><code class="javascript">// Hook setInterval
var setInterval_ = setInterval
setInterval = function (func, time)&#123;
    if (time == 2000) &#123;
        return function () &#123;&#125;;
    &#125;
    return setInterval_(func, time)
&#125;
</code></pre>
<p>我们观察到，其实这两个无限 debugger 都可以 Hook 构造方法来过掉，所以直接 Fiddler 注入该 Hook 构造方法的代码即可：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/57c491d6b2a5f28110ba422d34355cc9.png#pic_center" alt="04.png"></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>在我们遇到第二个无限 debugger 的时候，还可以直接跟栈到一个 city_realtime.php 的页面，里面有两个 eval 语句，执行第一个 eval 里面的语句你就会发现正是前面我们在 VM 虚拟机里面看到的 debugger 代码，所以这里理论上可以直接替换掉这个页面，去掉 eval 语句，就不会有无限 debugger 了，但是K哥先告诉你，现在不行了，因为里面有加载了某个 JS，这个 JS 在后面加密解密中会用到，但是这个 JS 是动态的，每10分钟就会改变，我们后面还要通过此页面来获取动态的 JS，所以是不能替换的！这里只是提一下这个思路！</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/db958514d4e4bc98ffa605cf626ca23a.png#pic_center" alt="05.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/282ada73849ebb74039a98732edaf72e.png#pic_center" alt="06.png"></p>
<h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h3><p>当然，这里还有一种最简单的方法，直接右键选择 Never pause here，永不在此处断下即可，同样还需要把开发者工具窗口单独拿出来，不然会一直输出“检测到非法调试”。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f5922a0ad3c48adc030e368bf8542b8a.png#pic_center" alt="07.png"></p>
<h2 id="抓包分析"><a href="#抓包分析" class="headerlink" title="抓包分析"></a>抓包分析</h2><p>我们在实时监控页面，顺便点击查询一个城市，可以看到请求的 Form Data 和返回的数据都是加密的，如下图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6f1b1872723348480a25b3862201622e.png#pic_center" alt="08.png"></p>
<h2 id="加密入口"><a href="#加密入口" class="headerlink" title="加密入口"></a>加密入口</h2><p>由于是 XHR，所以我们直接跟栈，很容易找到加密的位置：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ed3d2b8414cdb6f2d434d2534939e379.png#pic_center" alt="09.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/53044ab14dbfdb75bd21657060d6bbd8.png#pic_center" alt="10.png"></p>
<p>可以看到传递的 data 键值对：<code>&#123;hXM8NDFHN: p7crXYR&#125;</code>，键在这个 JS 里是写死的，值是通过一个方法 <code>pU14VhqrofroULds()</code> 得到的，这个方法需要传递两个参数，第一个是定值 GETDATA，第二个就是城市名称，我们再跟进看看这个方法是啥：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6145ba480135887e42bda4f0f471d3f9.png#pic_center" alt="11.png"></p>
<p>一些 appId、时间戳、城市等参数，做了一些 MD5、base64 的操作，返回的 param 就是我们要的值了。看起来不难，我们再找找返回的加密数据是如何解密的，我们注意到 ajax 请求有个 success 关键字，我们即便是不懂 JS 逻辑，也可以猜到应该是请求成功后的处理操作吧，如下图所示：传进来的 dzJMI 就是返回的加密的数据，经过 <code>db0HpCYIy97HkHS7RkhUn()</code> 方法后，就解密成功了：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6f5527d38878bcabda88878591aafb3a.png#pic_center" alt="12.png"></p>
<p>跟进 <code>db0HpCYIy97HkHS7RkhUn()</code> 方法，可以看到是 AES+DES+BASE64 解密，传入的密钥 key 和偏移量 iv 都在头部有定义：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b77e427fed50ef80002d0144fb478741.png#pic_center" alt="13.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/960e2ebfe395fbb139442d10e5f16f43.png#pic_center" alt="14.png"></p>
<h2 id="动态-JS"><a href="#动态-JS" class="headerlink" title="动态 JS"></a>动态 JS</h2><p>经过以上分析后，我们加密解密的逻辑都搞定了，但是你多调试一下就会发现，这一个加密解密的 JS 是动态变化的，定义的密钥 key 和偏移量 iv 都是隔段时间就会改变的，如果你在这段代码里下断点，停留时间过长，突然发现断点失效无法断下了，那就是 JS 变了，当前代码已经失效了。</p>
<p>我们随便薅两个不同的 JS 下来（提示：JS 每隔10分钟会变化，后文有详细分析），利用 PyCharm 的文件对比功能（依次选择 View - Compare With）可以总结出以下几个变化的地方（变量名的变化不算）：</p>
<ol>
<li>开头的8个参数的值：两个 aes key 和 iv，两个 des key 和 iv；</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4f48281ff87143bc23a094cf634802d8.png#pic_center" alt="15.png"></p>
<ol start="2">
<li>生成加密的 param 时，appId 是变化的，最后的加密分为 AES、DES 和没有加密，三种情况（这里是最容易忽略的地方，这里没有注意到，请求可能会提示 appId 无效的情况）：</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/762fa747135504fbde73fa6b3986d869.png#pic_center" alt="16.png"></p>
<ol start="3">
<li>最后发送请求时，data 键值对，其中的键也是变化的：</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/67ee28a04033aa503d8e41be6fcf3dbd.png#pic_center" alt="17.png"></p>
<p>变化的地方我们找到了，那我们怎么获取这个 JS 呢？因为这个 JS 的在 VM 虚拟机里，所以我们还要找到它的源头，是从哪里来的，我们抓包可以看到一个比较特殊的 JS，类似于 encrypt_xxxxxx.js，看这取名就知道不简单，返回的是一段 eval 包裹的代码：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a2f3687fe4ee1aad5c7ca1331bf65a68.png#pic_center" alt="18.png"></p>
<p>对于 eval 我们已经很熟悉了，直接去掉 eval，让他执行一下，就可以看到正是我们需要的那段 JS：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ab32b5eff66ba4cf024ce79109bea03a.png#pic_center" alt="19.png"></p>
<p>这里有个小细节，如果你使用控制台，会发现它一直在打印 img 标签，影响我们的输入，这里可以直接跟进去下断点暂时阻止他运行就行了，不需要做其他操作浪费时间：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/54b72f44ae13b7eed13f0f4f6e0e3091.png#pic_center" alt="20.png"></p>
<p>你以为到这里就差不多搞定了？错了，同样的这个 encrypt_xxxxxx.js 也藏有玄机：</p>
<ol>
<li>encrypt_xxxxxx.js 的名称是动态的，后面的 v 值是秒级时间戳，隔600秒，也就是十分钟就会改变，这个 JS 可以在 city_realtime.php 页面找到，还记得我们前面说过的绕过无限 debugger 不能替换此页面吗？我们要通过此页面来获取动态的 JS，所以是不能替换的！</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/73f20c39d6bc6e0cc6ed54815cad99fa.png#pic_center" alt="21.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fc3eeffb3bf092330e03cefaf34363e6.png#pic_center" alt="22.png"></p>
<ol start="2">
<li>encrypt_xxxxxx.js 返回的 JS，并不是所有的执行一遍 eval 就能得到明文代码了，它是 eval 和 base64 相结合的，第一遍都是 eval，但是后面就说不定了，有可能直接出结果，有可能需要 base64，有可能 base64 两遍，有可能两遍 base64 之后还要再 eval，总之，除了第一遍是 eval 以外，后面是否需要 base64 和 eval，以及需要的次数和先后顺序，都是不确定的！举几个例子：</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5f2297cf7a0481ae3399b5c2a8fa81c0.png#pic_center" alt="23.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b2217260728ded9a44be53524f23ad2b.png#pic_center" alt="24.png"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9fa531eb305cba680b129ca22d910298.png#pic_center" alt="25.png"></p>
<p>这里可能有人会问，你怎么看出来那是 base64 呢？很简单，直接在网站页面的控制台里输入 <code>dswejwehxt</code>，点击去看这个函数，就是 base64：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5a0ee651bf758051472d212c7f0a5b07.png#pic_center" alt="26.png"></p>
<p>那么针对 encrypt_xxxxxx.js 内容不确定的情况，我们可以写一个方法，获取到 encrypt_xxxxxx.js 后，需要执行 eval 就执行 eval，需要执行 base64 就执行 base64，直到没有 eval 和 base64 即可，可以分别用字符串 <code>eval(function</code> 和 <code>dswejwehxt(</code> 来判断是否需要 eval 和 base64（当然也有其他方式，比如 <code>()</code> 的个数等），示例代码如下所示：</p>
<pre><code class="python">def get_decrypted_js(encrypted_js_url):
    &quot;&quot;&quot;
    :param encrypted_js_url: encrypt_xxxxxx.js 的地址
    :return: 解密后的 JS
    &quot;&quot;&quot;
    decrypted_js = requests.get(url=encrypted_js_url, headers=headers).text
    flag = True
    while flag:
        if &quot;eval(function&quot; in decrypted_js:
            # 需要执行 eval
            print(&quot;需要执行 eval！&quot;)
            replace_js = decrypted_js.replace(&quot;eval(function&quot;, &quot;(function&quot;)
            decrypted_js = execjs.eval(replace_js)
        elif &quot;dswejwehxt(&quot; in decrypted_js:
            # 需要 base64 解码
            base64_num = decrypted_js.count(&quot;dswejwehxt(&quot;)
            print(&quot;需要 %s 次 base64 解码！&quot; % base64_num)
            decrypted_js = re.findall(r&quot;\(&#39;(.*?)&#39;\)&quot;, decrypted_js)[0]
            num = 0
            while base64_num &gt; num:
                decrypted_js = base64.b64decode(decrypted_js).decode()
                num += 1
        else:
            # 得到明文
            flag = False
    # print(decrypted_js)
    return decrypted_js
</code></pre>
<h2 id="本地改写"><a href="#本地改写" class="headerlink" title="本地改写"></a>本地改写</h2><p>通过以上函数我们就拿到了动态的 JS 了，那么我们可以直接执行拿回来的 JS 吗？当然是不可以的，你可以自己本地执行一下，可以发现里面的 CryptoJS、Base64、hex_md5 都需要补齐才行，所以到这里我们就有两种做法：</p>
<ol>
<li>拿到解密后的动态 JS 后，动态 JS 和我们自己写的 Base64、hex_md5 等方法组成新的 JS 代码，执行新的 JS 代码拿到参数，这里还需要注意因为里面的其他方法名都是动态的，所以你还得想办法匹配到正确的方法名来调用才行，所以这种方法个人感觉还是稍微有点儿麻烦的；</li>
<li>我们本地自己写一个 JS，拿到解密后的动态 JS 后，把里面的 key、iv、appId、data 键名、param 是否需要 AES 或 DES 加密，这些信息都匹配出来，然后传给我们自己写的 JS，调用我们自己的方法拿到加密结果。</li>
</ol>
<p>虽然两种方法都很麻烦，但K哥暂时也想不到更好的解决方法了，有比较好的想法的朋友可以留言说一说。</p>
<p>以第二种方法为例，我们本地的 JS 示例（main.js）：</p>
<pre><code class="javascript">var CryptoJS = require(&quot;crypto-js&quot;);

var BASE64 = &#123;
    encrypt: function (text) &#123;
        return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse(text))
    &#125;,
    decrypt: function (text) &#123;
        return CryptoJS.enc.Base64.parse(text).toString(CryptoJS.enc.Utf8)
    &#125;
&#125;;

var DES = &#123;
    encrypt: function (text, key, iv) &#123;
        var secretkey = (CryptoJS.MD5(key).toString()).substr(0, 16);
        var secretiv = (CryptoJS.MD5(iv).toString()).substr(24, 8);
        secretkey = CryptoJS.enc.Utf8.parse(secretkey);
        secretiv = CryptoJS.enc.Utf8.parse(secretiv);
        var result = CryptoJS.DES.encrypt(text, secretkey, &#123;
            iv: secretiv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        &#125;);
        return result.toString();
    &#125;,
    decrypt: function (text, key, iv) &#123;
        var secretkey = (CryptoJS.MD5(key).toString()).substr(0, 16);
        var secretiv = (CryptoJS.MD5(iv).toString()).substr(24, 8);
        secretkey = CryptoJS.enc.Utf8.parse(secretkey);
        secretiv = CryptoJS.enc.Utf8.parse(secretiv);
        var result = CryptoJS.DES.decrypt(text, secretkey, &#123;
            iv: secretiv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        &#125;);
        return result.toString(CryptoJS.enc.Utf8);
    &#125;
&#125;;

var AES = &#123;
    encrypt: function (text, key, iv) &#123;
        var secretkey = (CryptoJS.MD5(key).toString()).substr(16, 16);
        var secretiv = (CryptoJS.MD5(iv).toString()).substr(0, 16);
        secretkey = CryptoJS.enc.Utf8.parse(secretkey);
        secretiv = CryptoJS.enc.Utf8.parse(secretiv);
        var result = CryptoJS.AES.encrypt(text, secretkey, &#123;
            iv: secretiv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        &#125;);
        return result.toString();
    &#125;,
    decrypt: function (text, key, iv) &#123;
        var secretkey = (CryptoJS.MD5(key).toString()).substr(16, 16);
        var secretiv = (CryptoJS.MD5(iv).toString()).substr(0, 16);
        secretkey = CryptoJS.enc.Utf8.parse(secretkey);
        secretiv = CryptoJS.enc.Utf8.parse(secretiv);
        var result = CryptoJS.AES.decrypt(text, secretkey, &#123;
            iv: secretiv,
            mode: CryptoJS.mode.CBC,
            padding: CryptoJS.pad.Pkcs7
        &#125;);
        return result.toString(CryptoJS.enc.Utf8);
    &#125;
&#125;;

function getDecryptedData(data, AES_KEY_1, AES_IV_1, DES_KEY_1, DES_IV_1) &#123;
    data = AES.decrypt(data, AES_KEY_1, AES_IV_1);
    data = DES.decrypt(data, DES_KEY_1, DES_IV_1);
    data = BASE64.decrypt(data);
    return data;
&#125;

function ObjectSort(obj) &#123;
    var newObject = &#123;&#125;;
    Object.keys(obj).sort().map(function (key) &#123;
        newObject[key] = obj[key];
    &#125;);
    return newObject;
&#125;

function getRequestParam(method, obj, appId) &#123;
    var clienttype = &#39;WEB&#39;;
    var timestamp = new Date().getTime()
    var param = &#123;
        appId: appId,
        method: method,
        timestamp: timestamp,
        clienttype: clienttype,
        object: obj,
        secret: CryptoJS.MD5(appId + method + timestamp + clienttype + JSON.stringify(ObjectSort(obj))).toString()
    &#125;;
    param = BASE64.encrypt(JSON.stringify(param));
    return param;
&#125;

function getRequestAESParam(requestMethod, requestCity, appId, AES_KEY_2, AES_IV_2)&#123;
    var param = getRequestParam(requestMethod, requestCity, appId);
    return AES.encrypt(param, AES_KEY_2, AES_IV_2);
&#125;

function getRequestDESParam(requestMethod, requestCity, appId, DES_KEY_2, DES_IV_2)&#123;
    var param = getRequestParam(requestMethod, requestCity, appId);
    return DES.encrypt(param, DES_KEY_2, DES_IV_2);
&#125;
</code></pre>
<p>我们匹配 JS 里面的各项参数的 Python 代码示例（匹配8个 key、iv 值、appId 和 param 的加密方式）：</p>
<pre><code class="python">def get_key_iv_appid(decrypted_js):
    &quot;&quot;&quot;
    :param decrypted_js: 解密后的 encrypt_xxxxxx.js
    :return: 请求必须的一些参数
    &quot;&quot;&quot;
    key_iv = re.findall(r&#39;const.*?&quot;(.*?)&quot;;&#39;, decrypted_js)
    app_id = re.findall(r&quot;var appId.*?&#39;(.*?)&#39;;&quot;, decrypted_js)
    request_data_name = re.findall(r&quot;aqistudyapi.php.*?data.*?&#123;(.*?):&quot;, decrypted_js, re.DOTALL)

    # 判断 param 是 AES 加密还是 DES 加密还是没有加密
    if &quot;AES.encrypt(param&quot; in decrypted_js:
        request_param_encrypt = &quot;AES&quot;
    elif &quot;DES.encrypt(param&quot; in decrypted_js:
        request_param_encrypt = &quot;DES&quot;
    else:
        request_param_encrypt = &quot;NO&quot;

    key_iv_appid = &#123;
        # key 和 iv 的位置和原来 js 里的是一样的
        &quot;aes_key_1&quot;: key_iv[0],
        &quot;aes_iv_1&quot;: key_iv[1],
        &quot;aes_key_2&quot;: key_iv[2],
        &quot;aes_iv_2&quot;: key_iv[3],
        &quot;des_key_1&quot;: key_iv[4],
        &quot;des_iv_1&quot;: key_iv[5],
        &quot;des_key_2&quot;: key_iv[6],
        &quot;des_iv_2&quot;: key_iv[7],
        &quot;app_id&quot;: app_id[0],
        # 发送请求的 data 的键名
        &quot;request_data_name&quot;: request_data_name[0].strip(),
        # 发送请求的 data 值需要哪种加密
        &quot;request_param_encrypt&quot;: request_param_encrypt
    &#125;
    # print(key_iv_appid)
    return key_iv_appid
</code></pre>
<p>我们发送请求以及解密返回值的 Python 代码示例（以北京为例）：</p>
<pre><code class="python">def get_data(key_iv_appid):
    &quot;&quot;&quot;
    :param key_iv_appid: get_key_iv_appid() 方法返回的值
    &quot;&quot;&quot;
    request_method = &quot;GETDATA&quot;
    request_city = &#123;&quot;city&quot;: &quot;北京&quot;&#125;
    with open(&#39;main.js&#39;, &#39;r&#39;, encoding=&#39;utf-8&#39;) as f:
        execjs_ = execjs.compile(f.read())

    # 根据不同加密方式调用不同方法获取请求加密的 param 参数
    request_param_encrypt = key_iv_appid[&quot;request_param_encrypt&quot;]
    if request_param_encrypt == &quot;AES&quot;:
        param = execjs_.call(
            &#39;getRequestAESParam&#39;, request_method, request_city,
            key_iv_appid[&quot;app_id&quot;], key_iv_appid[&quot;aes_key_2&quot;], key_iv_appid[&quot;aes_iv_2&quot;]
        )
    elif request_param_encrypt == &quot;DES&quot;:
        param = execjs_.call(
            &#39;getRequestDESParam&#39;, request_method, request_city,
            key_iv_appid[&quot;app_id&quot;], key_iv_appid[&quot;des_key_2&quot;], key_iv_appid[&quot;des_iv_2&quot;]
        )
    else:
        param = execjs_.call(&#39;getRequestParam&#39;, request_method, request_city, key_iv_appid[&quot;app_id&quot;])
    data = &#123;
        key_iv_appid[&quot;request_data_name&quot;]: param
    &#125;
    response = requests.post(url=aqistudy_api, headers=headers, data=data).text
    # print(response)

    # 对获取的加密数据解密
    decrypted_data = execjs_.call(
        &#39;getDecryptedData&#39;, response,
        key_iv_appid[&quot;aes_key_1&quot;], key_iv_appid[&quot;aes_iv_1&quot;],
        key_iv_appid[&quot;des_key_1&quot;], key_iv_appid[&quot;des_iv_1&quot;]
    )
    print(json.loads(decrypted_data))
</code></pre>
<p>运行结果，成功请求并解密返回值：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f6243a66a4ddcf72bb77b28bb94bc49d.png#pic_center" alt="27.png"></p>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 8px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p>
                        <strong>本文链接：</strong><a href="https://www.itbob.cn/article/044/">https://www.itbob.cn/article/044/</a>
                        <br>
                        <strong>
                             
                                本站所有原创文章采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 许可协议进行许可！
                            
                        </strong>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script>
    var gitalk = new Gitalk({
            clientID: 'd19a84b9d9a2ddb2c6b9',
            clientSecret: 'cec9feae5129a6106edc68ce06d167be8eb06021',
            repo: 'trhx.github.io',
            owner: 'TRHX',
            admin: ['TRHX'],
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/article/043/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/article/042/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/BOB.png" alt="BOB's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        YWRtaW5AaXRib2IuY24=
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: admin@itrhx.com" target="_blank" title="邮件联系我">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        邮件联系我
                    </a>
                </li>
            
                <li>
                    <a href="https://itrhx.blog.csdn.net/" target="_blank" title="关注 CSDN">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">donut_small</i>
                        
                        关注 CSDN
                    </a>
                </li>
            
                <li>
                    <a href="https://github.com/TRHX" target="_blank" title="关注 GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">code</i>
                        
                        关注 GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2022/05/">五月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/04/">四月 2022<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/03/">三月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/02/">二月 2022<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/01/">一月 2022<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/11/">十一月 2021<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/10/">十月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/03/">三月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/06/">六月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Hexo/">Hexo<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/JS-%E9%80%86%E5%90%91/">JS 逆向<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/categories/Python/">Python<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析<span class="sidebar_archives-count">27</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%88%AC%E8%99%AB/">爬虫<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%AE%97%E6%B3%95/">算法<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags/" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">local_offer</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline/" title="时光机">
                
                    <i class="material-icons sidebar-material-icons">send</i>
                
                时光机
            </a>
        </li>
        
    
        <li>
            <a href="/friends/" title="友人帐">
                
                    <i class="material-icons sidebar-material-icons">group_add</i>
                
                友人帐
            </a>
        </li>
        
    
        <li>
            <a href="/comments/" title="关于我 &amp; 留言板">
                
                    <i class="material-icons sidebar-material-icons">chat</i>
                
                关于我 &amp; 留言板
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives/">
                文章总数
                <span class="sidebar-badge">52</span>
            </a>
        </li>
        
    

    <!-- Article Wordcount  -->
    
        <li>
            <a href="">
                字数统计
                <span class="sidebar-badge">257.5k</span>
            </a>
        </li>
        
            <li class="divider"></li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- QQ Group -->

    <a href="https://jq.qq.com/?_wv=1027&k=MwSEZmIi" alt="爬虫逆向交流群" title="群号：941013658" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            爬虫逆向交流群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>
    <a href="https://jq.qq.com/?_wv=1027&k=Ag6AZkYC" alt="Hexo 博客交流一群" title="群号：924812033" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Hexo 博客交流一群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>
    <a href="https://jq.qq.com/?_wv=1027&k=ymhpQ0jb" alt="Hexo 博客交流二群" title="群号：735861501" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Hexo 博客交流二群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Github -->
    
        <a href="https://github.com/TRHX" target="_blank" title="Github">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- CSDN -->
    
        <a href="https://itrhx.blog.csdn.net/" target="_blank" title="CSDN">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-csdn">
                <span class="visuallyhidden">CSDN</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/itrhx" target="_blank" title="Zhihu">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
        --></a>
    

    <!-- Email -->
    
        <a href="mailto:admin@itbob.cn" target="_blank" title="Email">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-envelope">
                <span class="visuallyhidden">Email</span>
            </button><!--
     --></a>
    

    <!-- QQ -->
    
        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2273902448&amp;site=qq&amp;menu=yes" target="_blank" title="QQ">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-qq">
                <span class="visuallyhidden">QQ</span>
            </button><!--
        --></a>
    

    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- LinkedIn -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


            <!--Copyright-->
            <div id="copyright">

                
                    <div class="itbob-footer-text">
                        
                                    <img src="/img/icp.png" alt="ICP" style="width:18px; height:18px; margin-bottom:5px"> <a href="https://beian.miit.gov.cn/" target="_blank">鄂ICP备19003281号-6</a>丨 <img src="/img/moeicp.png" alt="MOE ICP" style="width:16px; height:16px; margin-bottom:5px"> <a href="https://icp.gov.moe/" target="_blank">萌ICP备20202022号</a>丨 <a href="https://cloud.tencent.com/" target="_blank"> <img src="/img/tencent_cloud.svg" style="height:17px; margin-bottom:5px"></a>
                                        
                    </div>
                    

                        Copyright&nbsp;©&nbsp;<span year></span>&nbsp;ITBOB丨

                        <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
                        <script>
                            var now = new Date();

                            function createtime() {
                                var grt = new Date("08/10/2018 17:38:00"); //在此处修改你的建站时间，格式：月/日/年 时:分:秒
                                now.setTime(now.getTime() + 250);
                                days = (now - grt) / 1000 / 60 / 60 / 24;
                                dnum = Math.floor(days);
                                hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
                                hnum = Math.floor(hours);
                                if (String(hnum).length == 1) {
                                    hnum = "0" + hnum;
                                }
                                minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
                                mnum = Math.floor(minutes);
                                if (String(mnum).length == 1) {
                                    mnum = "0" + mnum;
                                }
                                seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
                                snum = Math.round(seconds);
                                if (String(snum).length == 1) {
                                    snum = "0" + snum;
                                }
                                document.getElementById("timeDate").innerHTML = "本站已运行了 " + dnum + " 天 ";
                                document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
                            }
                            setInterval("createtime()", 250);
                        </script>


            </div>

            <!-- All Site UV -->
            <!-- 
        <br />
        <span id="busuanzi_container_site_uv">本站访客数
            <span id="busuanzi_value_site_uv">
            </span>
        </span>|
        <span id="busuanzi_container_site_pv">本站总访问量
            <span id="busuanzi_value_site_pv">
                
            </span>
        </span>|
        <i class="material-icons">keyboard</i>站点总字数<span class="post-count">257.5k</span>
        
        </div> -->
            <!-- Paradox Footer Right Section -->

            <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

            <!-- <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div> -->

            <div class="mdl-mini-footer--right-section">
                <div>
                    <div class="itbob-github-badge">
                        <span class="badge-subject">PV</span>
                        <span class="badge-value bg-brightgreen" id="busuanzi_value_site_pv"></span>
                    </div>
                    <div class="itbob-github-badge">
                        <span class="badge-subject">Powered</span>
                        <span class="badge-value bg-blue">Hexo</span>
                    </div>
                </div>
                <div>
                    <div class="itbob-github-badge">
                        <span class="badge-subject">UV</span>
                        <span class="badge-value bg-firebrick" id="busuanzi_value_site_uv"></span>
                    </div>
                    <div class="itbob-github-badge">
                        <span class="badge-subject">Theme</span>
                        <span class="badge-value bg-orange">Material</span>
                    </div>
                </div>
            </div>
            
</footer>

                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="/js/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- Browser Check -->
<script>
	var agent = navigator.userAgent.toLowerCase();
    // UC
	if(agent.indexOf('ucbrowser') > -1 || agent.indexOf('ubrowser') > -1) {
        /* document.write('
<link rel="stylesheet" href="/css/uc.css">
'); */
        alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n\n为了您能更好的浏览，强烈推荐使用 Chrome 或 Firefox 浏览器！\n\n继续浏览极有可能会出现一些样式问题！');
	}
    // IE
    if (agent.indexOf("compatible") > -1 && agent.indexOf("MSIE") > -1) {
        alert('由于 IE 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n\n为了您能更好的浏览，强烈推荐使用 Chrome 或 Firefox 浏览器！\n\n继续浏览极有可能会出现一些样式问题！');
    };
    // IE 11
    if (agent.indexOf('Trident') > -1 && agent.indexOf("rv:11.0") > -1) {
        alert('由于 IE 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n\n为了您能更好的浏览，强烈推荐使用 Chrome 或 Firefox 浏览器！\n\n继续浏览极有可能会出现一些样式问题！');
    }
</script>

<!-- Blog Title JS -->

    
            <script>lsloader.load("binft","/js/binft.js?eZhLXqFFh9+v03Tp9mCu6g==", true)</script>
    


<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2018;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log("\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n", "color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;", "color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;");
console.log("\n %c © ITBOB'S BLOG %c https://www.itbob.cn \n\n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;");
console.log("\n %c © ITRHX'S BLOG %c https://www.itrhx.com \n\n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;");
</script>

                </main>
            </div>
        </body>
    
</html>
