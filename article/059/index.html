<!-- 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
-->

<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Force https -->

    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">


<!-- Title -->
<title>极验行为验证，二代滑块验证码逆向分析 - BOB&#39;S BLOG</title>

<!-- Icon -->
<link rel="icon" href="/img/favicon.ico">

<!-- Fonts -->
<link rel="preload" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" as="style" onload="this.onload=null, this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="//fonts.googleapis.com/css2?family=Roboto+Mono:ital@0;1&family=Open+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"></noscript>

<!-- Font Awesome -->
<!-- https://fontawesome.dashgame.com/ -->
<!-- <link rel="stylesheet" href="https://cdn.itbob.cn/css/font-awesome@5.6.3/all.min.css"> -->
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/5.15.4/css/all.min.css">
<!-- <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css"> -->


    <!-- KaTeX -->
    <!-- //cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css -->
    <link rel="preload" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css" as="style" onload="this.onload=null, this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="//cdn.itbob.cn/css/katex@0.12.0/katex.min.css"></noscript>


<!-- Style -->

<link rel="stylesheet" href="/styles/main.css">

<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-pure@1.0.1/dist/main.css"> -->

<!-- Analytics -->

    
    
        <!-- Baidu Analytics -->
        <script defer>
            var _hmt = _hmt || [];
            (function () {
                var hm = document.createElement('script');
                hm.src = 'https://hm.baidu.com/hm.js?6ca34ddce088f8434f3c7509576819f2';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    


<!-- Busuanzi -->
<!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->
<script async src="//cdn.itbob.cn/js/busuanzi@2.3/busuanzi.pure.mini.js"></script>

<!-- Typeit -->
<!-- https://www.typeitjs.com/ -->
<script src="//unpkg.com/typeit@8.7.0/dist/index.umd.js"></script>

<!-- Fancybox -->

    <link rel="stylesheet" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css">
    <script src="//cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"> </script>
    <script src="//cdn.itbob.cn/js/fancybox@3.5.7/fancybox.js"> </script>

<!-- <script>
  $('[data-fancybox="images"]').fancybox({//可选
    thumbs : {
      autoStart : true //缩略图
    }
  });
  $('[data-fancybox]').fancybox({//启用函数，必须
    protect: true //图片右键不能下载，可选
  });
</script> -->

<!-- Console -->
<script>
    function makeMulti (string) {
        let l = new String(string)
        l = l.substring(l.indexOf("/*") + 3, l.lastIndexOf("*/"))
        return l
    }
    let string = function () {
      /* 
          _____                   _______                   _____          
          /\    \                 /::\    \                 /\    \         
         /::\    \               /::::\    \               /::\    \        
        /::::\    \             /::::::\    \             /::::\    \       
       /::::::\    \           /::::::::\    \           /::::::\    \      
      /:::/\:::\    \         /:::/~~\:::\    \         /:::/\:::\    \     
     /:::/__\:::\    \       /:::/    \:::\    \       /:::/__\:::\    \    
    /::::\   \:::\    \     /:::/    / \:::\    \     /::::\   \:::\    \   
   /::::::\   \:::\    \   /:::/____/   \:::\____\   /::::::\   \:::\    \  
  /:::/\:::\   \:::\ ___\ |:::|    |     |:::|    | /:::/\:::\   \:::\ ___\ 
 /:::/__\:::\   \:::|    ||:::|____|     |:::|    |/:::/__\:::\   \:::|    |
 \:::\   \:::\  /:::|____| \:::\    \   /:::/    / \:::\   \:::\  /:::|____|
  \:::\   \:::\/:::/    /   \:::\    \ /:::/    /   \:::\   \:::\/:::/    / 
   \:::\   \::::::/    /     \:::\    /:::/    /     \:::\   \::::::/    /  
    \:::\   \::::/    /       \:::\__/:::/    /       \:::\   \::::/    /   
     \:::\  /:::/    /         \::::::::/    /         \:::\  /:::/    /    
      \:::\/:::/    /           \::::::/    /           \:::\/:::/    /     
       \::::::/    /             \::::/    /             \::::::/    /      
        \::::/    /               \::/____/               \::::/    /       
         \::/____/                 ~~                      \::/____/        
          ~~                                                ~~              
                                                                            
                                WWW.ITBOB.CN
                                
                        有毛的叫程序猿，沒毛的叫程序员。
      */
    }
    console.log(makeMulti(string));
    console.log("\n %c © ITBOB'S BLOG %c https://www.itbob.cn %c © ITRHX'S BLOG %c https://www.itrhx.com \n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;")
</script>

    <meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="BOB'S BLOG" type="application/atom+xml">
</head>
    <body>
        <div class="main gt-bg-theme-color-first">
            <div class="main-content">
                <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="/">
        <img class="user-avatar" src="/img/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first" id="typeitspan">
            <!-- BOB&#39;S BLOG -->
        </div>
    </a>
    <!-- <span id="typeitspan"></span> -->
    <script>
        new TypeIt('#typeitspan', {
        strings: "BOB'S BLOG",
        speed: 150, 
        afterComplete: function (instance) {
            instance.destroy();
        }
        }).go();
    </script>
    <button aria-label="Navbar Toggler" class="navbar-toggler" type="button" id="changeNavbar">
        <i class="gt-c-content-color-first" style="font-size: 18px;">
            <svg xmlns="https://www.w3.org/2000/svg" viewBox="0 0 448 512" height="18px" fill="currentColor">
                <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" />
            </svg>
        </i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center; ">
            
                
                    <div class="nav-item">
                        <a href="/" class="menu gt-a-link" target="_self">首页</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/archives/" class="menu gt-a-link" target="_self">归档</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/tags/" class="menu gt-a-link" target="_self">标签</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/friends/" class="menu gt-a-link" target="_self">友链</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="/about/" class="menu gt-a-link" target="_self">关于</a>
                    </div>
                
            
                
                    <div class="nav-item">
                        <a href="https://www.travellings.cn/go.html" target="_blank">
                            <img src="https://cdn.itbob.cn/img/travelling.gif" class="nofancybox" alt="开往-友链接力" width="auto" height="25px">
                        </a>
                    </div>
                
            
        </div>
    </div>
</nav>

<script>
    /* 移动端导航栏展开/收起切换 */
    document.getElementById('changeNavbar').onclick = function() {
        let element = document.getElementById('navbarSupportedContent');
        if (element.style.display === 'none' || element.style.display === '') {
            element.style.display = 'block';
        } else { 
            element.style.display = 'none';
        }
    }
</script>

                <div class="post-container">
    <div class="post-detail gt-bg-theme-color-second gt-c-content-color-first">
        <article class="gt-post-content">
            <h1 class="post-title">极验行为验证，二代滑块验证码逆向分析</h1>
            <div class="post-info">
                <time class="post-time gt-c-content-color-first">
                    <i class="fa fa-calendar-alt"></i> 首发于: 2022-12-18丨
                </time>
                <span id="busuanzi_container_page_pv">
                    <i class="fas fa-eye"></i> 阅读量: <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>丨
                </span>
                
                    <span class="post-count">
                        <i class="fa fa-keyboard"></i> 字数统计: 2.3k丨
                    </span>
                    <span class="post-count">
                        <i class="fa fa-hourglass-half"></i> 阅读时长: 10分丨
                    </span>
                
                
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/%E7%88%AC%E8%99%AB/" class="post-tag">
                            爬虫</a>
                    
                        <!-- <i class="fa fa-tag"></i> -->
                        <i class="fas fa-hashtag"></i>
                        <a href="/tags/%E9%AA%8C%E8%AF%81%E7%A0%81%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98/" class="post-tag">
                            验证码逆向实战</a>
                    
                
            </div>
            <hr>
            <div class="post-content gt-c-content-color-first">
                <p><img src="https://cdn.itbob.cn/img/cover/captcha_reverse.png" alt="captcha_reverse"></p>
<p><strong><center><font color="red" size="5px" weight="bolder">欢迎加入爬虫逆向微信交流群：添加微信 IT-BOB（备注交流群）</font></center></strong></p>
<h2><span id="wen-zhang-mu-lu">文章目录</span></h2>
<hr>
<!-- toc -->
<ul>
<li><a href="#sheng-ming">声明</a></li>
<li><a href="#ni-xiang-mu-biao">逆向目标</a></li>
<li><a href="#zhua-bao-qing-kuang">抓包情况</a></li>
<li><a href="#ni-xiang-fen-xi">逆向分析</a>
<ul>
<li><a href="#huo-qu-h7z-zhi">获取 H7z 值</a></li>
<li><a href="#huo-qu-r7z-zhi">获取 r7z 值</a>
<ul>
<li><a href="#huo-qu-userresponse-zhi">获取 userresponse 值</a></li>
<li><a href="#huo-qu-passtime-zhi">获取 passtime  值</a></li>
<li><a href="#huo-qu-imgload-zhi">获取 imgload 值</a></li>
<li><a href="#huo-qu-aa-zhi">获取 aa 值</a></li>
<li><a href="#huo-qu-ep-zhi">获取 ep 值</a></li>
<li><a href="#huo-qu-rp-zhi">获取 rp 值</a></li>
</ul>
</li>
<li><a href="#huo-qu-w-zhi">获取 w 值</a></li>
</ul>
</li>
<li><a href="#jie-guo-yan-zheng">结果验证</a></li>
</ul>
<!-- tocstop -->
<hr>
<h2><span id="sheng-ming">声明</span></h2>
<p><strong><font color="red">本文章中所有内容仅供学习交流使用，不用于其他任何目的，不提供完整代码，抓包内容、敏感网址、数据接口等均已做脱敏处理，严禁用于商业用途和非法用途，否则由此产生的一切后果均与作者无关！</font></strong></p>
<p><strong><font color="red">本文章未经许可禁止转载，禁止任何修改后二次传播，擅自使用本文讲解的技术而导致的任何意外，作者均不负责，若有侵权，请通过邮件 <a href="mailto:admin@itbob.cn">admin@itbob.cn</a> 联系我立即删除！</font></strong></p>
<h2><span id="ni-xiang-mu-biao">逆向目标</span></h2>
<ul>
<li>目标：某验二代滑块验证码逆向分析</li>
<li>主页：<code>aHR0cDovL3d3dy5qc2dzai5nb3YuY246NTg4ODgvbWluaS9uZXR3ZWIvU01MaWJyYXJ5LmpzcA==</code></li>
<li>说明：大多数逻辑其实和三四代都一样，相同的就简写了，有疑惑的地方可以看以前的文章</li>
<li><a href="https://www.itbob.cn/article/060/">某验行为验证，三代滑块验证码逆向分析</a></li>
<li><a href="https://www.itbob.cn/article/061/">某验行为验证，四代滑块验证码逆向分析</a></li>
</ul>
<h2><span id="zhua-bao-qing-kuang">抓包情况</span></h2>
<p>主页点击搜索就会跳出二代的验证码，<code>netWebServlet.json</code> 的请求，会返回 <code>challenge</code> 和 <code>gt</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/01.png" alt="01"></p>
<p>有个 <code>get.php</code> 的请求，返回了一个新的 <code>challenge</code>，这个请求之后的操作，都要用这个新的 <code>challenge</code>，不然是验证不成功的，其他的还有验证码背景图片、乱序图片地址、<code>c</code>、<code>s</code> 等值，之前写过三代的文章，都是类似的，这里就不一一分析了。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/02.png" alt="02"></p>
<p>然后是 <code>ajax.php</code> 验证是否通过，通过之后返回一个 <code>validate</code>，请求里同样是需要我们逆向的 <code>w</code> 参数：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/03.png" alt="03"></p>
<p><img src="https://cdn.itbob.cn/img/article/059/04.png" alt="04"></p>
<p>然后同样还是 <code>netWebServlet.json</code> 接口，带上 <code>get.php</code> 请求返回的 <code>challenge</code> 以及 <code>ajax.php</code> 返回的 <code>validate</code>，请求拿到一个 <code>name</code> 的字段。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/05.png" alt="05"></p>
<p><img src="https://cdn.itbob.cn/img/article/059/06.png" alt="06"></p>
<p>后续的搜索数据，带上这个 <code>name</code> 就行了：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/07.png" alt="07"></p>
<h2><span id="ni-xiang-fen-xi">逆向分析</span></h2>
<p>搞过三、四代的都知道我们可以直接搜索 <code>w</code> 的 Unicode 值 <code>\u0077</code> 即可定位，但是二代则不是 Unicode，而是16进制的编码，搜索 <code>\x77</code> 即可定位，当然按照正常流程，跟栈也能很容易找到加密的位置。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/08.png" alt="08"></p>
<h3><span id="huo-qu-h7z-zhi">获取 H7z 值</span></h3>
<p>从上图中可以知道 <code>w</code> 的值为 <code>r7z + H7z</code>，先看 <code>H7z</code>。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/09.png" alt="09"></p>
<p>跟进这个方法，来到一大串控制流，这里还是推荐用 AST 还原一下，后续可能有一些循环啥的，硬跟的话容易出错，当然直接全部扣一把梭也是可以的，<code>H7z</code> 的核心其实就是 RSA 加密随机字符串，三代四代都有，这里就不细讲了。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/10.png" alt="10"></p>
<h3><span id="huo-qu-r7z-zhi">获取 r7z 值</span></h3>
<p>然后就是 <code>r7z</code>，主要由以下两句代码生成：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/11.png" alt="11"></p>
<pre><code class="hljs javascript">q7z = n0B[M9r.R8z(<span class="hljs-number">699</span>)](h7B[M9r.C8z(<span class="hljs-number">105</span>)](Y7z), V7z[M9r.R8z(<span class="hljs-number">818</span>)]())
r7z = p7B[M9r.R8z(<span class="hljs-number">260</span>)](q7z)</code></pre>
<p>可以看到其中有个变量 <code>Y7z</code> 参与了计算，先来看看他是怎么来的，直接搜索即可定位，可以发现同样是16进制的编码，由五个值组成：<code>userresponse</code>、<code>passtime</code>、<code>imgload</code>、<code>aa</code>、<code>ep</code></p>
<p><img src="https://cdn.itbob.cn/img/article/059/12.png" alt="12"></p>
<h4><span id="huo-qu-userresponse-zhi">获取 userresponse 值</span></h4>
<p>挨个分析，首先是 <code>userresponse</code>，将滑动距离和 <code>challenge</code> 的值传入一个方法，得到一个 9 位字符串：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/13.png" alt="13"></p>
<p>上图中 <code>g7z</code> 就是滑动距离，搜索可以看到定义的地方，尺子量一下对比一下，和滑动的距离是一致的：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/14.png" alt="14"></p>
<p><img src="https://cdn.itbob.cn/img/article/059/15.png" alt="15"></p>
<p>然后再来看看那个方法，跟进去之后也是一大串 <code>switch-case</code> 控制流：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/16.png" alt="16"></p>
<p>还原一下代码如下：</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserResponse</span>(<span class="hljs-params">L0z, o0z</span>) </span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j0z = o0z.slice(<span class="hljs-number">32</span>), c0z = [], X0z = <span class="hljs-number">0</span>; X0z &lt; j0z.length; X0z++)&#123;
        <span class="hljs-keyword">var</span> K0z = j0z.charCodeAt(X0z);
        c0z[X0z] = K0z &gt; <span class="hljs-number">57</span> ? K0z - <span class="hljs-number">87</span> : K0z - <span class="hljs-number">48</span>;
    &#125;
    j0z = <span class="hljs-number">36</span> * c0z[<span class="hljs-number">0</span>] + c0z[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">var</span> k0z = <span class="hljs-built_in">Math</span>.round(L0z) + j0z;
    o0z = o0z.slice(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>);
    <span class="hljs-keyword">var</span> n0z, f0z = [[], [], [], [], []], Q0z = &#123;&#125;, N0z = <span class="hljs-number">0</span>;
    X0z = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i0z = o0z.length; i0z &gt; X0z; X0z++)&#123;
        n0z = o0z.charAt(X0z), Q0z[n0z] || (Q0z[n0z] = <span class="hljs-number">1</span>, f0z[N0z].push(n0z), N0z++, N0z = <span class="hljs-number">5</span> == N0z ? <span class="hljs-number">0</span> : N0z);
    &#125;
    <span class="hljs-keyword">var</span> y0z, v0z = k0z, B0z = <span class="hljs-number">4</span>, x0z = <span class="hljs-string">&quot;&quot;</span>, I0z = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>];
    <span class="hljs-keyword">while</span> ( v0z &gt; <span class="hljs-number">0</span>) &#123;
        v0z - I0z[B0z] &gt;= <span class="hljs-number">0</span> ? (y0z = <span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">Math</span>.random() * f0z[B0z].length, <span class="hljs-number">10</span>),
        x0z += f0z[B0z][y0z], v0z -= I0z[B0z]) : (f0z.splice(B0z, <span class="hljs-number">1</span>),
        I0z.splice(B0z, <span class="hljs-number">1</span>), B0z -= <span class="hljs-number">1</span>);
    &#125;
    <span class="hljs-keyword">return</span> x0z;
&#125;</code></pre>
<h4><span id="huo-qu-passtime-zhi">获取 passtime  值</span></h4>
<p><code>passtime</code>  不用考虑是怎么通过函数获取的，含义就是滑动完成所花费的时间，直接取轨迹的最后一个值即可，这个也和三四代是一样的，获取语句为：<code>var passtime = track[track.length - 1][2]</code>，如下图所示，轨迹的最后一个值时间为 871，<code>passtime</code> 的值同样也为 871。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/17.png" alt="17"></p>
<p><img src="https://cdn.itbob.cn/img/article/059/18.png" alt="18"></p>
<h4><span id="huo-qu-imgload-zhi">获取 imgload 值</span></h4>
<p><code>imgload</code> 也没啥特别的，从字面意思猜测应该是图片加载耗时，实测直接写死即可，或者整个随机值就行。</p>
<h4><span id="huo-qu-aa-zhi">获取 aa 值</span></h4>
<p><code>aa</code> 的值就是 <code>F7z</code>，如下图所示：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/19.png" alt="19"></p>
<p>搜索 <code>F7z</code>，定位到下图所示的地方，向一个方法中传入了一个时间戳：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/20.png" alt="20"></p>
<p>跟进去同样是 <code>switch-case</code> 控制流，需要注意的是下图中 <code>c7B[M9r.R8z(781)](M9r.R8z(764), K1z)</code> 的值其实就是轨迹。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/21.png" alt="21"></p>
<p>这段控制流还原一下就变成这样了：</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getF7z</span>(<span class="hljs-params">track</span>)</span>&#123;
    <span class="hljs-keyword">var</span> o5r = <span class="hljs-number">6</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> N1z, X1z = s6z(track), f1z = [], B1z = [], o1z = [], t1z = <span class="hljs-number">0</span>, j1z = X1z.length; t1z &lt; j1z; t1z++)&#123;
        <span class="hljs-keyword">if</span> (o5r * (o5r + <span class="hljs-number">1</span>) % <span class="hljs-number">2</span> + <span class="hljs-number">8</span>) &#123;
            N1z = u6z(X1z[t1z]),
            N1z ? B1z.push(N1z) : (f1z.push(O6z(X1z[t1z][<span class="hljs-number">0</span>])),
            B1z.push(O6z(X1z[t1z][<span class="hljs-number">1</span>]))),
            o1z.push(O6z(X1z[t1z][<span class="hljs-number">2</span>]));
            o5r = o5r &gt;= <span class="hljs-number">17705</span> ? o5r / <span class="hljs-number">3</span> : o5r * <span class="hljs-number">3</span>;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> f1z.join(<span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-string">&quot;!!&quot;</span> + B1z.join(<span class="hljs-string">&quot;&quot;</span>) + <span class="hljs-string">&quot;!!&quot;</span> + o1z.join(<span class="hljs-string">&quot;&quot;</span>);
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s6z</span>(<span class="hljs-params">F6z</span>)</span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> Y6z, g6z, a6z, E6z = [], D6z = <span class="hljs-number">0</span>, P6z = [], J6z = <span class="hljs-number">0</span>, l6z = F6z.length - <span class="hljs-number">1</span>; J6z &lt; l6z; J6z++) &#123;
        Y6z = <span class="hljs-built_in">Math</span>.round(F6z[J6z + <span class="hljs-number">1</span>][<span class="hljs-number">0</span>] - F6z[J6z][<span class="hljs-number">0</span>]),
        g6z = <span class="hljs-built_in">Math</span>.round(F6z[J6z + <span class="hljs-number">1</span>][<span class="hljs-number">1</span>] - F6z[J6z][<span class="hljs-number">1</span>]),
        a6z = <span class="hljs-built_in">Math</span>.round(F6z[J6z + <span class="hljs-number">1</span>][<span class="hljs-number">2</span>] - F6z[J6z][<span class="hljs-number">2</span>]),
        P6z.push([Y6z, g6z, a6z]),
        <span class="hljs-number">0</span> == Y6z &amp;&amp; <span class="hljs-number">0</span> == g6z &amp;&amp; <span class="hljs-number">0</span> == a6z || (<span class="hljs-number">0</span> == Y6z &amp;&amp; <span class="hljs-number">0</span> == g6z ? D6z += a6z : (E6z.push([Y6z, g6z, a6z + D6z]), D6z = <span class="hljs-number">0</span>));
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> !== D6z &amp;&amp; E6z.push([Y6z, g6z, D6z]), E6z;
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">O6z</span>(<span class="hljs-params">r6z</span>)</span>&#123;
    <span class="hljs-keyword">var</span> d6z = <span class="hljs-string">&quot;()*,-./0123456789:?@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqr&quot;</span>
      , m6z = d6z.length
      , Z6z = <span class="hljs-string">&quot;&quot;</span>
      , H6z = <span class="hljs-built_in">Math</span>.abs(r6z)
      , W6z = <span class="hljs-built_in">parseInt</span>(H6z / m6z);
    W6z &gt;= m6z &amp;&amp; (W6z = m6z - <span class="hljs-number">1</span>), W6z &amp;&amp; (Z6z = d6z.charAt(W6z)), H6z %= m6z;
    <span class="hljs-keyword">var</span> q6z = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">return</span> r6z &lt; <span class="hljs-number">0</span> &amp;&amp; (q6z += <span class="hljs-string">&quot;!&quot;</span>), Z6z &amp;&amp; (q6z += <span class="hljs-string">&quot;$&quot;</span>), q6z + Z6z + d6z.charAt(H6z);
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">u6z</span>(<span class="hljs-params">R6z</span>)</span>&#123;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> z6z = [[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>]], h6z = <span class="hljs-number">0</span>, C6z = z6z.length; h6z &lt; C6z; h6z++)&#123;
        <span class="hljs-keyword">if</span> (R6z[<span class="hljs-number">0</span>] == z6z[h6z][<span class="hljs-number">0</span>] &amp;&amp; R6z[<span class="hljs-number">1</span>] == z6z[h6z][<span class="hljs-number">1</span>])&#123;
            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;stuvwxyz~&quot;</span>[h6z]
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre>
<p>以上只是 <code>F7z</code> 第一次生成的地方，后面还有二次处理，如下图所示：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/22.png" alt="22"></p>
<p>同样跟进去，三个传入的参数分别是第一次生成的 <code>F7z</code>、<code>get.php</code> 请求返回的 <code>c</code> 和 <code>s</code> 参数。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/23.png" alt="23"></p>
<p>同样是一段控制流，还原后如下：</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getF7z2</span>(<span class="hljs-params">Q1z, v1z, T1z</span>)</span>&#123;
    <span class="hljs-keyword">var</span> i1z, x1z = <span class="hljs-number">0</span>, c1z = Q1z, y1z = v1z[<span class="hljs-number">0</span>], k1z = v1z[<span class="hljs-number">2</span>], L1z = v1z[<span class="hljs-number">4</span>];
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)&#123;
        <span class="hljs-keyword">if</span> (i1z = T1z.substr(x1z, <span class="hljs-number">2</span>))&#123;
            x1z += <span class="hljs-number">2</span>;
            <span class="hljs-keyword">var</span> n1z = <span class="hljs-built_in">parseInt</span>(i1z, <span class="hljs-number">16</span>)
              , M1z = <span class="hljs-built_in">String</span>.fromCharCode(n1z)
              , I1z = (y1z * n1z * n1z + k1z * n1z + L1z) % Q1z.length;
            c1z = c1z.substr(<span class="hljs-number">0</span>, I1z) + M1z + c1z.substr(I1z);
        &#125;<span class="hljs-keyword">else</span> &#123;
            <span class="hljs-keyword">return</span> c1z
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> Q1z
&#125;</code></pre>
<p>至此 <code>aa</code> 参数分析完毕！</p>
<h4><span id="huo-qu-ep-zhi">获取 ep 值</span></h4>
<p><code>ep</code> 的值就是一个版本号，此处是 <code>&#123;'v': '6.0.9'&#125;</code>，写死即可。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/24.png" alt="24"></p>
<h4><span id="huo-qu-rp-zhi">获取 rp 值</span></h4>
<p>自此 <code>Y7z</code> 的第一步生成就分析完毕了，注意接下来还有一步，向 <code>Y7z</code> 里新增了一个 <code>rp</code> 参数：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/25.png" alt="25"></p>
<p>这个值的组成看起来很长，实际上是将 gt、challenge 前 32 位以及 passtime 相加经过 MD5 加密后得到的。</p>
<pre><code class="hljs javascript">Y7z[<span class="hljs-string">&quot;rp&quot;</span>] = md5(gt + challenge.slice(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>) + passtime)</code></pre>
<p><img src="https://cdn.itbob.cn/img/article/059/26.png" alt="26"></p>
<p>上图中 <code>I0B</code> 就是 MD5 方法，跟进去其实是可以看到很多 MD5 特征的，如下图所示：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/27.png" alt="27"></p>
<p>自此 <code>Y7z</code> 的值就搞定了，然后接着前面的看，也就是 <code>q7z</code> 的值，同样和三四代一样的，<code>encrypt</code> 是 AES 加密，<code>Y7z</code> 经过 <code>JSON.stringify()</code> 处理为字符串作为待加密对象，后面是 16 为随机字符串作为 AES 的 Key，注意这里的随机字符串应该和获取 <code>H7z</code> 值时的随机字符串一致，不然是验证不成功的。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/28.png" alt="28"></p>
<p>然后下一步就是获取 <code>r7z</code> 的值，将上一步得到的 <code>q7z</code> 经过一个方法进行处理，跟进方法，又是和三四代一样的，熟悉的 <code>res + end</code>，如下图所示：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/29.png" alt="29"></p>
<p>直接扣代码，或者直接使用三代的代码即可：</p>
<pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$_GJF</span>(<span class="hljs-params">e</span>) </span>&#123;
    <span class="hljs-keyword">var</span> t = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789()&quot;</span>;
    <span class="hljs-keyword">return</span> e &lt; <span class="hljs-number">0</span> || e &gt;= t[<span class="hljs-string">&quot;length&quot;</span>] ? <span class="hljs-string">&quot;.&quot;</span> : t[<span class="hljs-string">&quot;charAt&quot;</span>](e);
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$_HBO</span>(<span class="hljs-params">e, t</span>) </span>&#123;
    <span class="hljs-keyword">return</span> e &gt;&gt; t &amp; <span class="hljs-number">1</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$_HCX</span>(<span class="hljs-params">e, o</span>) </span>&#123;
    <span class="hljs-keyword">var</span> i = <span class="hljs-built_in">this</span>;
    o || (o = i);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, t</span>) </span>&#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>, r = <span class="hljs-number">24</span> - <span class="hljs-number">1</span>; <span class="hljs-number">0</span> &lt;= r; r -= <span class="hljs-number">1</span>)
            <span class="hljs-number">1</span> === $_HBO(t, r) &amp;&amp; (n = (n &lt;&lt; <span class="hljs-number">1</span>) + $_HBO(e, r));
        <span class="hljs-keyword">return</span> n;
    &#125;, n = <span class="hljs-string">&quot;&quot;</span>, r = <span class="hljs-string">&quot;&quot;</span>, s = e.length, a = <span class="hljs-number">0</span>; a &lt; s; a += <span class="hljs-number">3</span>) &#123;
        <span class="hljs-keyword">var</span> c;
        <span class="hljs-keyword">if</span> (a + <span class="hljs-number">2</span> &lt; s)
            c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>) + e[a + <span class="hljs-number">2</span>],
            n += $_GJF(t(c, <span class="hljs-number">7274496</span>)) + $_GJF(t(c, <span class="hljs-number">9483264</span>)) + $_GJF(t(c, <span class="hljs-number">19220</span>)) + $_GJF(t(c, <span class="hljs-number">235</span>));
        <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-keyword">var</span> _ = s % <span class="hljs-number">3</span>;
            <span class="hljs-number">2</span> == _ ? (c = (e[a] &lt;&lt; <span class="hljs-number">16</span>) + (e[a + <span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>),
            n += $_GJF(t(c, <span class="hljs-number">7274496</span>)) + $_GJF(t(c, <span class="hljs-number">9483264</span>)) + $_GJF(t(c, <span class="hljs-number">19220</span>)),
            r = <span class="hljs-string">&quot;.&quot;</span>) : <span class="hljs-number">1</span> == _ &amp;&amp; (c = e[a] &lt;&lt; <span class="hljs-number">16</span>,
            n += $_GJF(t(c, <span class="hljs-number">7274496</span>)) + $_GJF(t(c, <span class="hljs-number">9483264</span>)),
            r = <span class="hljs-string">&quot;.&quot;</span> + <span class="hljs-string">&quot;.&quot;</span>);
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> &#123;
        <span class="hljs-string">&quot;res&quot;</span>: n,
        <span class="hljs-string">&quot;end&quot;</span>: r
    &#125;;
&#125;</code></pre>
<h3><span id="huo-qu-w-zhi">获取 w 值</span></h3>
<p>自此 <code>w</code> 的就已经出来了，<code>r7z + H7z</code> 即为 <code>w</code> 的值。</p>
<p><img src="https://cdn.itbob.cn/img/article/059/30.png" alt="30"></p>
<h2><span id="jie-guo-yan-zheng">结果验证</span></h2>
<p>测试过掉验证码抓取数据成功：</p>
<p><img src="https://cdn.itbob.cn/img/article/059/31.png" alt="31"></p>

            </div>
        </article>
    </div>
    <br>
    
        <div class="next-prev-post">
            
                <div class="prev-post">
                    <div class="prev gt-c-content-color-first">
                        上一篇：<a href="/article/060/" 
                            class="post-title gt-a-link">极验行为验证，三代滑块验证码逆向分析</a>
                    </div>
                </div>
            
            
                <div class="next-post">
                    <div class="next gt-c-content-color-first">
                        下一篇：<a href="/article/058/" 
                            class="post-title gt-a-link">云片行为验证，滑动验证码、点选验证码逆向分析</a>
                    </div>
                </div>
            
        </div>
    
    

    
    <script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>

    <div id="gitalk-container"></div>

    <script>
    var gitalk = new Gitalk({
        clientID: 'd19a84b9d9a2ddb2c6b9',
        clientSecret: 'cec9feae5129a6106edc68ce06d167be8eb06021',
        repo: 'trhx.github.io',
        owner: 'TRHX',
        admin: ['TRHX'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false       // Facebook-like distraction free mode
    });
    gitalk.render('gitalk-container');
    </script>


    
</div>

                <div class="site-footer gt-c-content-color-first">
    <div class="footer-main">
        <!-- 建议保留版权信息或者添加主题信息到友链，感谢您的理解 -->
        <!-- 文件位置：layout/_includes/footer.ejs -->
        <!-- <span style="text-align: right; float: right;">
            Theme 
            <a href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a>
             | Powered by
            <a href="https://hexo.io" target="_blank">Hexo</a>
        </span>
        <span style="text-align: left;"></span> -->
        <span>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user"></i> UV
                </span>
                <span class="badge-value bg-pink" id="busuanzi_value_site_uv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fas fa-user-plus"></i> PV
                </span>
                <span class="badge-value bg-blue" id="busuanzi_value_site_pv"></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-keyboard"></i> Word Count
                </span>
                <span class="badge-value bg-firebrick post-count">314.6k</span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-cog fa-spin"></i> Powered by
                </span>
                <span class="badge-value bg-brightgreen"><a href="https://hexo.io" target="_blank">Hexo</a></span>
            </div>
            <div class="itbob-github-badge">
                <span class="badge-subject">
                    <i class="fa fa-paper-plane"></i> Theme
                </span>
                <span class="badge-value bg-orange"><a href="https://github.com/renbaoshuo/hexo-theme-pure" target="_blank">Pure</a></span>
            </div>
        </span>
        <br/>
        <br/>

        <span style="text-align: center; float: center;">
            Copyright <i class="fa fa-copyright"></i> 2018 - <script>document.write(new Date().getFullYear());</script> <a href="https://www.itbob.cn/" target="_blank">ITBOB.CN</a> 丨
            <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">
                <i class="fab fa-creative-commons"></i>
                <i class="fab fa-creative-commons-by"></i>
                <i class="fab fa-creative-commons-nc"></i>
                <i class="fab fa-creative-commons-nd"></i>
            </a> 丨
            <!-- <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 丨 -->
            <span id="sitetime">正在载入网站运行时间...</span>
            <script>
                function siteTime(){
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth()+1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    /* 
                    Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
                    year - 作为date对象的年份，为4位年份值
                    month - 0-11之间的整数，做为date对象的月份
                    day - 1-31之间的整数，做为date对象的天数
                    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
                    minutes - 0-59之间的整数，做为date对象的分钟数
                    seconds - 0-59之间的整数，做为date对象的秒数
                    microseconds - 0-999之间的整数，做为date对象的毫秒数
                    */
                    var t1 = Date.UTC(2018,08,10,17,38,00); //北京时间2018-8-10 17:38:00
                    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
                    var diff = t2-t1;
                    var diffYears = Math.floor(diff/years);
                    var diffDays = Math.floor((diff/days)-diffYears*365);
                    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
                    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
                    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
                    document.getElementById("sitetime").innerHTML="小破站已运行了 "
                    + "<font style='color:#FE3C65;font-weight:bold'>" + diffYears + "</font>" + " 年 "
                    + "<font style='color:#FFA500;font-weight:bold'>" + diffDays + "</font>" + " 天 "
                    + "<font style='color:#1DBF97;font-weight:bold'>" + diffHours + "</font>" + " 小时 "
                    + "<font style='color:#8A2BE2;font-weight:bold'>" + diffMinutes + "</font>" + " 分 "
                    + "<font style='color:#007EC6;font-weight:bold'>" + diffSeconds + "</font>" + " 秒 ";
                }
                siteTime();
            </script>
        </span>
        <br/>
        <br/>
        <span>
            <img src="https://cdn.itbob.cn/img/footer/icp.png" class="nofancybox" alt="ICP" style="width:auto; height:20px; margin-bottom:-4px"><a href="https://beian.miit.gov.cn/" target="_blank"> 鄂ICP备19003281号-7</a>丨
            <img src="https://cdn.itbob.cn/img/footer/moeicp.png" class="nofancybox" alt="MOE ICP" style="width:auto; height:18px; margin-bottom:-3.5px"><a href="https://icp.gov.moe/" target="_blank"> 萌ICP备20202022号</a>丨
            <img src="https://cdn.itbob.cn/img/footer/webify.png" class="nofancybox" alt="腾讯云开发 Webify" style="width:auto; height:25px; margin-bottom:-8px"><a href="https://webify.cloudbase.net/" target="_blank"> 云开发 Webify</a>丨
            <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src="https://cdn.itbob.cn/img/footer/upyun.png" class="nofancybox" alt="又拍云赞助云存储" style="width:auto; height:19px; margin-bottom:-4px"></a> 赞助CDN/COS服务丨
            <a href="https://www.foreverblog.cn/" target="_blank"><img src="https://cdn.itbob.cn/img/footer/foreverblog.png" class="nofancybox" alt="十年之约" style="width:auto; height:15px; margin-bottom:-2px"></a>
        </span>
    </div>
</div>

<!-- <div class="sidebar_wo" id="leimu">
    <img src="https://cdn.itbob.cn/img/footer/leimuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/leimuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/leimuA.png'" title="回到底部">
</div>
<div class="sidebar_wo" id="lamu">
    <img src="https://cdn.itbob.cn/img/footer/lamuA.png" class="nofancybox" alt="雷姆" 
    onmouseover="this.src='https://cdn.itbob.cn/img/footer/lamuB.png'" 
    onmouseout="this.src='https://cdn.itbob.cn/img/footer/lamuA.png'" title="回到顶部">
</div> -->

<script>
    /* 拉姆蕾姆回到顶部或底部按钮 */
    $(function() {
        $("#leimu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:$(document).height()},800);
            return false;
        });
        $("#lamu img").eq(0).click(function() {
            $("html,body").animate({scrollTop:0},800);
            return false;
        });
    });
</script>

            </div>
        </div>
        <!-- <a id="back-to-top" class="back-to-top show hl fa fa-arrow-up" href="javascript:void(0)" title="回到顶部"></a> -->
        <a id="back-to-top" class="back-to-top2" href="javascript:void(0)" title="回到顶部">
            <img class="nofancybox" src="https://cdn.itbob.cn/img/back_to_top.png"/>
        </a>
        <script>
            (function () {
                // When to show the scroll link
                // higher number = scroll link appears further down the page   
                var upperLimit = 100;
                
                // Our scroll link element
                var scrollElem = $('#back-to-top');
            
                // Scroll to top speed
                var scrollSpeed = 500;
            
                // Show and hide the scroll to top link based on scroll position   
                scrollElem.hide();
                $(window).scroll(function () {            
                    var scrollTop = $(document).scrollTop();       
                    if ( scrollTop > upperLimit ) {
                        $(scrollElem).stop().fadeTo(200, 1); // fade back in           
                    }else{       
                        $(scrollElem).stop().fadeTo(200, 0); // fade out
                    }
                });

                // Scroll to top animation on click
                $(scrollElem).click(function(){
                    $('html, body').animate({scrollTop:0}, scrollSpeed); return false;
                });
            })();
        </script>
    </body>
</html>