<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1"/>



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>





    <link rel="dns-prefetch" href="https://hm.baidu.com"/>

    <link rel="dns-prefetch" href="https://www.google-analytics.com"/>



    <link rel="dns-prefetch" href="https://fonts.proxy.ustclug.org"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图） | 
        
        ITBOB&#39;S BLOG
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！">
    <meta name="keywords" content="ITRHX,TRHX,ITBOB,BOB,爬虫,Python爬虫,数据分析,数据可视化,逆向,逆向安全,JS逆向,安卓逆向,Android逆向,APP逆向,Python,JavaScript,Python,爬虫,肺炎疫情,COVID-19,数据可视化">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/prettify.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/prettify/atelier-forest-light.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: ZCOOL XiaoWei, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.proxy.ustclug.org/css?family=ZCOOL%20XiaoWei:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/material-icons.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/jquery.min.js", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ITBOB&#39;S BLOG">
    <meta name="msapplication-starturl" content="https://www.itbob.cn/article/035/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="ITBOB&#39;S BLOG">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    
        
            <link rel=alternate type="application/atom+xml" href="/atom.xml">
        
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://www.itbob.cn/article/035/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图） | ITBOB&#39;S BLOG">
    <meta property="og:image" content="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png">
    <meta property="og:description" content="BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！">
    <meta property="og:article:tag" content="Python"> <meta property="og:article:tag" content="爬虫"> <meta property="og:article:tag" content="肺炎疫情"> <meta property="og:article:tag" content="COVID-19"> <meta property="og:article:tag" content="数据可视化"> 

    
        <meta property="article:published_time" content="Mon Jul 06 2020 12:49:35 GMT+0800">
        <meta property="article:modified_time" content="Sun Jan 23 2022 00:06:00 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://www.itbob.cn/article/035/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://www.itbob.cn/article/035/index.html",
    "headline": "COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）",
    "datePublished": "Mon Jul 06 2020 12:49:35 GMT+0800",
    "dateModified": "Sun Jan 23 2022 00:06:00 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "BOB",
        "image": {
            "@type": "ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/BOB.png"
        },
        "description": "Hi, nice to meet you"
    },
    "publisher": {
        "@type": "Organization",
        "name": "ITBOB&#39;S BLOG",
        "logo": {
            "@type":"ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png"
        }
    },
    "keywords": ",Python,爬虫,肺炎疫情,COVID-19,数据可视化ITRHX,TRHX,ITBOB,BOB,爬虫,Python爬虫,数据分析,数据可视化,逆向,逆向安全,JS逆向,安卓逆向,Android逆向,APP逆向,Python,JavaScript",
    "description": "BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！",
}
</script>


    

    <!-- Analytics -->
    
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'G-FLNER0M8ML', 'auto');ga('send', 'pageview');
</script>
    
    
        <script>
    var _hmt = _hmt || [];
    (function() {var hm = document.createElement('script');
    hm.src = 'https://hm.baidu.com/hm.js?6ca34ddce088f8434f3c7509576819f2';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(hm, s);
    })();
</script>
    
    

    <!-- Custom Head -->
    

    <!-- fancybox support -->
    
        <!-- for theme: default is false -->
        <!-- for page: default is true -->
        
            <script>lsloader.load("fancybox_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/fancybox.min.js", true)</script>
            <script>lsloader.load("wrap_image_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/wrapImage.js", true)</script>
            <style id="fancybox_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("fancybox_css","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/css/fancybox.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        
    
<meta name="generator" content="Hexo 5.4.0"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%901x00%E3%80%91%E5%89%8D%E8%A8%80"><span class="post-toc-number">1.</span> <span class="post-toc-text">【1x00】前言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%902x00%E3%80%91%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE"><span class="post-toc-number">2.</span> <span class="post-toc-text">【2x00】思维导图</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%903x00%E3%80%91%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="post-toc-number">3.</span> <span class="post-toc-text">【3x00】数据结构分析</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%904x00%E3%80%91%E4%B8%BB%E5%87%BD%E6%95%B0-main"><span class="post-toc-number">4.</span> <span class="post-toc-text">【4x00】主函数 main()</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%905x00%E3%80%91%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%A8%A1%E5%9D%97-data-get"><span class="post-toc-number">5.</span> <span class="post-toc-text">【5x00】数据获取模块 data_get</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%905x01%E3%80%91%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0-init"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">【5x01】初始化函数 init()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%905x02%E3%80%91%E4%B8%AD%E5%9B%BD%E6%80%BB%E6%95%B0%E6%8D%AE-china-total-data"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">【5x02】中国总数据 china_total_data()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%905x03%E3%80%91%E5%85%A8%E7%90%83%E6%80%BB%E6%95%B0%E6%8D%AE-global-total-data"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">【5x03】全球总数据 global_total_data()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%905x04%E3%80%91%E4%B8%AD%E5%9B%BD%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE-china-daily-data"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">【5x04】中国每日数据 china_daily_data()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%905x05%E3%80%91%E5%A2%83%E5%A4%96%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE-foreign-daily-data"><span class="post-toc-number">5.5.</span> <span class="post-toc-text">【5x05】境外每日数据 foreign_daily_data()</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%906x00%E3%80%91%E8%AF%8D%E4%BA%91%E5%9B%BE%E7%BB%98%E5%88%B6%E6%A8%A1%E5%9D%97-data-wordcloud"><span class="post-toc-number">6.</span> <span class="post-toc-text">【6x00】词云图绘制模块 data_wordcloud</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%906x01%E3%80%91%E4%B8%AD%E5%9B%BD%E7%B4%AF%E8%AE%A1%E7%A1%AE%E8%AF%8A%E8%AF%8D%E4%BA%91%E5%9B%BE-foreign-daily-data"><span class="post-toc-number">6.1.</span> <span class="post-toc-text">【6x01】中国累计确诊词云图 foreign_daily_data()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%906x02%E3%80%91%E5%85%A8%E7%90%83%E7%B4%AF%E8%AE%A1%E7%A1%AE%E8%AF%8A%E8%AF%8D%E4%BA%91%E5%9B%BE-foreign-daily-data"><span class="post-toc-number">6.2.</span> <span class="post-toc-text">【6x02】全球累计确诊词云图 foreign_daily_data()</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%907x00%E3%80%91%E5%9C%B0%E5%9B%BE%E7%BB%98%E5%88%B6%E6%A8%A1%E5%9D%97-data-map"><span class="post-toc-number">7.</span> <span class="post-toc-text">【7x00】地图绘制模块 data_map</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%907x01%E3%80%91%E4%B8%AD%E5%9B%BD%E7%B4%AF%E8%AE%A1%E7%A1%AE%E8%AF%8A%E5%9C%B0%E5%9B%BE-china-total-map"><span class="post-toc-number">7.1.</span> <span class="post-toc-text">【7x01】中国累计确诊地图 china_total_map()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%907x02%E3%80%91%E5%85%A8%E7%90%83%E7%B4%AF%E8%AE%A1%E7%A1%AE%E8%AF%8A%E5%9C%B0%E5%9B%BE-global-total-map"><span class="post-toc-number">7.2.</span> <span class="post-toc-text">【7x02】全球累计确诊地图 global_total_map()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%907x03%E3%80%91%E4%B8%AD%E5%9B%BD%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%98%E7%BA%BF%E5%9B%BE-china-daily-map"><span class="post-toc-number">7.3.</span> <span class="post-toc-text">【7x03】中国每日数据折线图 china_daily_map()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%907x04%E3%80%91%E5%A2%83%E5%A4%96%E6%AF%8F%E6%97%A5%E6%95%B0%E6%8D%AE%E6%8A%98%E7%BA%BF%E5%9B%BE-foreign-daily-map"><span class="post-toc-number">7.4.</span> <span class="post-toc-text">【7x04】境外每日数据折线图 foreign_daily_map()</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%908x00%E3%80%91%E7%BB%93%E6%9E%9C%E6%88%AA%E5%9B%BE"><span class="post-toc-number">8.</span> <span class="post-toc-text">【8x00】结果截图</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%908x01%E3%80%91%E6%95%B0%E6%8D%AE%E5%82%A8%E5%AD%98-Excel"><span class="post-toc-number">8.1.</span> <span class="post-toc-text">【8x01】数据储存 Excel</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%908x02%E3%80%91%E8%AF%8D%E4%BA%91%E5%9B%BE"><span class="post-toc-number">8.2.</span> <span class="post-toc-text">【8x02】词云图</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E3%80%908x03%E3%80%91%E5%9C%B0%E5%9B%BE-%E6%8A%98%E7%BA%BF%E5%9B%BE"><span class="post-toc-number">8.3.</span> <span class="post-toc-text">【8x03】地图 + 折线图</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E3%80%909x00%E3%80%91%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="post-toc-number">9.</span> <span class="post-toc-text">【9x00】完整代码</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 71 + 1);

    $('.post_thumbnail-random').attr('data-original', 'https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/BOB.png" width="44px" height="44px" class="itbob-author-avatar" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>BOB</strong>
        <!-- <span>7月 06, 2020</span> -->
        <span>2020-07-06 12:49:35</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!-- <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button> -->
   

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item" style="text-align:center; color:#E30B20; font-weight:600">在其它设备中阅读本文章</li>
    
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACY0lEQVR42u3aQZLiMBAEQP7/6d0H7OKpalnCQ6RPBGDs9EHdlPr156uPFx4eHh4eHh4e3sN4r/h4d9Z/LnD5/uwqxVl4eHh4R3g/LLUBI3kE/76+vvrs3vDw8PBO8t4tuCu3lS/31+cm38fDw8P7vbxrdv7LeHh4eN/Eu6ZehwXtd/Dw8PCezMtb5Fl5eHdz+a1vz1rw8PDwYl6+yXT+9dH9PTw8PLyANwsUZm1x2xwP7xAPDw9vMy9fiJNGeX3I4Ib7wcPDw9vMS0KB5HEkwe51AcjHtooYFw8PD28brw0FdpSWu8YX8PDw8J7AyzfM2hA2KQztg8PDw8M7w5tt4a8UknbLrWjf8fDw8Dbz8uGANrxYfyeJRfDw8PA+xcsX+nZxnxWbtkjg4eHhfYq3Etq2586QS5MReHh4eLfy8kW8DRry8LcNHaLRATw8PLxtvHYbLN8Yax9BS8XDw8M7z2sb3LYVnkW0S2UGDw8P7yAvD3YTfIucBRN4eHh453k/tKej9rdtr6OBgLw44eHh4R3ktQWgbYVnG2n1A8LDw8M7yMv//Ldt8aw8DINjPDw8vOO8NnhdGTvIG+jkWnh4eHjneeux7Gwc4RUfUZnBw8PD28xrj5WgYVYM2iYeDw8Pbzdvtii3n64PVw2HrvDw8PC28fLAdHb5uwrDDWEEHh4e3q282QI9Cy/uHefCw8PDez4viXTbIaq2tNQpNR4eHt5HeddbZfmnw6Z5Fkbg4eHhbeAlYUQeqs5+uS0MeHh4eJ/i5RFAu8HfUvMy8PZ9PDw8vM287zvw8PDw8PDw8PAecPwFS1KGkhOhkM0AAAAASUVORK5CYII=">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/COVID-19/" rel="tag">COVID-19</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/Python/" rel="tag">Python</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">数据可视化</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/%E8%82%BA%E7%82%8E%E7%96%AB%E6%83%85/" rel="tag">肺炎疫情</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    <!-- Leancloud Views -->
    <!--  -->
    
    
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span class="post-count">本文字数&nbsp;7.6k 字</span>
        </li>
    </a>
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span class="post-count">阅读时长&nbsp;37 分</span>
        </li>
    </a>
    
    <!-- Busuanzi Views -->
    
        
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        本文浏览量&nbsp;<span id="busuanzi_value_page_pv"></span>
                    </span>
                </li>
            </a>
        
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=ITBOB&#39;S BLOG&title=COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）&summary=BOB 的个人博客；主攻 Python、爬虫、逆向、数据分析、数据可视化；记录毕生所学！&pics=https://www.itbob.cnhttps://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png&url=https://www.itbob.cn/article/035/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）&url=https://www.itbob.cn/article/035/index.html&pic=https://www.itbob.cnhttps://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）&url=https://www.itbob.cn/article/035/index.html&via=BOB" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Telegram -->
    
        <a class="post_share-link" href="https://telegram.me/share/url?url=https://www.itbob.cn/article/035/index.html&text=COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）" target="_blank">
            <li class="mdl-menu__item">
                分享到 Telegram
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://www.itbob.cn/article/035/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.itbob.cn/article/035/index.html&title=COVID-19 肺炎疫情数据实时监控（python 爬虫 + pyecharts 数据可视化 + wordcloud 词云图）" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    


    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://www.itbob.cn/article/035/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <pre><code class="yaml">这里是一段防爬虫文本，请读者忽略。
本文原创首发于 CSDN，作者 TRHX。
博客首页：https://itrhx.blog.csdn.net/
本文链接：https://itrhx.blog.csdn.net/article/details/107140534
未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！
</code></pre>
<hr>
<h2 id="【1x00】前言"><a href="#【1x00】前言" class="headerlink" title="【1x00】前言"></a><font color=#FF0000>【1x00】前言</font></h2><p>本来两三个月之前就想搞个疫情数据实时数据展示的，由于各种不可抗拒因素一而再再而三的鸽了，最近终于抽空写了一个，数据是用 Python 爬取的<a target="_blank" rel="noopener" href="https://voice.baidu.com/act/newpneumonia/newpneumonia/">百度疫情实时大数据报告</a>，请求库用的 requests，解析用的 Xpath 语法，词云用的 wordcloud 库，数据可视化用 pyecharts 绘制的地图和折线图，数据储存在 Excel 表格里面，使用 openpyxl 对表格进行处理。</p>
<p>本程序实现了累计确诊地图展示和每日数据变化折线图展示，其他更多数据的获取和展示均可在程序中进行拓展，可以将程序部署在服务器上，设置定时运行，即可实时展示数据，pyecharts 绘图模块也可以整合到 Web 框架（Django、Flask等）中使用。</p>
<p>在获取数据时有<font color=#FF0000><strong>全球</strong></font>和<font color=#FF0000><strong>境外</strong></font>两个概念，全球包含中国，境外不包含中国，后期绘制的四个图：中国累计确诊地图、全球累计确诊地图（包含中国）、中国每日数据折线图、境外每日数据折线图（不包含中国）。</p>
<p><font color=#FF0000><strong>注意项：直接向该网页发送请求获取的响应中，没有每个国家的每日数据，该数据获取的地址是：<a href="https://voice.baidu.com/newpneumonia/get?target=trend&isCaseIn=1&stage=publish">https://voice.baidu.com/newpneumonia/get?target=trend&amp;isCaseIn=1&amp;stage=publish</a></strong></font></p>
<ul>
<li><p><strong>预览地址</strong>：<a target="_blank" rel="noopener" href="http://cov.itrhx.com/">http://cov.itrhx.com/</a></p>
</li>
<li><p><strong>数据来源</strong>：<a target="_blank" rel="noopener" href="https://voice.baidu.com/act/newpneumonia/newpneumonia/">https://voice.baidu.com/act/newpneumonia/newpneumonia/</a></p>
</li>
<li><p><strong>pyecharts 文档</strong>：<a target="_blank" rel="noopener" href="https://pyecharts.org/">https://pyecharts.org/</a></p>
</li>
<li><p><strong>openpyxl 文档</strong>：<a target="_blank" rel="noopener" href="https://openpyxl.readthedocs.io/">https://openpyxl.readthedocs.io/</a></p>
</li>
<li><p><strong>wordcloud 文档</strong>：<a target="_blank" rel="noopener" href="http://amueller.github.io/word_cloud/">http://amueller.github.io/word_cloud/</a></p>
</li>
</ul>
<h2 id="【2x00】思维导图"><a href="#【2x00】思维导图" class="headerlink" title="【2x00】思维导图"></a><font color=#FF0000>【2x00】思维导图</font></h2><p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/01.png" alt="01"></p>
<h2 id="【3x00】数据结构分析"><a href="#【3x00】数据结构分析" class="headerlink" title="【3x00】数据结构分析"></a><font color=#FF0000>【3x00】数据结构分析</font></h2><p>通过查看百度的疫情数据页面，可以看到很多整齐的数据，猜测就是疫情相关的数据，保存该页面，对其进行格式化，很容易可以分析出所有的数据都在 <code>&lt;script type=&quot;application/json&quot; id=&quot;captain-config&quot;&gt;&lt;/script&gt;</code> 里面，其中 title 里面是一些 Unicode 编码，将其转为中文后更容易得到不同的分类数据。</p>
<p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/02.png" alt="02"></p>
<p>由于数据繁多，可以将数据主体部分提取出来，删除一些重复项和其他杂项，留下数据大体位置并分析数据结构，便于后期的数据提取，经过处理后的数据大致结构如下：</p>
<pre><code class="json">&lt;script type=&quot;application/json&quot; id=&quot;captain-config&quot;&gt;
    &#123;
        &quot;component&quot;: [
            &#123;
                &quot;mapLastUpdatedTime&quot;: &quot;2020.07.05 16:13&quot;,        // 国内疫情数据最后更新时间
                &quot;caseList&quot;: [                                    // caseList 列表，每一个元素是一个字典
                    &#123;
                        &quot;confirmed&quot;: &quot;1&quot;,                        // 每个字典包含中国每个省的每一项疫情数据
                        &quot;died&quot;: &quot;0&quot;,
                        &quot;crued&quot;: &quot;1&quot;,
                        &quot;relativeTime&quot;: &quot;1593792000&quot;,
                        &quot;confirmedRelative&quot;: &quot;0&quot;,
                        &quot;diedRelative&quot;: &quot;0&quot;,
                        &quot;curedRelative&quot;: &quot;0&quot;,
                        &quot;curConfirm&quot;: &quot;0&quot;,
                        &quot;curConfirmRelative&quot;: &quot;0&quot;,
                        &quot;icuDisable&quot;: &quot;1&quot;,
                        &quot;area&quot;: &quot;西藏&quot;,
                        &quot;subList&quot;: [                            // subList 列表，每一个元素是一个字典
                            &#123;
                                &quot;city&quot;: &quot;拉萨&quot;,                 // 每个字典包含该省份对应的每个城市疫情数据
                                &quot;confirmed&quot;: &quot;1&quot;,
                                &quot;died&quot;: &quot;0&quot;,
                                &quot;crued&quot;: &quot;1&quot;,
                                &quot;confirmedRelative&quot;: &quot;0&quot;,
                                &quot;curConfirm&quot;: &quot;0&quot;,
                                &quot;cityCode&quot;: &quot;100&quot;
                            &#125;
                        ]
                    &#125;
                ],
                &quot;caseOutsideList&quot;: [                           // caseOutsideList 列表，每一个元素是一个字典
                    &#123;
                        &quot;confirmed&quot;: &quot;241419&quot;,                 // 每个字典包含各国的每一项疫情数据
                        &quot;died&quot;: &quot;34854&quot;,
                        &quot;crued&quot;: &quot;191944&quot;,
                        &quot;relativeTime&quot;: &quot;1593792000&quot;,
                        &quot;confirmedRelative&quot;: &quot;223&quot;,
                        &quot;curConfirm&quot;: &quot;14621&quot;,
                        &quot;icuDisable&quot;: &quot;1&quot;,
                        &quot;area&quot;: &quot;意大利&quot;,
                        &quot;subList&quot;: [                          // subList 列表，每一个元素是一个字典
                            &#123;
                                &quot;city&quot;: &quot;伦巴第&quot;,              // 每个字典包含每个国家对应的每个城市疫情数据
                                &quot;confirmed&quot;: &quot;94318&quot;,
                                &quot;died&quot;: &quot;16691&quot;,
                                &quot;crued&quot;: &quot;68201&quot;,
                                &quot;curConfirm&quot;: &quot;9426&quot;
                            &#125;
                        ]
                    &#125;
                ],
                &quot;summaryDataIn&quot;: &#123;                           // summaryDataIn 国内总的疫情数据
                    &quot;confirmed&quot;: &quot;85307&quot;,
                    &quot;died&quot;: &quot;4648&quot;,
                    &quot;cured&quot;: &quot;80144&quot;,
                    &quot;asymptomatic&quot;: &quot;99&quot;,
                    &quot;asymptomaticRelative&quot;: &quot;7&quot;,
                    &quot;unconfirmed&quot;: &quot;7&quot;,
                    &quot;relativeTime&quot;: &quot;1593792000&quot;,
                    &quot;confirmedRelative&quot;: &quot;19&quot;,
                    &quot;unconfirmedRelative&quot;: &quot;1&quot;,
                    &quot;curedRelative&quot;: &quot;27&quot;,
                    &quot;diedRelative&quot;: &quot;0&quot;,
                    &quot;icu&quot;: &quot;6&quot;,
                    &quot;icuRelative&quot;: &quot;0&quot;,
                    &quot;overseasInput&quot;: &quot;1931&quot;,
                    &quot;unOverseasInputCumulative&quot;: &quot;83375&quot;,
                    &quot;overseasInputRelative&quot;: &quot;6&quot;,
                    &quot;unOverseasInputNewAdd&quot;: &quot;13&quot;,
                    &quot;curConfirm&quot;: &quot;515&quot;,
                    &quot;curConfirmRelative&quot;: &quot;-8&quot;,
                    &quot;icuDisable&quot;: &quot;1&quot;
                &#125;,
                &quot;summaryDataOut&quot;: &#123;                           // summaryDataOut 国外总的疫情数据
                    &quot;confirmed&quot;: &quot;11302569&quot;,
                    &quot;died&quot;: &quot;528977&quot;,
                    &quot;curConfirm&quot;: &quot;4410601&quot;,
                    &quot;cured&quot;: &quot;6362991&quot;,
                    &quot;confirmedRelative&quot;: &quot;206165&quot;,
                    &quot;curedRelative&quot;: &quot;190018&quot;,
                    &quot;diedRelative&quot;: &quot;4876&quot;,
                    &quot;curConfirmRelative&quot;: &quot;11271&quot;,
                    &quot;relativeTime&quot;: &quot;1593792000&quot;
                &#125;,
                &quot;trend&quot;: &#123;                                    // trend 字典，包含国内每日的疫情数据
                    &quot;updateDate&quot;: [],                         // 日期
                    &quot;list&quot;: [                                 // list 列表，每项数据及其对应的值
                        &#123;
                            &quot;name&quot;: &quot;确诊&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;疑似&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;治愈&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;死亡&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;新增确诊&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;新增疑似&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;新增治愈&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;新增死亡&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;累计境外输入&quot;,
                            &quot;data&quot;: []
                        &#125;,
                        &#123;
                            &quot;name&quot;: &quot;新增境外输入&quot;,
                            &quot;data&quot;: []
                        &#125;
                    ]
                &#125;,
                &quot;foreignLastUpdatedTime&quot;: &quot;2020.07.05 16:13&quot;,       // 国外疫情数据最后更新时间
                &quot;globalList&quot;: [                                     // globalList 列表，每一个元素是一个字典
                    &#123;
                        &quot;area&quot;: &quot;亚洲&quot;,                              // 按照不同洲进行分类
                        &quot;subList&quot;: [                                // subList 列表，每个洲各个国家的疫情数据
                            &#123;
                                &quot;died&quot;: &quot;52&quot;,
                                &quot;confirmed&quot;: &quot;6159&quot;,
                                &quot;crued&quot;: &quot;4809&quot;,
                                &quot;curConfirm&quot;: &quot;1298&quot;,
                                &quot;confirmedRelative&quot;: &quot;0&quot;,
                                &quot;relativeTime&quot;: &quot;1593792000&quot;,
                                &quot;country&quot;: &quot;塔吉克斯坦&quot;
                            &#125;
                        ],
                        &quot;died&quot;: &quot;56556&quot;,                            // 每个洲总的疫情数据
                        &quot;crued&quot;: &quot;1625562&quot;,
                        &quot;confirmed&quot;: &quot;2447873&quot;,
                        &quot;curConfirm&quot;: &quot;765755&quot;,
                        &quot;confirmedRelative&quot;: &quot;60574&quot;
                    &#125;,
                    &#123;
                        &quot;area&quot;: &quot;其他&quot;,                             // 其他特殊区域疫情数据
                        &quot;subList&quot;: [
                            &#123;
                                &quot;died&quot;: &quot;13&quot;,
                                &quot;confirmed&quot;: &quot;712&quot;,
                                &quot;crued&quot;: &quot;651&quot;,
                                &quot;curConfirm&quot;: &quot;48&quot;,
                                &quot;confirmedRelative&quot;: &quot;0&quot;,
                                &quot;relativeTime&quot;: &quot;1593792000&quot;,
                                &quot;country&quot;: &quot;钻石公主号邮轮&quot;
                            &#125;
                        ],
                        &quot;died&quot;: &quot;13&quot;,                              // 其他特殊区域疫情总的数据
                        &quot;crued&quot;: &quot;651&quot;,
                        &quot;confirmed&quot;: &quot;712&quot;,
                        &quot;curConfirm&quot;: &quot;48&quot;,
                        &quot;confirmedRelative&quot;: &quot;0&quot;
                    &#125;,
                    &#123;
                        &quot;area&quot;: &quot;热门&quot;,                            // 热门国家疫情数据
                        &quot;subList&quot;: [
                            &#123;
                                &quot;died&quot;: &quot;5206&quot;,
                                &quot;confirmed&quot;: &quot;204610&quot;,
                                &quot;crued&quot;: &quot;179492&quot;,
                                &quot;curConfirm&quot;: &quot;19912&quot;,
                                &quot;confirmedRelative&quot;: &quot;1172&quot;,
                                &quot;relativeTime&quot;: &quot;1593792000&quot;,
                                &quot;country&quot;: &quot;土耳其&quot;
                            &#125;
                        ],
                        &quot;died&quot;: &quot;528967&quot;,                         // 热门国家疫情总的数据
                        &quot;crued&quot;: &quot;6362924&quot;,
                        &quot;confirmed&quot;: &quot;11302357&quot;,
                        &quot;confirmedRelative&quot;: &quot;216478&quot;,
                        &quot;curConfirm&quot;: &quot;4410466&quot;
                    &#125;],
                &quot;allForeignTrend&quot;: &#123;                            // allForeignTrend 字典，包含国外每日的疫情数据
                        &quot;updateDate&quot;: [],                       // 日期
                        &quot;list&quot;: [                               // list 列表，每项数据及其对应的值
                            &#123;
                                &quot;name&quot;: &quot;累计确诊&quot;,
                                &quot;data&quot;: []
                            &#125;,
                            &#123;
                                &quot;name&quot;: &quot;治愈&quot;,
                                &quot;data&quot;: []
                            &#125;,
                            &#123;
                                &quot;name&quot;: &quot;死亡&quot;,
                                &quot;data&quot;: []
                            &#125;,
                            &#123;
                                &quot;name&quot;: &quot;现有确诊&quot;,
                                &quot;data&quot;: []
                            &#125;,
                            &#123;
                                &quot;name&quot;: &quot;新增确诊&quot;,
                                &quot;data&quot;: []
                            &#125;
                        ]
                    &#125;,
                &quot;topAddCountry&quot;: [                    // 确诊增量最高的国家
                        &#123;
                            &quot;name&quot;: &quot;美国&quot;,
                            &quot;value&quot;: 53162
                        &#125;
                    ],
                &quot;topOverseasInput&quot;: [                // 境外输入最多的省份
                    &#123;
                        &quot;name&quot;: &quot;黑龙江&quot;,
                        &quot;value&quot;: 386
                    &#125;
                ]
            &#125;
        ]
    &#125;
&lt;/script&gt;
</code></pre>
<h2 id="【4x00】主函数-main"><a href="#【4x00】主函数-main" class="headerlink" title="【4x00】主函数 main()"></a><font color=#FF0000>【4x00】主函数 main()</font></h2><p>分别将数据获取、词云图绘制、地图绘制写入三个文件：<code>data_get()</code>、<code>data_wordcloud()</code>、<code>data_map()</code>，然后使用一个主函数文件 main.py 来调用这三个文件里面的函数。</p>
<pre><code class="python">import data_get
import data_wordcloud
import data_map

data_dict = data_get.init()
data_get.china_total_data(data_dict)
data_get.global_total_data(data_dict)
data_get.china_daily_data(data_dict)
data_get.foreign_daily_data(data_dict)

data_wordcloud.china_wordcloud()
data_wordcloud.global_wordcloud()

data_map.all_map()
</code></pre>
<h2 id="【5x00】数据获取模块-data-get"><a href="#【5x00】数据获取模块-data-get" class="headerlink" title="【5x00】数据获取模块 data_get"></a><font color=#FF0000>【5x00】数据获取模块 data_get</font></h2><h3 id="【5x01】初始化函数-init"><a href="#【5x01】初始化函数-init" class="headerlink" title="【5x01】初始化函数 init()"></a><font color="#4876FF">【5x01】初始化函数 init()</font></h3><p>使用 xpath 语法 <code>//script[@id=&quot;captain-config&quot;]/text()</code> 提取里面的值，利用 <code>json.loads</code> 方法将其转换为字典对象，以便后续的其他函数调用。</p>
<pre><code class="python">def init():
    headers = &#123;
        &#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.13 Safari/537.36&#39;
    &#125;
    url = &#39;https://voice.baidu.com/act/newpneumonia/newpneumonia/&#39;
    response = requests.get(url=url, headers=headers)
    tree = etree.HTML(response.text)
    dict1 = tree.xpath(&#39;//script[@id=&quot;captain-config&quot;]/text()&#39;)
    print(type(dict1[0]))
    dict2 = json.loads(dict1[0])
    return dict2
</code></pre>
<h3 id="【5x02】中国总数据-china-total-data"><a href="#【5x02】中国总数据-china-total-data" class="headerlink" title="【5x02】中国总数据 china_total_data()"></a><font color="#4876FF">【5x02】中国总数据 china_total_data()</font></h3><pre><code class="python">def china_total_data(data):

    &quot;&quot;&quot;
    1、中国省/直辖市/自治区/行政区疫情数据
    省/直辖市/自治区/行政区：area
    现有确诊：    curConfirm
    累计确诊：    confirmed
    累计治愈：    crued
    累计死亡：    died
    现有确诊增量： curConfirmRelative
    累计确诊增量： confirmedRelative
    累计治愈增量： curedRelative
    累计死亡增量： diedRelative
    &quot;&quot;&quot;

    wb = openpyxl.Workbook()            # 创建工作簿
    ws_china = wb.active                # 获取工作表
    ws_china.title = &quot;中国省份疫情数据&quot;   # 命名工作表
    ws_china.append([&#39;省/直辖市/自治区/行政区&#39;, &#39;现有确诊&#39;, &#39;累计确诊&#39;, &#39;累计治愈&#39;,
                     &#39;累计死亡&#39;, &#39;现有确诊增量&#39;, &#39;累计确诊增量&#39;,
                     &#39;累计治愈增量&#39;, &#39;累计死亡增量&#39;])
    china = data[&#39;component&#39;][0][&#39;caseList&#39;]
    for province in china:
        ws_china.append([province[&#39;area&#39;],
                        province[&#39;curConfirm&#39;],
                        province[&#39;confirmed&#39;],
                        province[&#39;crued&#39;],
                        province[&#39;died&#39;],
                        province[&#39;curConfirmRelative&#39;],
                        province[&#39;confirmedRelative&#39;],
                        province[&#39;curedRelative&#39;],
                        province[&#39;diedRelative&#39;]])

    &quot;&quot;&quot;
    2、中国城市疫情数据
    城市：city
    现有确诊：curConfirm
    累计确诊：confirmed
    累计治愈：crued
    累计死亡：died
    累计确诊增量：confirmedRelative
    &quot;&quot;&quot;

    ws_city = wb.create_sheet(&#39;中国城市疫情数据&#39;)
    ws_city.append([&#39;城市&#39;, &#39;现有确诊&#39;, &#39;累计确诊&#39;,
                    &#39;累计治愈&#39;, &#39;累计死亡&#39;, &#39;累计确诊增量&#39;])
    for province in china:
        for city in province[&#39;subList&#39;]:
            # 某些城市没有 curConfirm 数据，则将其设置为 0，crued 和 died 为空时，替换成 0
            if &#39;curConfirm&#39; not in city:
                city[&#39;curConfirm&#39;] = &#39;0&#39;
            if city[&#39;crued&#39;] == &#39;&#39;:
                city[&#39;crued&#39;] = &#39;0&#39;
            if city[&#39;died&#39;] == &#39;&#39;:
                city[&#39;died&#39;] = &#39;0&#39;
            ws_city.append([city[&#39;city&#39;], &#39;0&#39;, city[&#39;confirmed&#39;],
                           city[&#39;crued&#39;], city[&#39;died&#39;], city[&#39;confirmedRelative&#39;]])

    &quot;&quot;&quot;
    3、中国疫情数据更新时间：mapLastUpdatedTime
    &quot;&quot;&quot;

    time_domestic = data[&#39;component&#39;][0][&#39;mapLastUpdatedTime&#39;]
    ws_time = wb.create_sheet(&#39;中国疫情数据更新时间&#39;)
    ws_time.column_dimensions[&#39;A&#39;].width = 22  # 调整列宽
    ws_time.append([&#39;中国疫情数据更新时间&#39;])
    ws_time.append([time_domestic])

    wb.save(&#39;COVID-19-China.xlsx&#39;)
    print(&#39;中国疫情数据已保存至 COVID-19-China.xlsx！&#39;)
</code></pre>
<h3 id="【5x03】全球总数据-global-total-data"><a href="#【5x03】全球总数据-global-total-data" class="headerlink" title="【5x03】全球总数据 global_total_data()"></a><font color="#4876FF">【5x03】全球总数据 global_total_data()</font></h3><p>全球总数据在提取完成后，进行地图绘制时发现并没有中国的数据，因此在写入全球数据时注意要单独将中国的数据插入 Excel 中。</p>
<pre><code class="python">def global_total_data(data):

    &quot;&quot;&quot;
    1、全球各国疫情数据
    国家：country
    现有确诊：curConfirm
    累计确诊：confirmed
    累计治愈：crued
    累计死亡：died
    累计确诊增量：confirmedRelative
    &quot;&quot;&quot;

    wb = openpyxl.Workbook()
    ws_global = wb.active
    ws_global.title = &quot;全球各国疫情数据&quot;

    # 按照国家保存数据
    countries = data[&#39;component&#39;][0][&#39;caseOutsideList&#39;]
    ws_global.append([&#39;国家&#39;, &#39;现有确诊&#39;, &#39;累计确诊&#39;, &#39;累计治愈&#39;, &#39;累计死亡&#39;, &#39;累计确诊增量&#39;])
    for country in countries:
        ws_global.append([country[&#39;area&#39;],
                          country[&#39;curConfirm&#39;],
                          country[&#39;confirmed&#39;],
                          country[&#39;crued&#39;],
                          country[&#39;died&#39;],
                          country[&#39;confirmedRelative&#39;]])

    # 按照洲保存数据
    continent = data[&#39;component&#39;][0][&#39;globalList&#39;]
    for area in continent:
        ws_foreign = wb.create_sheet(area[&#39;area&#39;] + &#39;疫情数据&#39;)
        ws_foreign.append([&#39;国家&#39;, &#39;现有确诊&#39;, &#39;累计确诊&#39;, &#39;累计治愈&#39;, &#39;累计死亡&#39;, &#39;累计确诊增量&#39;])
        for country in area[&#39;subList&#39;]:
            ws_foreign.append([country[&#39;country&#39;],
                               country[&#39;curConfirm&#39;],
                               country[&#39;confirmed&#39;],
                               country[&#39;crued&#39;],
                               country[&#39;died&#39;],
                               country[&#39;confirmedRelative&#39;]])

    # 在“全球各国疫情数据”和“亚洲疫情数据”两张表中写入中国疫情数据
    ws1, ws2 = wb[&#39;全球各国疫情数据&#39;], wb[&#39;亚洲疫情数据&#39;]
    original_data = data[&#39;component&#39;][0][&#39;summaryDataIn&#39;]
    add_china_data = [&#39;中国&#39;,
                      original_data[&#39;curConfirm&#39;],
                      original_data[&#39;confirmed&#39;],
                      original_data[&#39;cured&#39;],
                      original_data[&#39;died&#39;],
                      original_data[&#39;confirmedRelative&#39;]]
    ws1.append(add_china_data)
    ws2.append(add_china_data)

    &quot;&quot;&quot;
    2、全球疫情数据更新时间：foreignLastUpdatedTime
    &quot;&quot;&quot;

    time_foreign = data[&#39;component&#39;][0][&#39;foreignLastUpdatedTime&#39;]
    ws_time = wb.create_sheet(&#39;全球疫情数据更新时间&#39;)
    ws_time.column_dimensions[&#39;A&#39;].width = 22  # 调整列宽
    ws_time.append([&#39;全球疫情数据更新时间&#39;])
    ws_time.append([time_foreign])

    wb.save(&#39;COVID-19-Global.xlsx&#39;)
    print(&#39;全球疫情数据已保存至 COVID-19-Global.xlsx！&#39;)
</code></pre>
<h3 id="【5x04】中国每日数据-china-daily-data"><a href="#【5x04】中国每日数据-china-daily-data" class="headerlink" title="【5x04】中国每日数据 china_daily_data()"></a><font color="#4876FF">【5x04】中国每日数据 china_daily_data()</font></h3><pre><code class="python">def china_daily_data(data):

    &quot;&quot;&quot;
    i_dict = data[&#39;component&#39;][0][&#39;trend&#39;]
    i_dict[&#39;updateDate&#39;]：日期
    i_dict[&#39;list&#39;][0]：确诊
    i_dict[&#39;list&#39;][1]：疑似
    i_dict[&#39;list&#39;][2]：治愈
    i_dict[&#39;list&#39;][3]：死亡
    i_dict[&#39;list&#39;][4]：新增确诊
    i_dict[&#39;list&#39;][5]：新增疑似
    i_dict[&#39;list&#39;][6]：新增治愈
    i_dict[&#39;list&#39;][7]：新增死亡
    i_dict[&#39;list&#39;][8]：累计境外输入
    i_dict[&#39;list&#39;][9]：新增境外输入
    &quot;&quot;&quot;

    ccd_dict = data[&#39;component&#39;][0][&#39;trend&#39;]
    update_date = ccd_dict[&#39;updateDate&#39;]              # 日期
    china_confirmed = ccd_dict[&#39;list&#39;][0][&#39;data&#39;]     # 每日累计确诊数据
    china_crued = ccd_dict[&#39;list&#39;][2][&#39;data&#39;]         # 每日累计治愈数据
    china_died = ccd_dict[&#39;list&#39;][3][&#39;data&#39;]          # 每日累计死亡数据
    wb = openpyxl.load_workbook(&#39;COVID-19-China.xlsx&#39;)

    # 写入每日累计确诊数据
    ws_china_confirmed = wb.create_sheet(&#39;中国每日累计确诊数据&#39;)
    ws_china_confirmed.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, china_confirmed):
        ws_china_confirmed.append(data)

    # 写入每日累计治愈数据
    ws_china_crued = wb.create_sheet(&#39;中国每日累计治愈数据&#39;)
    ws_china_crued.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, china_crued):
        ws_china_crued.append(data)

    # 写入每日累计死亡数据
    ws_china_died = wb.create_sheet(&#39;中国每日累计死亡数据&#39;)
    ws_china_died.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, china_died):
        ws_china_died.append(data)

    wb.save(&#39;COVID-19-China.xlsx&#39;)
    print(&#39;中国每日累计确诊/治愈/死亡数据已保存至 COVID-19-China.xlsx！&#39;)
</code></pre>
<h3 id="【5x05】境外每日数据-foreign-daily-data"><a href="#【5x05】境外每日数据-foreign-daily-data" class="headerlink" title="【5x05】境外每日数据 foreign_daily_data()"></a><font color="#4876FF">【5x05】境外每日数据 foreign_daily_data()</font></h3><pre><code class="python">def foreign_daily_data(data):

    &quot;&quot;&quot;
    te_dict = data[&#39;component&#39;][0][&#39;allForeignTrend&#39;]
    te_dict[&#39;updateDate&#39;]：日期
    te_dict[&#39;list&#39;][0]：累计确诊
    te_dict[&#39;list&#39;][1]：治愈
    te_dict[&#39;list&#39;][2]：死亡
    te_dict[&#39;list&#39;][3]：现有确诊
    te_dict[&#39;list&#39;][4]：新增确诊
    &quot;&quot;&quot;

    te_dict = data[&#39;component&#39;][0][&#39;allForeignTrend&#39;]
    update_date = te_dict[&#39;updateDate&#39;]                # 日期
    foreign_confirmed = te_dict[&#39;list&#39;][0][&#39;data&#39;]     # 每日累计确诊数据
    foreign_crued = te_dict[&#39;list&#39;][1][&#39;data&#39;]         # 每日累计治愈数据
    foreign_died = te_dict[&#39;list&#39;][2][&#39;data&#39;]          # 每日累计死亡数据
    wb = openpyxl.load_workbook(&#39;COVID-19-Global.xlsx&#39;)

    # 写入每日累计确诊数据
    ws_foreign_confirmed = wb.create_sheet(&#39;境外每日累计确诊数据&#39;)
    ws_foreign_confirmed.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, foreign_confirmed):
        ws_foreign_confirmed.append(data)

    # 写入累计治愈数据
    ws_foreign_crued = wb.create_sheet(&#39;境外每日累计治愈数据&#39;)
    ws_foreign_crued.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, foreign_crued):
        ws_foreign_crued.append(data)

    # 写入累计死亡数据
    ws_foreign_died = wb.create_sheet(&#39;境外每日累计死亡数据&#39;)
    ws_foreign_died.append([&#39;日期&#39;, &#39;数据&#39;])
    for data in zip(update_date, foreign_died):
        ws_foreign_died.append(data)

    wb.save(&#39;COVID-19-Global.xlsx&#39;)
    print(&#39;境外每日累计确诊/治愈/死亡数据已保存至 COVID-19-Global.xlsx！&#39;)
</code></pre>
<h2 id="【6x00】词云图绘制模块-data-wordcloud"><a href="#【6x00】词云图绘制模块-data-wordcloud" class="headerlink" title="【6x00】词云图绘制模块 data_wordcloud"></a><font color=#FF0000>【6x00】词云图绘制模块 data_wordcloud</font></h2><h3 id="【6x01】中国累计确诊词云图-foreign-daily-data"><a href="#【6x01】中国累计确诊词云图-foreign-daily-data" class="headerlink" title="【6x01】中国累计确诊词云图 foreign_daily_data()"></a><font color="#4876FF">【6x01】中国累计确诊词云图 foreign_daily_data()</font></h3><pre><code class="python">def china_wordcloud():
    wb = openpyxl.load_workbook(&#39;COVID-19-China.xlsx&#39;)  # 获取已有的xlsx文件
    ws_china = wb[&#39;中国省份疫情数据&#39;]                     # 获取中国省份疫情数据表
    ws_china.delete_rows(1)                             # 删除第一行
    china_dict = &#123;&#125;                                     # 将省份及其累计确诊按照键值对形式储存在字典中
    for data in ws_china.values:
        china_dict[data[0]] = int(data[2])
    word_cloud = wordcloud.WordCloud(font_path=&#39;C:/Windows/Fonts/simsun.ttc&#39;,
                                     background_color=&#39;#CDC9C9&#39;,
                                     min_font_size=15,
                                     width=900, height=500)
    word_cloud.generate_from_frequencies(china_dict)
    word_cloud.to_file(&#39;WordCloud-China.png&#39;)
    print(&#39;中国省份疫情词云图绘制完毕！&#39;)
</code></pre>
<h3 id="【6x02】全球累计确诊词云图-foreign-daily-data"><a href="#【6x02】全球累计确诊词云图-foreign-daily-data" class="headerlink" title="【6x02】全球累计确诊词云图 foreign_daily_data()"></a><font color="#4876FF">【6x02】全球累计确诊词云图 foreign_daily_data()</font></h3><pre><code class="python">def global_wordcloud():
    wb = openpyxl.load_workbook(&#39;COVID-19-Global.xlsx&#39;)
    ws_global = wb[&#39;全球各国疫情数据&#39;]
    ws_global.delete_rows(1)
    global_dict = &#123;&#125;
    for data in ws_global.values:
        global_dict[data[0]] = int(data[2])
    word_cloud = wordcloud.WordCloud(font_path=&#39;C:/Windows/Fonts/simsun.ttc&#39;,
                                     background_color=&#39;#CDC9C9&#39;,
                                     width=900, height=500)
    word_cloud.generate_from_frequencies(global_dict)
    word_cloud.to_file(&#39;WordCloud-Global.png&#39;)
    print(&#39;全球各国疫情词云图绘制完毕！&#39;)
</code></pre>
<hr>
<pre><code class="yaml">这里是一段防爬虫文本，请读者忽略。
本文原创首发于 CSDN，作者 TRHX。
博客首页：https://itrhx.blog.csdn.net/
本文链接：https://itrhx.blog.csdn.net/article/details/107140534
未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！
</code></pre>
<hr>
<h2 id="【7x00】地图绘制模块-data-map"><a href="#【7x00】地图绘制模块-data-map" class="headerlink" title="【7x00】地图绘制模块 data_map"></a><font color=#FF0000>【7x00】地图绘制模块 data_map</font></h2><h3 id="【7x01】中国累计确诊地图-china-total-map"><a href="#【7x01】中国累计确诊地图-china-total-map" class="headerlink" title="【7x01】中国累计确诊地图 china_total_map()"></a><font color="#4876FF">【7x01】中国累计确诊地图 china_total_map()</font></h3><pre><code class="python">def china_total_map():
    wb = openpyxl.load_workbook(&#39;COVID-19-China.xlsx&#39;)  # 获取已有的xlsx文件
    ws_time = wb[&#39;中国疫情数据更新时间&#39;]                   # 获取文件中中国疫情数据更新时间表
    ws_data = wb[&#39;中国省份疫情数据&#39;]                      # 获取文件中中国省份疫情数据表
    ws_data.delete_rows(1)                              # 删除第一行
    province = []                                       # 省份
    curconfirm = []                                     # 累计确诊
    for data in ws_data.values:
        province.append(data[0])
        curconfirm.append(data[2])
    time_china = ws_time[&#39;A2&#39;].value                    # 更新时间

    # 设置分级颜色
    pieces = [
        &#123;&#39;max&#39;: 0, &#39;min&#39;: 0, &#39;label&#39;: &#39;0&#39;, &#39;color&#39;: &#39;#FFFFFF&#39;&#125;,
        &#123;&#39;max&#39;: 9, &#39;min&#39;: 1, &#39;label&#39;: &#39;1-9&#39;, &#39;color&#39;: &#39;#FFE5DB&#39;&#125;,
        &#123;&#39;max&#39;: 99, &#39;min&#39;: 10, &#39;label&#39;: &#39;10-99&#39;, &#39;color&#39;: &#39;#FF9985&#39;&#125;,
        &#123;&#39;max&#39;: 999, &#39;min&#39;: 100, &#39;label&#39;: &#39;100-999&#39;, &#39;color&#39;: &#39;#F57567&#39;&#125;,
        &#123;&#39;max&#39;: 9999, &#39;min&#39;: 1000, &#39;label&#39;: &#39;1000-9999&#39;, &#39;color&#39;: &#39;#E64546&#39;&#125;,
        &#123;&#39;max&#39;: 99999, &#39;min&#39;: 10000, &#39;label&#39;: &#39;≧10000&#39;, &#39;color&#39;: &#39;#B80909&#39;&#125;
    ]

    # 绘制地图
    ct_map = (
        Map()
        .add(series_name=&#39;累计确诊人数&#39;, data_pair=[list(z) for z in zip(province, curconfirm)], maptype=&quot;china&quot;)
        .set_global_opts(
            title_opts=opts.TitleOpts(title=&quot;中国疫情数据（累计确诊）&quot;,
                                      subtitle=&#39;数据更新至：&#39; + time_china + &#39;\n\n来源：百度疫情实时大数据报告&#39;),
            visualmap_opts=opts.VisualMapOpts(max_=300, is_piecewise=True, pieces=pieces)
        )
    )
    return ct_map
</code></pre>
<h3 id="【7x02】全球累计确诊地图-global-total-map"><a href="#【7x02】全球累计确诊地图-global-total-map" class="headerlink" title="【7x02】全球累计确诊地图 global_total_map()"></a><font color="#4876FF">【7x02】全球累计确诊地图 global_total_map()</font></h3><pre><code class="python">def global_total_map():
    wb = openpyxl.load_workbook(&#39;COVID-19-Global.xlsx&#39;)
    ws_time = wb[&#39;全球疫情数据更新时间&#39;]
    ws_data = wb[&#39;全球各国疫情数据&#39;]
    ws_data.delete_rows(1)
    country = []                        # 国家
    curconfirm = []                     # 累计确诊
    for data in ws_data.values:
        country.append(data[0])
        curconfirm.append(data[2])
    time_global = ws_time[&#39;A2&#39;].value   # 更新时间

    # 国家名称中英文映射表
    name_map = &#123;
          &quot;Somalia&quot;: &quot;索马里&quot;,
          &quot;Liechtenstein&quot;: &quot;列支敦士登&quot;,
          &quot;Morocco&quot;: &quot;摩洛哥&quot;,
          &quot;W. Sahara&quot;: &quot;西撒哈拉&quot;,
          &quot;Serbia&quot;: &quot;塞尔维亚&quot;,
          &quot;Afghanistan&quot;: &quot;阿富汗&quot;,
          &quot;Angola&quot;: &quot;安哥拉&quot;,
          &quot;Albania&quot;: &quot;阿尔巴尼亚&quot;,
          &quot;Andorra&quot;: &quot;安道尔共和国&quot;,
          &quot;United Arab Emirates&quot;: &quot;阿拉伯联合酋长国&quot;,
          &quot;Argentina&quot;: &quot;阿根廷&quot;,
          &quot;Armenia&quot;: &quot;亚美尼亚&quot;,
          &quot;Australia&quot;: &quot;澳大利亚&quot;,
          &quot;Austria&quot;: &quot;奥地利&quot;,
          &quot;Azerbaijan&quot;: &quot;阿塞拜疆&quot;,
          &quot;Burundi&quot;: &quot;布隆迪&quot;,
          &quot;Belgium&quot;: &quot;比利时&quot;,
          &quot;Benin&quot;: &quot;贝宁&quot;,
          &quot;Burkina Faso&quot;: &quot;布基纳法索&quot;,
          &quot;Bangladesh&quot;: &quot;孟加拉国&quot;,
          &quot;Bulgaria&quot;: &quot;保加利亚&quot;,
          &quot;Bahrain&quot;: &quot;巴林&quot;,
          &quot;Bahamas&quot;: &quot;巴哈马&quot;,
          &quot;Bosnia and Herz.&quot;: &quot;波斯尼亚和黑塞哥维那&quot;,
          &quot;Belarus&quot;: &quot;白俄罗斯&quot;,
          &quot;Belize&quot;: &quot;伯利兹&quot;,
          &quot;Bermuda&quot;: &quot;百慕大&quot;,
          &quot;Bolivia&quot;: &quot;玻利维亚&quot;,
          &quot;Brazil&quot;: &quot;巴西&quot;,
          &quot;Barbados&quot;: &quot;巴巴多斯&quot;,
          &quot;Brunei&quot;: &quot;文莱&quot;,
          &quot;Bhutan&quot;: &quot;不丹&quot;,
          &quot;Botswana&quot;: &quot;博茨瓦纳&quot;,
          &quot;Central African Rep.&quot;: &quot;中非共和国&quot;,
          &quot;Canada&quot;: &quot;加拿大&quot;,
          &quot;Switzerland&quot;: &quot;瑞士&quot;,
          &quot;Chile&quot;: &quot;智利&quot;,
          &quot;China&quot;: &quot;中国&quot;,
          &quot;Côte d&#39;Ivoire&quot;: &quot;科特迪瓦&quot;,
          &quot;Cameroon&quot;: &quot;喀麦隆&quot;,
          &quot;Dem. Rep. Congo&quot;: &quot;刚果（布）&quot;,
          &quot;Congo&quot;: &quot;刚果（金）&quot;,
          &quot;Colombia&quot;: &quot;哥伦比亚&quot;,
          &quot;Cape Verde&quot;: &quot;佛得角&quot;,
          &quot;Costa Rica&quot;: &quot;哥斯达黎加&quot;,
          &quot;Cuba&quot;: &quot;古巴&quot;,
          &quot;N. Cyprus&quot;: &quot;北塞浦路斯&quot;,
          &quot;Cyprus&quot;: &quot;塞浦路斯&quot;,
          &quot;Czech Rep.&quot;: &quot;捷克&quot;,
          &quot;Germany&quot;: &quot;德国&quot;,
          &quot;Djibouti&quot;: &quot;吉布提&quot;,
          &quot;Denmark&quot;: &quot;丹麦&quot;,
          &quot;Dominican Rep.&quot;: &quot;多米尼加&quot;,
          &quot;Algeria&quot;: &quot;阿尔及利亚&quot;,
          &quot;Ecuador&quot;: &quot;厄瓜多尔&quot;,
          &quot;Egypt&quot;: &quot;埃及&quot;,
          &quot;Eritrea&quot;: &quot;厄立特里亚&quot;,
          &quot;Spain&quot;: &quot;西班牙&quot;,
          &quot;Estonia&quot;: &quot;爱沙尼亚&quot;,
          &quot;Ethiopia&quot;: &quot;埃塞俄比亚&quot;,
          &quot;Finland&quot;: &quot;芬兰&quot;,
          &quot;Fiji&quot;: &quot;斐济&quot;,
          &quot;France&quot;: &quot;法国&quot;,
          &quot;Gabon&quot;: &quot;加蓬&quot;,
          &quot;United Kingdom&quot;: &quot;英国&quot;,
          &quot;Georgia&quot;: &quot;格鲁吉亚&quot;,
          &quot;Ghana&quot;: &quot;加纳&quot;,
          &quot;Guinea&quot;: &quot;几内亚&quot;,
          &quot;Gambia&quot;: &quot;冈比亚&quot;,
          &quot;Guinea-Bissau&quot;: &quot;几内亚比绍&quot;,
          &quot;Eq. Guinea&quot;: &quot;赤道几内亚&quot;,
          &quot;Greece&quot;: &quot;希腊&quot;,
          &quot;Grenada&quot;: &quot;格林纳达&quot;,
          &quot;Greenland&quot;: &quot;格陵兰岛&quot;,
          &quot;Guatemala&quot;: &quot;危地马拉&quot;,
          &quot;Guam&quot;: &quot;关岛&quot;,
          &quot;Guyana&quot;: &quot;圭亚那合作共和国&quot;,
          &quot;Honduras&quot;: &quot;洪都拉斯&quot;,
          &quot;Croatia&quot;: &quot;克罗地亚&quot;,
          &quot;Haiti&quot;: &quot;海地&quot;,
          &quot;Hungary&quot;: &quot;匈牙利&quot;,
          &quot;Indonesia&quot;: &quot;印度尼西亚&quot;,
          &quot;India&quot;: &quot;印度&quot;,
          &quot;Br. Indian Ocean Ter.&quot;: &quot;英属印度洋领土&quot;,
          &quot;Ireland&quot;: &quot;爱尔兰&quot;,
          &quot;Iran&quot;: &quot;伊朗&quot;,
          &quot;Iraq&quot;: &quot;伊拉克&quot;,
          &quot;Iceland&quot;: &quot;冰岛&quot;,
          &quot;Israel&quot;: &quot;以色列&quot;,
          &quot;Italy&quot;: &quot;意大利&quot;,
          &quot;Jamaica&quot;: &quot;牙买加&quot;,
          &quot;Jordan&quot;: &quot;约旦&quot;,
          &quot;Japan&quot;: &quot;日本&quot;,
          &quot;Siachen Glacier&quot;: &quot;锡亚琴冰川&quot;,
          &quot;Kazakhstan&quot;: &quot;哈萨克斯坦&quot;,
          &quot;Kenya&quot;: &quot;肯尼亚&quot;,
          &quot;Kyrgyzstan&quot;: &quot;吉尔吉斯斯坦&quot;,
          &quot;Cambodia&quot;: &quot;柬埔寨&quot;,
          &quot;Korea&quot;: &quot;韩国&quot;,
          &quot;Kuwait&quot;: &quot;科威特&quot;,
          &quot;Lao PDR&quot;: &quot;老挝&quot;,
          &quot;Lebanon&quot;: &quot;黎巴嫩&quot;,
          &quot;Liberia&quot;: &quot;利比里亚&quot;,
          &quot;Libya&quot;: &quot;利比亚&quot;,
          &quot;Sri Lanka&quot;: &quot;斯里兰卡&quot;,
          &quot;Lesotho&quot;: &quot;莱索托&quot;,
          &quot;Lithuania&quot;: &quot;立陶宛&quot;,
          &quot;Luxembourg&quot;: &quot;卢森堡&quot;,
          &quot;Latvia&quot;: &quot;拉脱维亚&quot;,
          &quot;Moldova&quot;: &quot;摩尔多瓦&quot;,
          &quot;Madagascar&quot;: &quot;马达加斯加&quot;,
          &quot;Mexico&quot;: &quot;墨西哥&quot;,
          &quot;Macedonia&quot;: &quot;马其顿&quot;,
          &quot;Mali&quot;: &quot;马里&quot;,
          &quot;Malta&quot;: &quot;马耳他&quot;,
          &quot;Myanmar&quot;: &quot;缅甸&quot;,
          &quot;Montenegro&quot;: &quot;黑山&quot;,
          &quot;Mongolia&quot;: &quot;蒙古国&quot;,
          &quot;Mozambique&quot;: &quot;莫桑比克&quot;,
          &quot;Mauritania&quot;: &quot;毛里塔尼亚&quot;,
          &quot;Mauritius&quot;: &quot;毛里求斯&quot;,
          &quot;Malawi&quot;: &quot;马拉维&quot;,
          &quot;Malaysia&quot;: &quot;马来西亚&quot;,
          &quot;Namibia&quot;: &quot;纳米比亚&quot;,
          &quot;New Caledonia&quot;: &quot;新喀里多尼亚&quot;,
          &quot;Niger&quot;: &quot;尼日尔&quot;,
          &quot;Nigeria&quot;: &quot;尼日利亚&quot;,
          &quot;Nicaragua&quot;: &quot;尼加拉瓜&quot;,
          &quot;Netherlands&quot;: &quot;荷兰&quot;,
          &quot;Norway&quot;: &quot;挪威&quot;,
          &quot;Nepal&quot;: &quot;尼泊尔&quot;,
          &quot;New Zealand&quot;: &quot;新西兰&quot;,
          &quot;Oman&quot;: &quot;阿曼&quot;,
          &quot;Pakistan&quot;: &quot;巴基斯坦&quot;,
          &quot;Panama&quot;: &quot;巴拿马&quot;,
          &quot;Peru&quot;: &quot;秘鲁&quot;,
          &quot;Philippines&quot;: &quot;菲律宾&quot;,
          &quot;Papua New Guinea&quot;: &quot;巴布亚新几内亚&quot;,
          &quot;Poland&quot;: &quot;波兰&quot;,
          &quot;Puerto Rico&quot;: &quot;波多黎各&quot;,
          &quot;Dem. Rep. Korea&quot;: &quot;朝鲜&quot;,
          &quot;Portugal&quot;: &quot;葡萄牙&quot;,
          &quot;Paraguay&quot;: &quot;巴拉圭&quot;,
          &quot;Palestine&quot;: &quot;巴勒斯坦&quot;,
          &quot;Qatar&quot;: &quot;卡塔尔&quot;,
          &quot;Romania&quot;: &quot;罗马尼亚&quot;,
          &quot;Russia&quot;: &quot;俄罗斯&quot;,
          &quot;Rwanda&quot;: &quot;卢旺达&quot;,
          &quot;Saudi Arabia&quot;: &quot;沙特阿拉伯&quot;,
          &quot;Sudan&quot;: &quot;苏丹&quot;,
          &quot;S. Sudan&quot;: &quot;南苏丹&quot;,
          &quot;Senegal&quot;: &quot;塞内加尔&quot;,
          &quot;Singapore&quot;: &quot;新加坡&quot;,
          &quot;Solomon Is.&quot;: &quot;所罗门群岛&quot;,
          &quot;Sierra Leone&quot;: &quot;塞拉利昂&quot;,
          &quot;El Salvador&quot;: &quot;萨尔瓦多&quot;,
          &quot;Suriname&quot;: &quot;苏里南&quot;,
          &quot;Slovakia&quot;: &quot;斯洛伐克&quot;,
          &quot;Slovenia&quot;: &quot;斯洛文尼亚&quot;,
          &quot;Sweden&quot;: &quot;瑞典&quot;,
          &quot;Swaziland&quot;: &quot;斯威士兰&quot;,
          &quot;Seychelles&quot;: &quot;塞舌尔&quot;,
          &quot;Syria&quot;: &quot;叙利亚&quot;,
          &quot;Chad&quot;: &quot;乍得&quot;,
          &quot;Togo&quot;: &quot;多哥&quot;,
          &quot;Thailand&quot;: &quot;泰国&quot;,
          &quot;Tajikistan&quot;: &quot;塔吉克斯坦&quot;,
          &quot;Turkmenistan&quot;: &quot;土库曼斯坦&quot;,
          &quot;Timor-Leste&quot;: &quot;东帝汶&quot;,
          &quot;Tonga&quot;: &quot;汤加&quot;,
          &quot;Trinidad and Tobago&quot;: &quot;特立尼达和多巴哥&quot;,
          &quot;Tunisia&quot;: &quot;突尼斯&quot;,
          &quot;Turkey&quot;: &quot;土耳其&quot;,
          &quot;Tanzania&quot;: &quot;坦桑尼亚&quot;,
          &quot;Uganda&quot;: &quot;乌干达&quot;,
          &quot;Ukraine&quot;: &quot;乌克兰&quot;,
          &quot;Uruguay&quot;: &quot;乌拉圭&quot;,
          &quot;United States&quot;: &quot;美国&quot;,
          &quot;Uzbekistan&quot;: &quot;乌兹别克斯坦&quot;,
          &quot;Venezuela&quot;: &quot;委内瑞拉&quot;,
          &quot;Vietnam&quot;: &quot;越南&quot;,
          &quot;Vanuatu&quot;: &quot;瓦努阿图&quot;,
          &quot;Yemen&quot;: &quot;也门&quot;,
          &quot;South Africa&quot;: &quot;南非&quot;,
          &quot;Zambia&quot;: &quot;赞比亚&quot;,
          &quot;Zimbabwe&quot;: &quot;津巴布韦&quot;,
          &quot;Aland&quot;: &quot;奥兰群岛&quot;,
          &quot;American Samoa&quot;: &quot;美属萨摩亚&quot;,
          &quot;Fr. S. Antarctic Lands&quot;: &quot;南极洲&quot;,
          &quot;Antigua and Barb.&quot;: &quot;安提瓜和巴布达&quot;,
          &quot;Comoros&quot;: &quot;科摩罗&quot;,
          &quot;Curaçao&quot;: &quot;库拉索岛&quot;,
          &quot;Cayman Is.&quot;: &quot;开曼群岛&quot;,
          &quot;Dominica&quot;: &quot;多米尼加&quot;,
          &quot;Falkland Is.&quot;: &quot;福克兰群岛马尔维纳斯&quot;,
          &quot;Faeroe Is.&quot;: &quot;法罗群岛&quot;,
          &quot;Micronesia&quot;: &quot;密克罗尼西亚&quot;,
          &quot;Heard I. and McDonald Is.&quot;: &quot;赫德岛和麦克唐纳群岛&quot;,
          &quot;Isle of Man&quot;: &quot;曼岛&quot;,
          &quot;Jersey&quot;: &quot;泽西岛&quot;,
          &quot;Kiribati&quot;: &quot;基里巴斯&quot;,
          &quot;Saint Lucia&quot;: &quot;圣卢西亚&quot;,
          &quot;N. Mariana Is.&quot;: &quot;北马里亚纳群岛&quot;,
          &quot;Montserrat&quot;: &quot;蒙特塞拉特&quot;,
          &quot;Niue&quot;: &quot;纽埃&quot;,
          &quot;Palau&quot;: &quot;帕劳&quot;,
          &quot;Fr. Polynesia&quot;: &quot;法属波利尼西亚&quot;,
          &quot;S. Geo. and S. Sandw. Is.&quot;: &quot;南乔治亚岛和南桑威奇群岛&quot;,
          &quot;Saint Helena&quot;: &quot;圣赫勒拿&quot;,
          &quot;St. Pierre and Miquelon&quot;: &quot;圣皮埃尔和密克隆群岛&quot;,
          &quot;São Tomé and Principe&quot;: &quot;圣多美和普林西比&quot;,
          &quot;Turks and Caicos Is.&quot;: &quot;特克斯和凯科斯群岛&quot;,
          &quot;St. Vin. and Gren.&quot;: &quot;圣文森特和格林纳丁斯&quot;,
          &quot;U.S. Virgin Is.&quot;: &quot;美属维尔京群岛&quot;,
          &quot;Samoa&quot;: &quot;萨摩亚&quot;
        &#125;

    pieces = [
        &#123;&#39;max&#39;: 0, &#39;min&#39;: 0, &#39;label&#39;: &#39;0&#39;, &#39;color&#39;: &#39;#FFFFFF&#39;&#125;,
        &#123;&#39;max&#39;: 49, &#39;min&#39;: 1, &#39;label&#39;: &#39;1-49&#39;, &#39;color&#39;: &#39;#FFE5DB&#39;&#125;,
        &#123;&#39;max&#39;: 99, &#39;min&#39;: 50, &#39;label&#39;: &#39;50-99&#39;, &#39;color&#39;: &#39;#FFC4B3&#39;&#125;,
        &#123;&#39;max&#39;: 999, &#39;min&#39;: 100, &#39;label&#39;: &#39;100-999&#39;, &#39;color&#39;: &#39;#FF9985&#39;&#125;,
        &#123;&#39;max&#39;: 9999, &#39;min&#39;: 1000, &#39;label&#39;: &#39;1000-9999&#39;, &#39;color&#39;: &#39;#F57567&#39;&#125;,
        &#123;&#39;max&#39;: 99999, &#39;min&#39;: 10000, &#39;label&#39;: &#39;10000-99999&#39;, &#39;color&#39;: &#39;#E64546&#39;&#125;,
        &#123;&#39;max&#39;: 999999, &#39;min&#39;: 100000, &#39;label&#39;: &#39;100000-999999&#39;, &#39;color&#39;: &#39;#B80909&#39;&#125;,
        &#123;&#39;max&#39;: 9999999, &#39;min&#39;: 1000000, &#39;label&#39;: &#39;≧1000000&#39;, &#39;color&#39;: &#39;#8A0808&#39;&#125;
    ]

    gt_map = (
        Map()
        .add(series_name=&#39;累计确诊人数&#39;, data_pair=[list(z) for z in zip(country, curconfirm)], maptype=&quot;world&quot;, name_map=name_map, is_map_symbol_show=False)
        .set_series_opts(label_opts=opts.LabelOpts(is_show=False))
        .set_global_opts(
            title_opts=opts.TitleOpts(title=&quot;全球疫情数据（累计确诊）&quot;,
                                      subtitle=&#39;数据更新至：&#39; + time_global + &#39;\n\n来源：百度疫情实时大数据报告&#39;),
            visualmap_opts=opts.VisualMapOpts(max_=300, is_piecewise=True, pieces=pieces),
        )
    )
    return gt_map
</code></pre>
<h3 id="【7x03】中国每日数据折线图-china-daily-map"><a href="#【7x03】中国每日数据折线图-china-daily-map" class="headerlink" title="【7x03】中国每日数据折线图 china_daily_map()"></a><font color="#4876FF">【7x03】中国每日数据折线图 china_daily_map()</font></h3><pre><code class="python">def china_daily_map():
    wb = openpyxl.load_workbook(&#39;COVID-19-China.xlsx&#39;)
    ws_china_confirmed = wb[&#39;中国每日累计确诊数据&#39;]
    ws_china_crued = wb[&#39;中国每日累计治愈数据&#39;]
    ws_china_died = wb[&#39;中国每日累计死亡数据&#39;]

    ws_china_confirmed.delete_rows(1)
    ws_china_crued.delete_rows(1)
    ws_china_died.delete_rows(1)

    x_date = []               # 日期
    y_china_confirmed = []    # 每日累计确诊
    y_china_crued = []        # 每日累计治愈
    y_china_died = []         # 每日累计死亡

    for china_confirmed in ws_china_confirmed.values:
        y_china_confirmed.append(china_confirmed[1])
    for china_crued in ws_china_crued.values:
        x_date.append(china_crued[0])
        y_china_crued.append(china_crued[1])
    for china_died in ws_china_died.values:
        y_china_died.append(china_died[1])

    fi_map = (
        Line(init_opts=opts.InitOpts(height=&#39;420px&#39;))
            .add_xaxis(xaxis_data=x_date)
            .add_yaxis(
            series_name=&quot;中国累计确诊数据&quot;,
            y_axis=y_china_confirmed,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .add_yaxis(
            series_name=&quot;中国累计治愈趋势&quot;,
            y_axis=y_china_crued,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .add_yaxis(
            series_name=&quot;中国累计死亡趋势&quot;,
            y_axis=y_china_died,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title=&quot;中国每日累计确诊/治愈/死亡趋势&quot;),
            legend_opts=opts.LegendOpts(pos_bottom=&quot;bottom&quot;, orient=&#39;horizontal&#39;),
            tooltip_opts=opts.TooltipOpts(trigger=&quot;axis&quot;),
            yaxis_opts=opts.AxisOpts(
                type_=&quot;value&quot;,
                axistick_opts=opts.AxisTickOpts(is_show=True),
                splitline_opts=opts.SplitLineOpts(is_show=True),
            ),
            xaxis_opts=opts.AxisOpts(type_=&quot;category&quot;, boundary_gap=False),
        )
    )
    return fi_map
</code></pre>
<h3 id="【7x04】境外每日数据折线图-foreign-daily-map"><a href="#【7x04】境外每日数据折线图-foreign-daily-map" class="headerlink" title="【7x04】境外每日数据折线图 foreign_daily_map()"></a><font color="#4876FF">【7x04】境外每日数据折线图 foreign_daily_map()</font></h3><pre><code class="python">def foreign_daily_map():
    wb = openpyxl.load_workbook(&#39;COVID-19-Global.xlsx&#39;)
    ws_foreign_confirmed = wb[&#39;境外每日累计确诊数据&#39;]
    ws_foreign_crued = wb[&#39;境外每日累计治愈数据&#39;]
    ws_foreign_died = wb[&#39;境外每日累计死亡数据&#39;]

    ws_foreign_confirmed.delete_rows(1)
    ws_foreign_crued.delete_rows(1)
    ws_foreign_died.delete_rows(1)

    x_date = []                # 日期
    y_foreign_confirmed = []   # 累计确诊
    y_foreign_crued = []       # 累计治愈
    y_foreign_died = []        # 累计死亡

    for foreign_confirmed in ws_foreign_confirmed.values:
        y_foreign_confirmed.append(foreign_confirmed[1])
    for foreign_crued in ws_foreign_crued.values:
        x_date.append(foreign_crued[0])
        y_foreign_crued.append(foreign_crued[1])
    for foreign_died in ws_foreign_died.values:
        y_foreign_died.append(foreign_died[1])

    fte_map = (
        Line(init_opts=opts.InitOpts(height=&#39;420px&#39;))
            .add_xaxis(xaxis_data=x_date)
            .add_yaxis(
            series_name=&quot;境外累计确诊趋势&quot;,
            y_axis=y_foreign_confirmed,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .add_yaxis(
            series_name=&quot;境外累计治愈趋势&quot;,
            y_axis=y_foreign_crued,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .add_yaxis(
            series_name=&quot;境外累计死亡趋势&quot;,
            y_axis=y_foreign_died,
            label_opts=opts.LabelOpts(is_show=False),
        )
            .set_global_opts(
            title_opts=opts.TitleOpts(title=&quot;境外每日累计确诊/治愈/死亡趋势&quot;),
            legend_opts=opts.LegendOpts(pos_bottom=&quot;bottom&quot;, orient=&#39;horizontal&#39;),
            tooltip_opts=opts.TooltipOpts(trigger=&quot;axis&quot;),
            yaxis_opts=opts.AxisOpts(
                type_=&quot;value&quot;,
                axistick_opts=opts.AxisTickOpts(is_show=True),
                splitline_opts=opts.SplitLineOpts(is_show=True),
            ),
            xaxis_opts=opts.AxisOpts(type_=&quot;category&quot;, boundary_gap=False),
        )
    )
    return fte_map
</code></pre>
<h2 id="【8x00】结果截图"><a href="#【8x00】结果截图" class="headerlink" title="【8x00】结果截图"></a><font color=#FF0000>【8x00】结果截图</font></h2><h3 id="【8x01】数据储存-Excel"><a href="#【8x01】数据储存-Excel" class="headerlink" title="【8x01】数据储存 Excel"></a><font color="#4876FF">【8x01】数据储存 Excel</font></h3><p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/03.png" alt="03"></p>
<p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/04.png" alt="04"></p>
<h3 id="【8x02】词云图"><a href="#【8x02】词云图" class="headerlink" title="【8x02】词云图"></a><font color="#4876FF">【8x02】词云图</font></h3><p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/05.png" alt="05"></p>
<p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/06.png" alt="06"></p>
<h3 id="【8x03】地图-折线图"><a href="#【8x03】地图-折线图" class="headerlink" title="【8x03】地图 + 折线图"></a><font color="#4876FF">【8x03】地图 + 折线图</font></h3><p><img src="https://cdn.jsdelivr.net/gh/TRHX/ImageHosting/ITRHX-PIC/A89/07.png" alt="07"></p>
<h2 id="【9x00】完整代码"><a href="#【9x00】完整代码" class="headerlink" title="【9x00】完整代码"></a><font color=#FF0000>【9x00】完整代码</font></h2><p>预览地址：<a target="_blank" rel="noopener" href="http://cov.itrhx.com/">http://cov.itrhx.com/</a></p>
<p>完整代码地址（点亮 star 有 buff 加成）：<a target="_blank" rel="noopener" href="https://github.com/TRHX/Python3-Spider-Practice/tree/master/COVID-19">https://github.com/TRHX/Python3-Spider-Practice/tree/master/COVID-19</a></p>
<p>其他爬虫实战代码合集（持续更新）：<a target="_blank" rel="noopener" href="https://github.com/TRHX/Python3-Spider-Practice">https://github.com/TRHX/Python3-Spider-Practice</a></p>
<p>爬虫实战专栏（持续更新）：<a target="_blank" rel="noopener" href="https://itrhx.blog.csdn.net/article/category/9351278">https://itrhx.blog.csdn.net/article/category/9351278</a></p>
<hr>
<pre><code class="yaml">这里是一段防爬虫文本，请读者忽略。
本文原创首发于 CSDN，作者 TRHX。
博客首页：https://itrhx.blog.csdn.net/
本文链接：https://itrhx.blog.csdn.net/article/details/107140534
未经授权，禁止转载！恶意转载，后果自负！尊重原创，远离剽窃！
</code></pre>
<hr>

        
                <blockquote style="margin: 2em 0 0;padding: 0.5em 1em;border-left: 8px solid #F44336;background-color: #F5F5F5;list-style: none;">
                    <p>
                        <strong>本文链接：</strong><a href="https://www.itbob.cn/article/035/">https://www.itbob.cn/article/035/</a>
                        <br>
                        <strong>
                             
                                本站所有原创文章采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 许可协议进行许可！
                            
                        </strong>
                    </p>
                </blockquote>
        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script>
    var gitalk = new Gitalk({
            clientID: 'd19a84b9d9a2ddb2c6b9',
            clientSecret: 'cec9feae5129a6106edc68ce06d167be8eb06021',
            repo: 'trhx.github.io',
            owner: 'TRHX',
            admin: ['TRHX'],
            // facebook-like distraction free mode
            distractionFreeMode: false
        })
   gitalk.render('gitalk-container')
</script>
</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/article/036/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/article/034/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/BOB.png" alt="BOB's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        admin@itbob.cn
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: admin@itrhx.com" target="_blank" title="邮件联系我">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        邮件联系我
                    </a>
                </li>
            
                <li>
                    <a href="https://itrhx.blog.csdn.net/" target="_blank" title="关注 CSDN">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">donut_small</i>
                        
                        关注 CSDN
                    </a>
                </li>
            
                <li>
                    <a href="https://github.com/TRHX" target="_blank" title="关注 GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">code</i>
                        
                        关注 GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2020/11/">十一月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/10/">十月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/05/">五月 2020<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/03/">三月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/06/">六月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/02/">二月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Hexo/">Hexo<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析<span class="sidebar_archives-count">27</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%88%AC%E8%99%AB/">爬虫<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/%E7%AE%97%E6%B3%95/">算法<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="标签云">
                
                    <i class="material-icons sidebar-material-icons">local_offer</i>
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline" title="时光机">
                
                    <i class="material-icons sidebar-material-icons">send</i>
                
                时光机
            </a>
        </li>
        
    
        <li>
            <a href="/comments" title="留言板">
                
                    <i class="material-icons sidebar-material-icons">chat</i>
                
                留言板
            </a>
        </li>
        
    
        <li>
            <a href="/friends" title="友人帐">
                
                    <i class="material-icons sidebar-material-icons">group_add</i>
                
                友人帐
            </a>
        </li>
        
    
        <li>
            <a href="/gallery" title="照片墙">
                
                    <i class="material-icons sidebar-material-icons">collections</i>
                
                照片墙
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">38</span>
            </a>
        </li>
        
    

    <!-- Article Wordcount  -->
    
        <li>
            <a href="">
                字数统计
                <span class="sidebar-badge">197.4k</span>
            </a>
        </li>
        
            <li class="divider"></li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- QQ Group -->

    <a href="https://jq.qq.com/?_wv=1027&k=MwSEZmIi" alt="爬虫逆向交流群" title="群号：941013658" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            爬虫逆向交流群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>
    <a href="https://jq.qq.com/?_wv=1027&k=Ag6AZkYC" alt="Hexo 博客交流一群" title="群号：924812033" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Hexo 博客交流一群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>
    <a href="https://jq.qq.com/?_wv=1027&k=ymhpQ0jb" alt="Hexo 博客交流二群" title="群号：735861501" class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            Hexo 博客交流二群
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Github -->
    
        <a href="https://github.com/TRHX" target="_blank" title="Github">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- CSDN -->
    
        <a href="https://itrhx.blog.csdn.net/" target="_blank" title="CSDN">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-csdn">
                <span class="visuallyhidden">CSDN</span>
            </button><!--
     --></a>
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/itrhx" target="_blank" title="Zhihu">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
        --></a>
    

    <!-- Email -->
    
        <a href="mailto:admin@itbob.cn" target="_blank" title="Email">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-envelope">
                <span class="visuallyhidden">Email</span>
            </button><!--
     --></a>
    

    <!-- QQ -->
    
        <a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2273902448&amp;site=qq&amp;menu=yes" target="_blank" title="QQ">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-qq">
                <span class="visuallyhidden">QQ</span>
            </button><!--
        --></a>
    

    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- LinkedIn -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">

            
                <div class="itbob-footer-text">
                    
                        <img src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/icp.png" alt="ICP"> <a href="https://beian.miit.gov.cn/" target="_blank">鄂ICP备19003281号-6</a>丨 <img src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/img/moeicp.png" alt="MOE ICP"> <a href="https://icp.gov.moe/" target="_blank">萌ICP备20202022号</a>
                    
                </div>
            

            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;ITBOB'S BLOG丨

            <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
            <script>
                var now = new Date(); 
                function createtime() { 
                    var grt= new Date("08/10/2018 17:38:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
                    now.setTime(now.getTime()+250); 
                    days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                    hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                    if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                    mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                    seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                    snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                    document.getElementById("timeDate").innerHTML = "本站已运行了 "+dnum+" 天 "; 
                    document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
                } 
            setInterval("createtime()",250);
            </script>


        </div>

        <!-- All Site UV -->
        <!-- 
        <br />
        <span id="busuanzi_container_site_uv">本站访客数
            <span id="busuanzi_value_site_uv">
            </span>
        </span>|
        <span id="busuanzi_container_site_pv">本站总访问量
            <span id="busuanzi_value_site_pv">
                
            </span>
        </span>|
        <i class="material-icons">keyboard</i>站点总字数<span class="post-count">197.4k</span>
        
        </div> -->
        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <!-- <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div> -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="itbob-github-badge">
                    <span class="badge-subject">PV</span>
                    <span class="badge-value bg-brightgreen" id="busuanzi_value_site_pv"></span>
                </div>
                <div class="itbob-github-badge">
                    <span class="badge-subject">Powered</span>
                    <span class="badge-value bg-blue">Hexo</span>
                </div>
            </div>
            <div>
                <div class="itbob-github-badge">
                    <span class="badge-subject">UV</span>
                    <span class="badge-value bg-firebrick" id="busuanzi_value_site_uv"></span>
                </div>
                <div class="itbob-github-badge">
                    <span class="badge-subject">Theme</span>
                    <span class="badge-value bg-orange">Material</span>
                </div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/nprogress.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/busuanzi.pure.mini.js"></script>



   <!-- GitTalk -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
        document.write('
<link rel="stylesheet" href="/css/uc.css">
');
        alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Blog Title JS -->

    
        <script>lsloader.load("binft","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/binft.js", true)</script>
        


<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itbob.cn@1.1/js/prettify.min.js", true)</script>
        
    



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2018;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log("\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n", "color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;", "color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;");
console.log("\n %c © ITBOB'S BLOG %c https://www.itbob.cn \n\n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;");
console.log("\n %c © ITRHX'S BLOG %c https://www.itrhx.com \n\n", "color: #fadfa3; background: #030307; padding:5px 0;", "background: #fadfa3; padding:5px 0;");
</script>

                </main>
            </div>
        </body>
    
</html>
